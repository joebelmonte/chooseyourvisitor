/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var COMPILED=!0,goog=goog||{};goog.global=this||self;goog.exportPath_=function(a,b,c,d){a=a.split(".");d=d||goog.global;a[0]in d||"undefined"==typeof d.execScript||d.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)if(a.length||void 0===b)d=d[e]&&d[e]!==Object.prototype[e]?d[e]:d[e]={};else if(!c&&goog.isObject(b)&&goog.isObject(d[e]))for(var f in b)b.hasOwnProperty(f)&&(d[e][f]=b[f]);else d[e]=b};
goog.define=function(a,b){if(!COMPILED){var c=goog.global.CLOSURE_UNCOMPILED_DEFINES,d=goog.global.CLOSURE_DEFINES;c&&void 0===c.nodeType&&Object.prototype.hasOwnProperty.call(c,a)?b=c[a]:d&&void 0===d.nodeType&&Object.prototype.hasOwnProperty.call(d,a)&&(b=d[a])}return b};goog.FEATURESET_YEAR=2012;goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;
goog.provide=function(a){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};goog.constructNamespace_=function(a,b,c){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var d=a;(d=d.substring(0,d.lastIndexOf(".")))&&!goog.getObjectByName(d);)goog.implicitNamespaces_[d]=!0}goog.exportPath_(a,b,c)};
goog.getScriptNonce=function(a){if(a&&a!=goog.global)return goog.getScriptNonce_(a.document);null===goog.cspNonce_&&(goog.cspNonce_=goog.getScriptNonce_(goog.global.document));return goog.cspNonce_};goog.NONCE_PATTERN_=/^[\w+/_-]+[=]{0,2}$/;goog.cspNonce_=null;goog.getScriptNonce_=function(a){return(a=a.querySelector&&a.querySelector("script[nonce]"))&&(a=a.nonce||a.getAttribute("nonce"))&&goog.NONCE_PATTERN_.test(a)?a:""};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if("string"!==typeof a||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInGoogModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");
if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};
goog.module.getInternal_=function(a){if(!COMPILED){if(a in goog.loadedModules_)return goog.loadedModules_[a].exports;if(!goog.implicitNamespaces_[a])return a=goog.getObjectByName(a),null!=a?a:null}return null};goog.ModuleType={ES6:"es6",GOOG:"goog"};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return goog.isInGoogModuleLoader_()||goog.isInEs6ModuleLoader_()};goog.isInGoogModuleLoader_=function(){return!!goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.GOOG};
goog.isInEs6ModuleLoader_=function(){if(goog.moduleLoaderState_&&goog.moduleLoaderState_.type==goog.ModuleType.ES6)return!0;var a=goog.global.$jscomp;return a?"function"!=typeof a.getCurrentModulePath?!1:!!a.getCurrentModulePath():!1};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInGoogModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.declareModuleId=function(a){if(!COMPILED){if(!goog.isInEs6ModuleLoader_())throw Error("goog.declareModuleId may only be called from within an ES6 module");if(goog.moduleLoaderState_&&goog.moduleLoaderState_.moduleName)throw Error("goog.declareModuleId may only be called once per module.");if(a in goog.loadedModules_)throw Error('Module with namespace "'+a+'" already exists.');}if(goog.moduleLoaderState_)goog.moduleLoaderState_.moduleName=a;else{var b=goog.global.$jscomp;if(!b||"function"!=typeof b.getCurrentModulePath)throw Error('Module with namespace "'+
a+'" has been loaded incorrectly.');b=b.require(b.getCurrentModulePath());goog.loadedModules_[a]={exports:b,type:goog.ModuleType.ES6,moduleId:a}}};goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&null!=goog.getObjectByName(a)},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(a,b){a=a.split(".");b=b||goog.global;for(var c=0;c<a.length;c++)if(b=b[a[c]],null==b)return null;return b};goog.addDependency=function(a,b,c,d){!COMPILED&&goog.DEPENDENCIES_ENABLED&&goog.debugLoader_.addDependency(a,b,c,d)};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)};
goog.require=function(a){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.debugLoader_.requested(a);if(goog.isProvided_(a)){if(goog.isInModuleLoader_())return goog.module.getInternal_(a)}else if(goog.ENABLE_DEBUG_LOADER){var b=goog.moduleLoaderState_;goog.moduleLoaderState_=null;try{goog.debugLoader_.load_(a)}finally{goog.moduleLoaderState_=b}}return null}};goog.requireType=function(a){return{}};goog.basePath="";goog.nullFunction=function(){};
goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(a){a.instance_=void 0;a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.TRANSPILE="detect";
goog.ASSUME_ES_MODULES_TRANSPILED=!1;goog.TRANSPILE_TO_LANGUAGE="";goog.TRANSPILER="transpile.js";goog.hasBadLetScoping=null;
goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1,type:goog.ModuleType.GOOG};var c={},d=c;if("function"===typeof a)d=a.call(void 0,d);else if("string"===typeof a)d=goog.loadModuleFromSource_.call(void 0,d,a);else throw Error("Invalid module definition");var e=goog.moduleLoaderState_.moduleName;if("string"===typeof e&&e)goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(e,d,c!==d):goog.SEAL_MODULE_EXPORTS&&
Object.seal&&"object"==typeof d&&null!=d&&Object.seal(d),goog.loadedModules_[e]={exports:d,type:goog.ModuleType.GOOG,moduleId:goog.moduleLoaderState_.moduleName};else throw Error('Invalid module name "'+e+'"');}finally{goog.moduleLoaderState_=b}};goog.loadModuleFromSource_=function(a,b){eval(goog.CLOSURE_EVAL_PREFILTER_.createScript(b));return a};goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")};
goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);try{var b=new goog.global.XMLHttpRequest;b.open("get",a,!1);b.send();return 0==b.status||200==b.status?b.responseText:null}catch(c){return null}};
goog.transpile_=function(a,b,c){var d=goog.global.$jscomp;d||(goog.global.$jscomp=d={});var e=d.transpile;if(!e){var f=goog.basePath+goog.TRANSPILER,g=goog.loadFileSync_(f);if(g){(function(){(0,eval)(g+"\n//# sourceURL="+f)}).call(goog.global);if(goog.global.$gwtExport&&goog.global.$gwtExport.$jscomp&&!goog.global.$gwtExport.$jscomp.transpile)throw Error('The transpiler did not properly export the "transpile" method. $gwtExport: '+JSON.stringify(goog.global.$gwtExport));goog.global.$jscomp.transpile=
goog.global.$gwtExport.$jscomp.transpile;d=goog.global.$jscomp;e=d.transpile}}e||(e=d.transpile=function(k,l){goog.logToConsole_(l+" requires transpilation but no transpiler was found.");return k});return e(a,b,c)};goog.typeOf=function(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};
goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return Object.prototype.hasOwnProperty.call(a,goog.UID_PROPERTY_)&&a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){null!==a&&"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);
goog.uidCounter_=0;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if("function"===typeof a.clone)return a.clone();b="array"==b?[]:{};for(var c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=function(){return Date.now()};goog.globalEval=function(a){(0,eval)(a)};
goog.getCssName=function(a,b){if("."==String(a).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+a);var c=function(e){return goog.cssNameMapping_[e]||e},d=function(e){e=e.split("-");for(var f=[],g=0;g<e.length;g++)f.push(c(e[g]));return f.join("-")};d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(e){return e};a=b?a+"-"+d(b):d(a);return goog.global.CLOSURE_CSS_NAME_MAP_FN?goog.global.CLOSURE_CSS_NAME_MAP_FN(a):a};
goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b,c){c&&c.html&&(a=a.replace(/</g,"&lt;"));c&&c.unescapeHtmlEntities&&(a=a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&"));b&&(a=a.replace(/\{\$([^}]+)}/g,function(d,e){return null!=b&&e in b?b[e]:d}));return a};
goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,!0,c)};goog.exportProperty=function(a,b,c){a[b]=c};goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(d,e,f){for(var g=Array(arguments.length-2),k=2;k<arguments.length;k++)g[k-2]=arguments[k];return b.prototype[e].apply(d,g)}};
goog.scope=function(a){if(goog.isInModuleLoader_())throw Error("goog.scope is not supported within a module.");a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var c=b.constructor,d=b.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,a);a&&goog.inherits(c,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(c.prototype,b);null!=d&&(d instanceof Function?d(c):goog.defineClass.applyProperties_(c,d));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){return goog.defineClass.SEAL_CLASS_INSTANCES?function(){var c=a.apply(this,arguments)||this;c[goog.UID_PROPERTY_]=c[goog.UID_PROPERTY_];return c}:a};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var d=0;d<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;d++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[d],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};
!COMPILED&&goog.DEPENDENCIES_ENABLED&&(goog.inHtmlDocument_=function(){var a=goog.global.document;return null!=a&&"write"in a},goog.isDocumentLoading_=function(){var a=goog.global.document;return a.attachEvent?"complete"!=a.readyState:"loading"==a.readyState},goog.findBasePath_=function(){if(void 0!=goog.global.CLOSURE_BASE_PATH&&"string"===typeof goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_()){var a=goog.global.document,b=a.currentScript;
a=b?[b]:a.getElementsByTagName("SCRIPT");for(b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?");d=-1==d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}}},goog.findBasePath_(),goog.Transpiler=function(){this.requiresTranspilation_=null;this.transpilationTarget_=goog.TRANSPILE_TO_LANGUAGE},goog.Transpiler.prototype.createRequiresTranspilation_=function(){function a(g,k){e?d[g]=!0:k()?(c=g,d[g]=!1):e=d[g]=!0}function b(g){try{return!!eval(g)}catch(k){return!1}}
var c="es3",d={es3:!1},e=!1,f=goog.global.navigator&&goog.global.navigator.userAgent?goog.global.navigator.userAgent:"";a("es5",function(){return b("[1,].length==1")});a("es6",function(){return f.match(/Edge\/(\d+)(\.\d)*/i)?!1:b('(()=>{"use strict";class X{constructor(){if(new.target!=String)throw 1;this.x=42}}let q=Reflect.construct(X,[],String);if(q.x!=42||!(q instanceof String))throw 1;for(const a of[2,3]){if(a==2)continue;function f(z={a}){let a=0;return z.a}{function f(){return 0;}}return f()==3}})()')});
a("es7",function(){return b("2**3==8")});a("es8",function(){return b("async()=>1,1")});a("es9",function(){return b("({...rest}={}),1")});a("es_2019",function(){return b('let r;try{throw 0}catch{r="\u2029"};r')});a("es_2020",function(){return b("null?.x??1")});a("es_next",function(){return!1});return{target:c,map:d}},goog.Transpiler.prototype.needsTranspile=function(a,b){if("always"==goog.TRANSPILE)return!0;if("never"==goog.TRANSPILE)return!1;if(!this.requiresTranspilation_){var c=this.createRequiresTranspilation_();
this.requiresTranspilation_=c.map;this.transpilationTarget_=this.transpilationTarget_||c.target}if(a in this.requiresTranspilation_)return this.requiresTranspilation_[a]?!0:!goog.inHtmlDocument_()||"es6"!=b||"noModule"in goog.global.document.createElement("script")?!1:!0;throw Error("Unknown language mode: "+a);},goog.Transpiler.prototype.transpile=function(a,b){return goog.transpile_(a,b,this.transpilationTarget_)},goog.transpiler_=new goog.Transpiler,goog.protectScriptTag_=function(a){return a.replace(/<\/(SCRIPT)/ig,
"\\x3c/$1")},goog.DebugLoader_=function(){this.dependencies_={};this.idToPath_={};this.written_={};this.loadingDeps_=[];this.depsToLoad_=[];this.paused_=!1;this.factory_=new goog.DependencyFactory(goog.transpiler_);this.deferredCallbacks_={};this.deferredQueue_=[]},goog.DebugLoader_.prototype.bootstrap=function(a,b){function c(){d&&(goog.global.setTimeout(d,0),d=null)}var d=b;if(a.length){b=[];for(var e=0;e<a.length;e++){var f=this.getPathFromDeps_(a[e]);if(!f)throw Error("Unregonized namespace: "+
a[e]);b.push(this.dependencies_[f])}f=goog.require;var g=0;for(e=0;e<a.length;e++)f(a[e]),b[e].onLoad(function(){++g==a.length&&c()})}else c()},goog.DebugLoader_.prototype.loadClosureDeps=function(){this.depsToLoad_.push(this.factory_.createDependency(goog.normalizePath_(goog.basePath+"deps.js"),"deps.js",[],[],{},!1));this.loadDeps_()},goog.DebugLoader_.prototype.requested=function(a,b){(a=this.getPathFromDeps_(a))&&(b||this.areDepsLoaded_(this.dependencies_[a].requires))&&(b=this.deferredCallbacks_[a])&&
(delete this.deferredCallbacks_[a],b())},goog.DebugLoader_.prototype.setDependencyFactory=function(a){this.factory_=a},goog.DebugLoader_.prototype.load_=function(a){if(this.getPathFromDeps_(a)){var b=this,c=[],d=function(e){var f=b.getPathFromDeps_(e);if(!f)throw Error("Bad dependency path or symbol: "+e);if(!b.written_[f]){b.written_[f]=!0;e=b.dependencies_[f];for(f=0;f<e.requires.length;f++)goog.isProvided_(e.requires[f])||d(e.requires[f]);c.push(e)}};d(a);a=!!this.depsToLoad_.length;this.depsToLoad_=
this.depsToLoad_.concat(c);this.paused_||a||this.loadDeps_()}else goog.logToConsole_("goog.require could not find: "+a)},goog.DebugLoader_.prototype.loadDeps_=function(){for(var a=this,b=this.paused_;this.depsToLoad_.length&&!b;)(function(){var c=!1,d=a.depsToLoad_.shift(),e=!1;a.loading_(d);var f={pause:function(){if(c)throw Error("Cannot call pause after the call to load.");b=!0},resume:function(){c?a.resume_():b=!1},loaded:function(){if(e)throw Error("Double call to loaded.");e=!0;a.loaded_(d)},
pending:function(){for(var g=[],k=0;k<a.loadingDeps_.length;k++)g.push(a.loadingDeps_[k]);return g},setModuleState:function(g){goog.moduleLoaderState_={type:g,moduleName:"",declareLegacyNamespace:!1}},registerEs6ModuleExports:function(g,k,l){l&&(goog.loadedModules_[l]={exports:k,type:goog.ModuleType.ES6,moduleId:l||""})},registerGoogModuleExports:function(g,k){goog.loadedModules_[g]={exports:k,type:goog.ModuleType.GOOG,moduleId:g}},clearModuleState:function(){goog.moduleLoaderState_=null},defer:function(g){if(c)throw Error("Cannot register with defer after the call to load.");
a.defer_(d,g)},areDepsLoaded:function(){return a.areDepsLoaded_(d.requires)}};try{d.load(f)}finally{c=!0}})();b&&this.pause_()},goog.DebugLoader_.prototype.pause_=function(){this.paused_=!0},goog.DebugLoader_.prototype.resume_=function(){this.paused_&&(this.paused_=!1,this.loadDeps_())},goog.DebugLoader_.prototype.loading_=function(a){this.loadingDeps_.push(a)},goog.DebugLoader_.prototype.loaded_=function(a){for(var b=0;b<this.loadingDeps_.length;b++)if(this.loadingDeps_[b]==a){this.loadingDeps_.splice(b,
1);break}for(b=0;b<this.deferredQueue_.length;b++)if(this.deferredQueue_[b]==a.path){this.deferredQueue_.splice(b,1);break}if(this.loadingDeps_.length==this.deferredQueue_.length&&!this.depsToLoad_.length)for(;this.deferredQueue_.length;)this.requested(this.deferredQueue_.shift(),!0);a.loaded()},goog.DebugLoader_.prototype.areDepsLoaded_=function(a){for(var b=0;b<a.length;b++){var c=this.getPathFromDeps_(a[b]);if(!c||!(c in this.deferredCallbacks_||goog.isProvided_(a[b])))return!1}return!0},goog.DebugLoader_.prototype.getPathFromDeps_=
function(a){return a in this.idToPath_?this.idToPath_[a]:a in this.dependencies_?a:null},goog.DebugLoader_.prototype.defer_=function(a,b){this.deferredCallbacks_[a.path]=b;this.deferredQueue_.push(a.path)},goog.LoadController=function(){},goog.LoadController.prototype.pause=function(){},goog.LoadController.prototype.resume=function(){},goog.LoadController.prototype.loaded=function(){},goog.LoadController.prototype.pending=function(){},goog.LoadController.prototype.registerEs6ModuleExports=function(a,
b,c){},goog.LoadController.prototype.setModuleState=function(a){},goog.LoadController.prototype.clearModuleState=function(){},goog.LoadController.prototype.defer=function(a){},goog.LoadController.prototype.areDepsLoaded=function(){},goog.Dependency=function(a,b,c,d,e){this.path=a;this.relativePath=b;this.provides=c;this.requires=d;this.loadFlags=e;this.loaded_=!1;this.loadCallbacks_=[]},goog.Dependency.prototype.getPathName=function(){var a=this.path,b=a.indexOf("://");0<=b&&(a=a.substring(b+3),b=
a.indexOf("/"),0<=b&&(a=a.substring(b+1)));return a},goog.Dependency.prototype.onLoad=function(a){this.loaded_?a():this.loadCallbacks_.push(a)},goog.Dependency.prototype.loaded=function(){this.loaded_=!0;var a=this.loadCallbacks_;this.loadCallbacks_=[];for(var b=0;b<a.length;b++)a[b]()},goog.Dependency.defer_=!1,goog.Dependency.callbackMap_={},goog.Dependency.registerCallback_=function(a){var b=Math.random().toString(32);goog.Dependency.callbackMap_[b]=a;return b},goog.Dependency.unregisterCallback_=
function(a){delete goog.Dependency.callbackMap_[a]},goog.Dependency.callback_=function(a,b){if(a in goog.Dependency.callbackMap_){for(var c=goog.Dependency.callbackMap_[a],d=[],e=1;e<arguments.length;e++)d.push(arguments[e]);c.apply(void 0,d)}else throw Error("Callback key "+a+" does not exist (was base.js loaded more than once?).");},goog.Dependency.prototype.load=function(a){if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?a.loaded():a.pause();else if(goog.inHtmlDocument_()){var b=
goog.global.document;if("complete"==b.readyState&&!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING){if(/\bdeps.js$/.test(this.path)){a.loaded();return}throw Error('Cannot write "'+this.path+'" after document load');}var c=goog.getScriptNonce();if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&goog.isDocumentLoading_()){var d=function(k){k.readyState&&"complete"!=k.readyState?k.onload=d:(goog.Dependency.unregisterCallback_(e),a.loaded())};var e=goog.Dependency.registerCallback_(d);c=c?' nonce="'+c+'"':"";
var f='<script src="'+this.path+'"'+c+(goog.Dependency.defer_?" defer":"")+' id="script-'+e+'">\x3c/script>';f+="<script"+c+">";f=goog.Dependency.defer_?f+("document.getElementById('script-"+e+"').onload = function() {\n  goog.Dependency.callback_('"+e+"', this);\n};\n"):f+("goog.Dependency.callback_('"+e+"', document.getElementById('script-"+e+"'));");f+="\x3c/script>";b.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(f):f)}else{var g=b.createElement("script");g.defer=goog.Dependency.defer_;
g.async=!1;c&&(g.nonce=c);goog.DebugLoader_.IS_OLD_IE_?(a.pause(),g.onreadystatechange=function(){if("loaded"==g.readyState||"complete"==g.readyState)a.loaded(),a.resume()}):g.onload=function(){g.onload=null;a.loaded()};g.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(this.path):this.path;b.head.appendChild(g)}}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),"deps.js"==this.relativePath?(goog.logToConsole_("Consider setting CLOSURE_IMPORT_SCRIPT before loading base.js, or setting CLOSURE_NO_DEPS to true."),
a.loaded()):a.pause()},goog.Es6ModuleDependency=function(a,b,c,d,e){goog.Dependency.call(this,a,b,c,d,e)},goog.inherits(goog.Es6ModuleDependency,goog.Dependency),goog.Es6ModuleDependency.prototype.load=function(a){function b(q,h){var p="",r=goog.getScriptNonce();r&&(p=' nonce="'+r+'"');q=h?'<script type="module" crossorigin'+p+">"+h+"\x3c/script>":'<script type="module" crossorigin src="'+q+'"'+p+">\x3c/script>";d.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(q):q)}function c(q,
h){var p=d.createElement("script");p.defer=!0;p.async=!1;p.type="module";p.setAttribute("crossorigin",!0);var r=goog.getScriptNonce();r&&(p.nonce=r);h?p.text=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScript(h):h:p.src=goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createScriptURL(q):q;d.head.appendChild(p)}if(goog.global.CLOSURE_IMPORT_SCRIPT)goog.global.CLOSURE_IMPORT_SCRIPT(this.path)?a.loaded():a.pause();else if(goog.inHtmlDocument_()){var d=goog.global.document,e=this;
if(goog.isDocumentLoading_()){var f=b;goog.Dependency.defer_=!0}else f=c;var g=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(g);a.setModuleState(goog.ModuleType.ES6)});f(void 0,'goog.Dependency.callback_("'+g+'")');f(this.path,void 0);var k=goog.Dependency.registerCallback_(function(q){goog.Dependency.unregisterCallback_(k);a.registerEs6ModuleExports(e.path,q,goog.moduleLoaderState_.moduleName)});f(void 0,'import * as m from "'+this.path+'"; goog.Dependency.callback_("'+
k+'", m)');var l=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(l);a.clearModuleState();a.loaded()});f(void 0,'goog.Dependency.callback_("'+l+'")')}else goog.logToConsole_("Cannot use default debug loader outside of HTML documents."),a.pause()},goog.TransformedDependency=function(a,b,c,d,e){goog.Dependency.call(this,a,b,c,d,e);this.contents_=null;this.lazyFetch_=!goog.inHtmlDocument_()||!("noModule"in goog.global.document.createElement("script"))},goog.inherits(goog.TransformedDependency,
goog.Dependency),goog.TransformedDependency.prototype.load=function(a){function b(){e.contents_=goog.loadFileSync_(e.path);e.contents_&&(e.contents_=e.transform(e.contents_),e.contents_&&(e.contents_+="\n//# sourceURL="+e.path))}function c(){e.lazyFetch_&&b();if(e.contents_){f&&a.setModuleState(goog.ModuleType.ES6);try{var h=e.contents_;e.contents_=null;goog.globalEval(h);if(f)var p=goog.moduleLoaderState_.moduleName}finally{f&&a.clearModuleState()}f&&goog.global.$jscomp.require.ensure([e.getPathName()],
function(){a.registerEs6ModuleExports(e.path,goog.global.$jscomp.require(e.getPathName()),p)});a.loaded()}}function d(){var h=goog.global.document,p=goog.Dependency.registerCallback_(function(){goog.Dependency.unregisterCallback_(p);c()}),r=goog.getScriptNonce();r="<script"+(r?' nonce="'+r+'"':"")+">"+goog.protectScriptTag_('goog.Dependency.callback_("'+p+'");')+"\x3c/script>";h.write(goog.TRUSTED_TYPES_POLICY_?goog.TRUSTED_TYPES_POLICY_.createHTML(r):r)}var e=this;if(goog.global.CLOSURE_IMPORT_SCRIPT)b(),
this.contents_&&goog.global.CLOSURE_IMPORT_SCRIPT("",this.contents_)?(this.contents_=null,a.loaded()):a.pause();else{var f=this.loadFlags.module==goog.ModuleType.ES6;this.lazyFetch_||b();var g=1<a.pending().length,k=g&&goog.DebugLoader_.IS_OLD_IE_;g=goog.Dependency.defer_&&(g||goog.isDocumentLoading_());if(k||g)a.defer(function(){c()});else{var l=goog.global.document;k=goog.inHtmlDocument_()&&"ActiveXObject"in goog.global;if(f&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()&&!k){goog.Dependency.defer_=
!0;a.pause();var q=l.onreadystatechange;l.onreadystatechange=function(){"interactive"==l.readyState&&(l.onreadystatechange=q,c(),a.resume());"function"===typeof q&&q.apply(void 0,arguments)}}else!goog.DebugLoader_.IS_OLD_IE_&&goog.inHtmlDocument_()&&goog.isDocumentLoading_()?d():c()}}},goog.TransformedDependency.prototype.transform=function(a){},goog.TranspiledDependency=function(a,b,c,d,e,f){goog.TransformedDependency.call(this,a,b,c,d,e);this.transpiler=f},goog.inherits(goog.TranspiledDependency,
goog.TransformedDependency),goog.TranspiledDependency.prototype.transform=function(a){return this.transpiler.transpile(a,this.getPathName())},goog.PreTranspiledEs6ModuleDependency=function(a,b,c,d,e){goog.TransformedDependency.call(this,a,b,c,d,e)},goog.inherits(goog.PreTranspiledEs6ModuleDependency,goog.TransformedDependency),goog.PreTranspiledEs6ModuleDependency.prototype.transform=function(a){return a},goog.GoogModuleDependency=function(a,b,c,d,e,f,g){goog.TransformedDependency.call(this,a,b,c,
d,e);this.needsTranspile_=f;this.transpiler_=g},goog.inherits(goog.GoogModuleDependency,goog.TransformedDependency),goog.GoogModuleDependency.prototype.transform=function(a){this.needsTranspile_&&(a=this.transpiler_.transpile(a,this.getPathName()));return goog.LOAD_MODULE_USING_EVAL&&void 0!==goog.global.JSON?"goog.loadModule("+goog.global.JSON.stringify(a+"\n//# sourceURL="+this.path+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+a+"\n;return exports});\n//# sourceURL="+this.path+
"\n"},goog.DebugLoader_.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.DebugLoader_.prototype.addDependency=function(a,b,c,d){b=b||[];a=a.replace(/\\/g,"/");var e=goog.normalizePath_(goog.basePath+a);d&&"boolean"!==typeof d||(d=d?{module:goog.ModuleType.GOOG}:{});c=this.factory_.createDependency(e,a,b,c,d,goog.transpiler_.needsTranspile(d.lang||"es3",d.module));this.dependencies_[e]=c;for(c=0;c<b.length;c++)this.idToPath_[b[c]]=e;this.idToPath_[a]=e},goog.DependencyFactory=
function(a){this.transpiler=a},goog.DependencyFactory.prototype.createDependency=function(a,b,c,d,e,f){return e.module==goog.ModuleType.GOOG?new goog.GoogModuleDependency(a,b,c,d,e,f,this.transpiler):f?new goog.TranspiledDependency(a,b,c,d,e,this.transpiler):e.module==goog.ModuleType.ES6?"never"==goog.TRANSPILE&&goog.ASSUME_ES_MODULES_TRANSPILED?new goog.PreTranspiledEs6ModuleDependency(a,b,c,d,e):new goog.Es6ModuleDependency(a,b,c,d,e):new goog.Dependency(a,b,c,d,e)},goog.debugLoader_=new goog.DebugLoader_,
goog.loadClosureDeps=function(){goog.debugLoader_.loadClosureDeps()},goog.setDependencyFactory=function(a){goog.debugLoader_.setDependencyFactory(a)},goog.TRUSTED_TYPES_POLICY_=goog.TRUSTED_TYPES_POLICY_NAME?goog.createTrustedTypesPolicy(goog.TRUSTED_TYPES_POLICY_NAME+"#base"):null,goog.global.CLOSURE_NO_DEPS||goog.debugLoader_.loadClosureDeps(),goog.bootstrap=function(a,b){goog.debugLoader_.bootstrap(a,b)});goog.TRUSTED_TYPES_POLICY_NAME="goog";goog.identity_=function(a){return a};
goog.createTrustedTypesPolicy=function(a){var b=null,c=goog.global.trustedTypes;if(!c||!c.createPolicy)return b;try{b=c.createPolicy(a,{createHTML:goog.identity_,createScript:goog.identity_,createScriptURL:goog.identity_})}catch(d){goog.logToConsole_(d.message)}return b};
if(!COMPILED){var isNotChrome87=!1;try{isNotChrome87=eval(goog.global.trustedTypes.emptyScript)!==goog.global.trustedTypes.emptyScript}catch(a){}goog.CLOSURE_EVAL_PREFILTER_=goog.global.trustedTypes&&isNotChrome87&&goog.createTrustedTypesPolicy("goog#base#devonly#eval")||{createScript:goog.identity_}};/*
 Copyright 2022 Glance Networks, Inc.
*/
var MINIMIZED=!0,CONFIG="debug",GLANCE_VERSION="6.3.1.0",GCommon={Defs:{}};GCommon.Defs.Version=GLANCE_VERSION.split(".").slice(0,3).join(".");GCommon.Defs.Config=CONFIG;GCommon.Type={};GCommon.Domain={};GCommon.Domain.set=function(){document.domain=window.location.host.split(".").splice(-2).join(".")};GCommon.Domain.match=function(a,b){return null!==a.match(new RegExp("\\."+b+"$","i"))};GCommon.Domain.getGlanceDomain=function(){return document.domain.split(".").splice(-2).join(".")};
GCommon.Geometry={};GCommon.Geometry.Rect=function(a){this.top=a.top;this.left=a.left;this.right=a.right;this.bottom=a.bottom};GCommon.Geometry.Rect.prototype.Union=function(a){this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.right=Math.max(this.right,a.right);this.bottom=Math.max(this.bottom,a.bottom)};GCommon.Geometry.Rect.prototype.width=function(){return this.right-this.left};GCommon.Geometry.Rect.prototype.height=function(){return this.bottom-this.top};
GCommon.Time={};GCommon.Time.UTCNow=function(){var a=new Date;return a.getUTCFullYear()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCDate()+" "+GCommon.String.zeropad(a.getUTCHours(),2)+":"+GCommon.String.zeropad(a.getUTCMinutes(),2)+":"+GCommon.String.zeropad(a.getUTCSeconds(),2)};GCommon.Time.Timer=function(){this.set()};GCommon.Time.Timer.prototype.elapsed=function(a){var b=(new Date).getTime(),c=b-this.t;a&&(this.t=b);return c};GCommon.Time.Timer.prototype.set=function(){this.t=(new Date).getTime()};
GCommon.String={};GCommon.String.zeropad=function(a,b){for(a=a.toString();a.length<b;)a="0"+a;return a};GCommon.String.queryStringParam=function(a,b){a=(new RegExp("[\\?&]"+b+"=([^&#]*)")).exec(a);return null===a?"":a[1]};GCommon.String.queryString=function(a){var b=[];Object.keys(a).forEach(function(c){b.push(c+"="+a[c])});return b.join("&")};GCommon.Url=window.URL||window.webkitURL;Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(a,b){return new Uint8Array(this.subarray(a,b))});
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){void 0===a&&(a=0);void 0===b&&(b=this.byteLength);a=Math.floor(a);b=Math.floor(b);0>a&&(a+=this.byteLength);0>b&&(b+=this.byteLength);a=Math.min(Math.max(0,a),this.byteLength);b=Math.min(Math.max(0,b),this.byteLength);if(0>=b-a)return new ArrayBuffer(0);var c=new ArrayBuffer(b-a),d=new Uint8Array(c);a=new Uint8Array(this,a,b-a);d.set(a);return c});
GCommon.Browser=function(){var a=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase(),c=a.match(/(edge)[\s\/:]([\w\d\.]+)?/)||a.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||a.match(/(rv):([\w\d\.]+)/)||[null,"unknown",0];"rv"===c[1]&&(c[1]="ie");return{name:"version"===c[1]?c[3]:c[1],version:"ie"===c[1]&&document.documentMode||parseFloat("opera"===c[1]&&c[4]?c[4]:c[2]),platform:a.match(/ip(?:ad|od|hone)/)?"ios":(a.match(/(?:webos|android)/)||
b.match(/mac|win|linux/)||["other"])[0]}}();GCommon.Elem={};GCommon.Elem.makeUnselectable=function(a){a.on("selectstart dragstart",function(b){b.preventDefault();return!1})};var EVENTSLOG="Debug"===GCommon.Defs.Config&&!1,MSGLOG="Debug"===GCommon.Defs.Config&&!1,COMMLOG="Debug"===GCommon.Defs.Config&&!1,PAINTLOG="Debug"===GCommon.Defs.Config&&!1,INFOLOG="Debug"===GCommon.Defs.Config&&!0,FRAMELOG="Debug"===GCommon.Defs.Config&&!1,DRAWLOG="Debug"===GCommon.Defs.Config&&!1,RCLOG="Debug"===GCommon.Defs.Config&&!1,STATSLOG=!1;GCommon.Log={};
GCommon.Log.logstring=function(a){for(var b="",c=0;c<a.length;c++)b+=("object"===typeof a[c]?JSON.stringify(a[c]):a[c])+" ";return b.replace(/[\r\n]/g," ").replace("<","&lt;").replace(">","&gt;")};GCommon.Log.log=function(a){window.console&&window.console.log&&(window.GLANCE_COBROWSE?!window.GLANCE_COBROWSE.disableLogging:1)&&window.console.log(GCommon.Log.logstring(arguments))};GCommon.Log.error=function(a){window.console&&window.console.error&&window.console.error(GCommon.Log.logstring(arguments))};
"Debug"===GCommon.Defs.Config&&(GCommon.Log.debuglog=function(a,b){b=Array.prototype.slice.call(b);b.unshift(a);window.console&&window.console.log&&window.console.log(GCommon.Log.logstring(b))});GCommon.Log.msglog=MSGLOG?function(a){GCommon.Log.debuglog("MSG:",arguments)}:function(a){};GCommon.Log.commlog=COMMLOG?function(a){GCommon.Log.debuglog("COMM:",arguments)}:function(a){};GCommon.Log.paintlog=PAINTLOG?function(a){GCommon.Log.debuglog("PAINT:",arguments)}:function(a){};
GCommon.Log.eventslog=EVENTSLOG?function(a){GCommon.Log.debuglog("EVENTS:",arguments)}:function(a){};GCommon.Log.infolog=INFOLOG?function(a){GCommon.Log.debuglog("INFO:",arguments)}:function(a){};GCommon.Log.framelog=FRAMELOG?function(a){GCommon.Log.debuglog("FRAME:",arguments)}:function(a){};GCommon.Log.drawlog=DRAWLOG?function(a){GCommon.Log.debuglog("DRAW:",arguments)}:function(a){};GCommon.Log.rclog=RCLOG?function(a){GCommon.Log.debuglog("RCLOG:",arguments)}:function(a){};
GCommon.Log.statslog=STATSLOG?function(a){GCommon.Log.log(arguments)}:function(a){};GCommon.Diags={};GCommon.Diags.blobToString=function(a){return new Promise(function(b,c){c=new FileReader;c.onload=function(){var d=new Uint8Array(this.result);b(d.toString())};c.readAsArrayBuffer(a)})};GCommon.assert="Debug"===GCommon.Defs.Config?function(a){if(!a)throw Error("assert failed");}:function(a){};GCommon.Stats={};
GCommon.Stats.tracker=function(a,b,c){this.stats={};this.statcounts={};this.stattypes={};this.interval=a;this.logfunc=b;this.notifyfunc=c;var d=this;0<a&&window.setInterval(function(){d.report()},1E3*a)};GCommon.Stats.tracker.statType={STAT_AVERAGE:0,STAT_PERSEC:1,STAT_TOTAL:2};GCommon.Stats.tracker.prototype.track=function(a,b,c){this.stattypes[a]=c;this.stats[a]=this.stats[a]||0;this.stats[a]+=b;this.statcounts[a]=(this.statcounts[a]||0)+1};
GCommon.Stats.tracker.prototype.report=function(){this.notifyfunc&&this.notifyfunc();if(this.logfunc)for(var a in this.stats)switch(this.stattypes[a]){case GCommon.Stats.tracker.statType.STAT_AVERAGE:this.logfunc(Math.round(this.stats[a]/this.statcounts[a]*100)/100,"average",a);break;case GCommon.Stats.tracker.statType.STAT_PERSEC:this.logfunc(Math.round(this.stats[a]/this.interval*100)/100,a+"/sec");break;case GCommon.Stats.tracker.statType.STAT_TOTAL:this.logfunc(Math.round(100*this.stats[a])/100,
a)}this.stats={};this.statcounts={}};var GLANCE_LOGGER=!0,GlanceLogger={sanitize:function(a){return a.replace(/[\r\n]/g," ").replace("<","&lt;")},_log:function(a,...b){!window.console||!window.console[a]||window.GLANCE_COBROWSE&&window.GLANCE_COBROWSE.disableLogging||(b=b.map(c=>{if("object"===typeof c)try{c=JSON.stringify(c)}catch(d){console.error(d),c="unable to convert object to string"}return"string"===typeof c?GlanceLogger.sanitize(c):c}),window.console[a](...b))},log:function(...a){GlanceLogger._log("log",...a)},error:function(...a){GlanceLogger._log("error",
...a)}},LOG_DIFFS=!1,LOG_DIFFDET=!1,LOG_DRAW=!1,LOG_PRES=!0,LOG_CBSTATE=!1,LOG_IFRAME=!1,LOG_SCROLL=!1,LOG_EVENTS=!1,LOG_LOADER=!1,LOG_UI=!1,LOG_FOCUS=!1,LOG_XDOM=!0,LOG_C3P=!1,LOG_PDF=!1,LOG_STYLES=!1,LOG_GEST=!1,LOG_MSG=!1,LOG_RES=!0,LOG_RC=!1,LOG_SD=!1,LOG_VID=!0,LOG_MASK=!1,LOG_DOC=!1,LOG_XLS=!1,LOG_SS=!1,debuglog=GLANCE_LOGGER?function(...a){GlanceLogger.log("DEBUG:",...a)}:function(){},diffslog=GLANCE_LOGGER&&LOG_DIFFS?function(...a){GlanceLogger.log("DIFFS:",...a)}:function(){},diffdetlog=
GLANCE_LOGGER&&LOG_DIFFDET?function(...a){GlanceLogger.log("DIFFDET:",...a)}:function(){},drawlog=GLANCE_LOGGER&&LOG_DRAW?function(...a){GlanceLogger.log("DRAW:",...a)}:function(){},preslog=LOG_PRES?function(...a){GlanceLogger.log("PRES:",...a)}:function(){},cbstatelog=GLANCE_LOGGER&&LOG_CBSTATE?function(...a){GlanceLogger.log("CBSTATE:",...a)}:function(){},iframelog=GLANCE_LOGGER&&LOG_IFRAME?function(...a){GlanceLogger.log("IFRAME:",...a)}:function(){},scrolllog=GLANCE_LOGGER&&LOG_SCROLL?function(...a){GlanceLogger.log("SCROLL:",
...a)}:function(){},eventslog=GLANCE_LOGGER&&LOG_EVENTS?function(...a){GlanceLogger.log("EVENTS:",...a)}:function(){},loaderlog=GLANCE_LOGGER&&LOG_LOADER?function(...a){GlanceLogger.log("LOADER:",...a)}:function(){},uilog=GLANCE_LOGGER&&LOG_UI?function(...a){GlanceLogger.log("UI:",...a)}:function(){},focuslog=GLANCE_LOGGER&&LOG_FOCUS?function(...a){GlanceLogger.log("FOCUS:",...a)}:function(){},xdomlog=LOG_XDOM?function(...a){GlanceLogger.log("XDOM:",...a)}:function(){},c3plog=GLANCE_LOGGER&&LOG_C3P?
function(...a){GlanceLogger.log("C3P:",...a)}:function(){},pdflog=GLANCE_LOGGER&&LOG_PDF?function(...a){GlanceLogger.log("PDF:",...a)}:function(){},stylelog=GLANCE_LOGGER&&LOG_STYLES?function(...a){GlanceLogger.log("STYLES:",...a)}:function(){},gestlog=GLANCE_LOGGER&&LOG_GEST?function(...a){GlanceLogger.log("GEST:",...a)}:function(){},msglog=GLANCE_LOGGER&&LOG_MSG?function(...a){GlanceLogger.log("MSG:",...a)}:function(){},reslog=GLANCE_LOGGER&&LOG_RES?function(...a){GlanceLogger.log("RES:",...a)}:
function(){},rclog=GLANCE_LOGGER&&LOG_RC?function(...a){GlanceLogger.log("RC:",...a)}:function(){},sdlog=GLANCE_LOGGER&&LOG_SD?function(...a){GlanceLogger.log("SD:",...a)}:function(){},vidlog=LOG_VID?function(...a){GlanceLogger.log("VID:",...a)}:function(){},masklog=GLANCE_LOGGER&&LOG_MASK?function(...a){GlanceLogger.log("MASK:",...a)}:function(){},doclog=GLANCE_LOGGER&&LOG_DOC?function(...a){GlanceLogger.log("DOC:",...a)}:function(){},sslog=GLANCE_LOGGER&&LOG_SS?function(...a){GlanceLogger.log("SS:",
...a)}:function(){},assert=GLANCE_LOGGER?function(a){if(!a)if(window.console&&window.console.error)GlanceLogger.error("ASSERT");else throw Error("ASSERT");}:function(){};function consolelog(...a){GlanceLogger.log("GLANCE:",...a)}function errorlog(...a){GlanceLogger.error("GLANCE:",...a)};/*
 Copyright (c) 2022 Glance Networks, Inc.
*/
var GLANCE=GLANCE||{};GLANCE.Lib=GLANCE.Lib||{};GLANCE.VERSION="6.3.1.0";GLANCE.PATCH="";window.GLANCE=window.GLANCE||{};window.GLANCE.VERSION=GLANCE.VERSION;window.GLANCE.PATCH=GLANCE.PATCH;window.GLANCE.Lib=window.GLANCE.Lib||{};GLANCE.Lib.KEYTYPE={RANDOM:"GLANCE_KEYTYPE_RANDOM"};GLANCE.Lib.KEYTYPE={RANDOM:"GLANCE_KEYTYPE_RANDOM"};
GLANCE.Lib.MESSAGES={GLANCE_INVOKE_MSG:"glance_invoke",GLANCE_SCREENSHARE:"glance_screenshare",GLANCE_SCREENSHAREPREVIEW:"glance_screensharepreview",GLANCE_VISITOR_SCREENSHAREPREVIEW:"glance_visitor_screensharepreview",GLANCE_AGENTVIDEO:"glance_agentvideo",GLANCE_VIDEOPREVIEW:"glance_videopreview"};GLANCE.Lib.Const={GID:"data-gid",GCID:"data-gcid",SDID:"data-sdid"};GLANCE.Lib.scriptId=function(a){return("glance_"+a).toLowerCase()};
GLANCE.Lib.CallFlags={None:0,Reconnect:1,Reverse:2,Declined:4,Rcrequested:8,Closing:16,Beta:32,MultipleGuestsOk:64,Anonymous:128,Showback:256,GuestNameRequired:512,GuestEmailRequired:1024,GuestPhoneRequired:2048,GuestNameHidden:4096,GuestEmailHidden:8192,GuestPhoneHidden:16384,GuestInfo:32256,Encrypt:32768,ForceAjax:65536,Persist:131072,PresenceStart:262144,StagingSession:524288,HDAgentVideoEnabled:2097152};
GLANCE.Lib.IntVersion=function(){var a=GLANCE.VERSION.split(".");return 1E6*parseInt(a[0])+1E3*parseInt(a[1])+parseInt(a[2])}();GLANCE.Lib.VideoJoinURL=function(a,b){b=b||"clip";return`https://${URL.toString().includes("[native code]")?(new URL(a)).hostname:GLANCE.Lib.GElement.nativeInstance("URL",a).hostname}/viv/VideoPlayer.html?offer=${a}&scaling=${b}&noendpage=1&guestid={guestid}&conntype={role}`};
GLANCE.Lib.Browser=function(){var a=navigator.userAgent.toLowerCase(),b=navigator.platform.toLowerCase(),c=a.match(/(edge)[\s\/:]([\w\d\.]+)?/)||a.match(/(opera|ie|firefox|chrome|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||a.match(/(rv):([\w\d\.]+)/)||[null,"unknown",0];"crios"===c[1]?c[1]="chrome":"rv"===c[1]&&(c[1]="ie");a={extend:Function.prototype.extend,name:"version"==c[1]?c[3]:c[1],version:"ie"==c[1]&&document.documentMode||parseFloat("opera"==c[1]&&c[4]?c[4]:
c[2]),Platform:{name:a.match(/ip(?:ad|od|hone)/)||b.match(/mac/)&&"undefined"!==typeof navigator.standalone?"ios":(a.match(/(?:webos|android)/)||b.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,json:!!window.JSON},Plugins:{},isMobileDevice:function(){return"ios"==this.Platform.name||"android"==this.Platform.name}};document.documentMode&&window.XDomainRequest?(a.name="ie",a.version=document.documentMode):window.navigator&&
navigator.appVersion&&-1!=navigator.appVersion.indexOf("MSIE 7.")&&(a.name="ie",a.version="7");a[a.name]=!0;a[a.name+parseInt(a.version,10)]=!0;a.Platform[a.Platform.name]=!0;return a}();GLANCE.Lib.getIframe=function(a,b){b=b||document;return GLANCE.Lib.GElement.nativeMethod(b,"querySelector","iframe[frameid='"+a+"']")};GLANCE.Lib.equal=function(a,b){return GLANCE.Lib.JSONStringify(a)===GLANCE.Lib.JSONStringify(b)};
GLANCE.Lib.random=function(a){for(a=String(Math.round(Math.random()*Math.pow(10,a)));4>a.length;)a="0"+a;return a};GLANCE.Lib.getCryptoToken=function(a){a=new Uint32Array(Math.ceil(a/32));window.crypto.getRandomValues(a);let b="";a.forEach(c=>{b+=c.toString(36)});return b};GLANCE.Lib.getProperties=function(a,b){var c={},d=new RegExp(b),e;for(e in a)e.match(d)&&(c[e.substr(b.length)]=a[e]);return c};GLANCE.Lib.pointDistance=function(a,b){return Math.max(Math.abs(a.x-b.x),Math.abs(a.y-b.y))};
GLANCE.Lib.Url={};GLANCE.Lib.Url.isAbsolute=function(a){return 0<=a.indexOf("//")||0===a.indexOf("/")};GLANCE.Lib.ExtendableTimer=function(){};GLANCE.Lib.ExtendableTimer.prototype.set=function(a,b){GLANCE.Lib.GElement.nativeMethod(window,"clearTimeout",this.timer);var c=this;this.timer=GLANCE.Lib.GElement.nativeMethod(window,"setTimeout",function(){delete c.timer;b&&b()},a)};GLANCE.Lib.ExtendableTimer.prototype.isSet=function(){return void 0!==this.timer};
GLANCE.Lib.ExtendableTimer.prototype.clear=function(){GLANCE.Lib.GElement.nativeMethod(window,"clearTimeout",this.timer);delete this.timer};void 0===GLANCE.Lib.JSONStringify&&(GLANCE.Lib.JSONStringify=function(a){return GLANCE.Lib.GElement.USE_CLEANCONTEXT&&GLANCE.Lib.GElement.CleanContext?GLANCE.Lib.GElement.CleanContext.window.JSON.stringify(a):JSON.stringify(a)});
GLANCE.Lib._enhanceSocket=function(a){a.onmessage=function(b){b=JSON.parse(b.data);if(a.onreceiveobj)a.onreceiveobj(b)};a.sendobj=function(b){b=GLANCE.Lib.JSONStringify(b);a.send(b)};a.getcode=function(b){return b&&b.code||0};a.getreason=function(b){return b&&b.reason||""};return a};GLANCE.Lib.GWebSocket=function(a){a=new WebSocket(a);GLANCE.Lib._enhanceSocket(a);return a};
GLANCE.Lib.GSockJS=function(a,b){var c={};if(GLANCE.Lib.useIFrameProxy)var d=new GLANCE.Lib.GSockJSProxy(a);else GLANCE.Lib.Browser.ie9&&"http:"===window.location.protocol&&(c.protocols_whitelist=["iframe-eventsource","iframe-htmlfile"]),d=new SockJS(a,"",c);d.hbskipped=0;d.checkheartbeat=function(){d.cancelheartbeatcheck();b&&d.transport&&!d.transport.match(/^iframe-/)&&(d.hbinterval=GLANCE.Lib.GElement.nativeMethod(window,"setInterval",function(){d.hbskipped++;if(d.onheartbeatskipped)d.onheartbeatskipped({hbskipped:d.hbskipped})},
b))};d.cancelheartbeatcheck=function(){d.hbinterval&&GLANCE.Lib.GElement.nativeMethod(window,"clearInterval",d.hbinterval)};GLANCE.Lib._enhanceSocket(d);d.onclose=function(e){d.cancelheartbeatcheck();if(d.on_close)d.on_close(e)};d.onheartbeat=function(){d.hbskipped=0;d.checkheartbeat();if(d.on_heartbeat)d.on_heartbeat()};return d};GLANCE.Lib.RequestProxy={loaded:!1};
GLANCE.Lib.RequestProxy.init=function(a){GLANCE.Lib.RequestProxy.server=a;if(!document.getElementById("glance_request_proxy")){var b=document.createElement("iframe");b.id="glance_request_proxy";b.width="0px";b.height="0px";b.style.border="none";b.src="https://"+a+"/RequestProxy.htm?1";b.onload=function(){GLANCE.Lib.RequestProxy.loaded=!0};document.body.appendChild(b)}GLANCE.Lib.RequestProxy.proxyframe=document.getElementById("glance_request_proxy").contentWindow};
GLANCE.Lib.RequestProxy.postMessage=function(a,b){var c=GLANCE.Lib.RequestProxy;c.loaded?c.proxyframe.postMessage(a,b||"https://"+GLANCE.Lib.RequestProxy.server):GLANCE.Lib.GElement.nativeMethod(window,"setTimeout",function(){c.postMessage(a,b)},100)};
GLANCE.Lib.GSockJSProxy=function(a){this.readyState=SockJS.CONNECTING;this.sockid=Math.round(1E6*Math.random());GLANCE.Lib.GSockJSProxy.sockets=GLANCE.Lib.GSockJSProxy.sockets||{};GLANCE.Lib.GSockJSProxy.sockets[this.sockid]=this;GLANCE.Lib.RequestProxy.postMessage({from:"GSockJSProxy",sockid:this.sockid,cmd:"open",url:a})};GLANCE.Lib.GSockJSProxy.init=function(a){GLANCE.Lib.RequestProxy.init(a);GLANCE.Lib.Window.addEventListener("message",GLANCE.Lib.GSockJSProxy.handleMessage,!1)};
var _protect_gsjsproxyresp={to:0,event:0};
GLANCE.Lib.GSockJSProxy.handleMessage=function(a){if(GLANCE.Lib.getDomain(a.origin)===GLANCE.Lib.getDomain(GLANCE.Lib.RequestProxy.server)&&"undefined"!=typeof a.data.to&&"GSockJSProxy"==a.data.to){var b=GLANCE.Lib.GSockJSProxy.sockets[a.data.sockid];if(b)switch(a.data.event.type){case "open":b.readyState=SockJS.OPEN;if(b.onopen)b.onopen(a.data.event);break;case "heartbeat":b.onheartbeat();break;case "message":b.onmessage(a.data.event);break;case "close":b.readyState=SockJS.CLOSED;b.onclose(a.data.event);
break;default:GLANCE.Lib.log("UNKNOWN GLANCE SOCKJS PROXY MESSAGE: "+JSON.stringify(a.data))}}};GLANCE.Lib.GSockJSProxy.prototype.send=function(a){GLANCE.Lib.RequestProxy.postMessage({from:"GSockJSProxy",sockid:this.sockid,cmd:"send",data:a})};GLANCE.Lib.GSockJSProxy.prototype.close=function(a,b){this.readyState=SockJS.CLOSING;GLANCE.Lib.RequestProxy.postMessage({from:"GSockJSProxy",sockid:this.sockid,cmd:"close"})};GLANCE.Lib.nextGID=1;
GLANCE.Lib.compressObj=function(a){if(void 0===a||null===a)return a;a=GLANCE.Lib.JSONStringify(a);return{_c:GLANCE.Lib.compressToBase64(a)}};GLANCE.Lib.compressToBase64=function(a){a=(new TextEncoder).encode(a);var b=(new window.GLANCE.Lib.Zlib.RawDeflate(a)).compress();a="";b=new Uint8Array(b);for(var c=b.byteLength,d=0;d<c;d++)a+=String.fromCharCode(b[d]);return window.btoa(a)};
GLANCE.Lib.decompressObj=function(a){if(null===a||a instanceof String&&0===a.length)return null;if(void 0===a._c)return a;a=GLANCE.Lib.decompressFromBase64(a._c);return JSON.parse(a)};GLANCE.Lib.decompressFromBase64=function(a){a=window.atob(a);for(var b=a.length,c=new Uint8Array(b),d=0;d<b;d++)c[d]=a.charCodeAt(d);a=(new window.GLANCE.Lib.Zlib.RawInflate(c.buffer)).decompress();return(new TextDecoder).decode(a)};
GLANCE.Lib.pad=function(a,b,c){return(a.length>=c?"":Array(1+c-a.length>>>0).join(b))+a};GLANCE.Lib.hash=function(a){var b=0,c;if(0==a.length)return b;for(c=0;c<a.length;c++){var d=a.charCodeAt(c);b=(b<<5)-b+d;b&=b}return Math.abs(b)};GLANCE.Lib.Params={};GLANCE.Lib.Params.copy=function(a,b,c){if(void 0!==a)return c=c||Object.keys(a),c.forEach(function(d){void 0!==a[d]&&(b[d]=a[d])}),b};
GLANCE.Lib.invokeFunction=function(a){var b=a.func.split(".");if(2>b.length)GLANCE.Lib.errlog("ERR_BADINVOKE:",a.func);else if("GLANCE"===b[0]||"GLANCE_COBROWSE"===b[0]&&"Custom"===b[1]){for(var c=window[b[0]],d=1;d<b.length;d++)if(c=c[b[d]],!c){GLANCE.Lib.errlog("ERR_UNDEFINVOKE:"+b[d]);return}a.args=a.args||{};a.args.remote=!0;c(a.args)}else GLANCE.Lib.errlog("ERR_BADINVOKE:"+b[0])};
GLANCE.Lib.UTCNow=function(){function a(c,d){for(c=c.toString();c.length<d;)c="0"+c;return c}var b=new Date;return b.getUTCFullYear()+"/"+(b.getUTCMonth()+1)+"/"+b.getUTCDate()+" "+a(b.getUTCHours(),2)+":"+a(b.getUTCMinutes(),2)+":"+a(b.getUTCSeconds(),2)};GLANCE.Lib.Timer=function(){this.t=0};GLANCE.Lib.Timer.prototype.elapsed=function(){return(new Date).getTime()-this.t};GLANCE.Lib.Timer.prototype.set=function(){this.t=(new Date).getTime()};GLANCE.Lib.Window={};
GLANCE.Lib.Window.addEventListener=function(a,b,c){GLANCE.Lib.GElement.nativeMethod(window,"addEventListener",a,b,c)};GLANCE.Lib.Window.removeEventListener=function(a,b){GLANCE.Lib.GElement.nativeMethod(window,"removeEventListener",a,b)};GLANCE.Lib.Window.postWindowMessage=function(a,b,c,d){var e={};e[b]=c;a.postMessage(e,void 0!==d?d:"*")};
GLANCE.Lib.Window.onWindowMessage=function(a,b,c){var d=function(e){if("string"===typeof e.data)try{var f=JSON.parse(e.data)}catch(g){return!1}else f=e.data;void 0!==f[a]&&(c&&!GLANCE.Lib.isAllowedOrigin(e.origin,c)?GLANCE.Lib.errlog("UNTRUSTED_ORIGIN:"+e.origin+" "+JSON.stringify(f)):b(e.source,f[a]))};GLANCE.Lib.GElement.nativeMethod(window,"addEventListener","message",d);return d};GLANCE.Lib.Window.POPUP_WINDOW="location=no,menubar=0,titlebar=0,status=0,toolbar=0";
GLANCE.Lib.Window.onPageHide=function(a){GLANCE.Lib.Window.addEventListener(void 0!==window.onpagehide?"pagehide":"unload",a)};GLANCE.Lib.Window.onPageShow=function(a){void 0!==window.onpageshow&&GLANCE.Lib.Window.addEventListener("pageshow",a)};GLANCE.Lib.Window.DOMEvents="DOMAttrModified DOMAttributeNameChanged DOMCharacterDataModified DOMElementNameChanged DOMNodeInserted DOMNodeInsertedIntoDocument DOMNodeRemoved DOMNodeRemovedFromDocument DOMSubtreeModified".split(" ");
GLANCE.Lib.Window.listenForDOMChanges=function(a){var b=!MutationObserver.toString().includes("native code")&&GLANCE.Lib.GElement.USE_CLEANCONTEXT?GLANCE.Lib.GElement.CleanContext:window;GLANCE.Lib.Window.mutationObserver=new b.MutationObserver(a);GLANCE.Lib.Window.mutationObserver.observe(document,{childList:!0,characterData:!0,attributes:!0,subtree:!0})};GLANCE.Lib.Window.stopListenForDOMChanges=function(){GLANCE.Lib.Window.mutationObserver&&GLANCE.Lib.Window.mutationObserver.disconnect();delete GLANCE.Lib.Window.mutationObserver};
GLANCE.Lib.cleanObj=function(a){function b(d){for(var e in d)if("object"===typeof d[e]){b(d[e]);a:{var f=void 0;var g=d[e];if(g instanceof Array||g instanceof String)f=!1;else{for(f in g)if(g.hasOwnProperty(f)){f=!1;break a}f=!0}}f&&delete d[e]}}function c(d){if(!(d instanceof Array||d instanceof String))for(var e in d)void 0===d[e]?delete d[e]:"object"===typeof d[e]&&c(d[e])}c(a);b(a)};GLANCE.Lib.compareObjects=function(a,b){return JSON.stringify(a)===JSON.stringify(b)};
GLANCE.Lib.compareVersions=function(a,b){a=String(a).split(".");var c=String(b).split(".");a.push([0,0,0,0]);c.push([0,0,0,0]);for(b=0;4>b;b++){isNaN(a[b])&&(a[b]=0);isNaN(c[b])&&(c[b]=0);if(Number(a[b])<Number(c[b]))return-1;if(Number(a[b])>Number(c[b]))return 1}return 0};GLANCE.Lib.AppendUrlParams=function(a,b){var c=a.indexOf("#");return 0>c?a+(-1===a.indexOf("?")?"?":"&")+b:GLANCE.Lib.AppendUrlParams(a.substring(0,c),b)+a.substring(c)};GLANCE.Lib.XMLDoc=function(a){this.ownerDoc=a.ownerDocument};
GLANCE.Lib.XMLDoc.prototype.getElementText=function(a){return(a=this.ownerDoc.querySelector(a))?a.textContent:null};
GLANCE.Lib.JSONFetch=async function(a,b){return new Promise(async(c,d)=>{b.headers={"Content-Type":"application/json"};"object"===typeof b.body&&(b.body=JSON.stringify(b.body));let e;try{e=await fetch(a,b)}catch(g){GLANCE.Lib.errlog(`JSON request to ${a} failed: ${g.message}`);d("connection");return}if(e.ok){try{var f=await e.json()}catch(g){GLANCE.Lib.errlog(`JSON request to ${a} reponse parse failed`,g),d("error")}c(f)}else GLANCE.Lib.errlog(`JSON request to ${a} failed status: ${e.status}`),c=
await e.text(),GLANCE.Lib.errlog(c),d(401===e.status||403===e.status?"authorization":"error")})};GLANCE.Lib.Request=function(a){GLANCE.Lib.useIFrameProxy?this.ifproxy=new GLANCE.Lib.Request.IFrameProxyRequest(a):this.xmlhttp=this.getXmlHttp();this.response=null;this.type=a};GLANCE.Lib.Request.prototype.setAuthorizer=function(a){this.authorizer=a};GLANCE.Lib.Request.prototype.setAuthorizationToken=function(a){this.authorizationToken=a};GLANCE.Lib.Request.prototype.getXmlHttp=function(){return new window.XMLHttpRequest};
GLANCE.Lib.Request.prototype.abort=function(){this.ifproxy?this.ifproxy.abort():this.xmlhttp.abort()};
GLANCE.Lib.Request.prototype.onreadystatechange=function(){if(4==this.xmlhttp.readyState){GLANCE.Lib.GElement.nativeMethod(window,"clearTimeout",this.requesttimeout);delete this.requesttimeout;var a="error";if(0==this.xmlhttp.status)GLANCE.Lib.log(this.method+" to "+this.url+" failed: network"),this.onfailure(!0,"connection",this.xmlhttp.status);else if(200!==this.xmlhttp.status){GLANCE.Lib.errlog(this.method+" to "+this.url+" failed with status: "+this.xmlhttp.status);"text"===this.xmlhttp.responseType&&
null!==this.xmlhttp.responseText&&GLANCE.Lib.log(this.xmlhttp.responseText);if(401===this.xmlhttp.status||403===this.xmlhttp.status)a="authorization",this.authorizer&&this.authorizer.clearToken();this.onfailure(!1,a,this.xmlhttp.status)}else{if(""!==this.xmlhttp.response){if("XML"===this.accept)this.response=this.xmlhttp.responseXML&&this.xmlhttp.responseXML.documentElement,null===this.response&&GLANCE.Lib.errlog("Invalid XML response: "+this.xmlhttp.responseText);else if(this.IE11BinaryWorkaround){for(var b=
new Uint8Array(this.xmlhttp.responseText.length),c=0;c<this.xmlhttp.responseText.length;c++)b[c]=this.xmlhttp.responseText.charCodeAt(c)&255;this.response=new Blob([b],{type:this.xmlhttp.getResponseHeader("Content-Type")})}else if("blob"===this.xmlhttp.responseType)this.response=this.xmlhttp.response;else if(this.xmlhttp.responseXML)this.response=this.parsejson(this.xmlhttp.responseXML.childNodes[0].childNodes[0].nodeValue);else if("HTML"===this.accept||"TEXT"===this.accept)this.response=this.xmlhttp.responseText;
else if(this.response=this.parsejson(this.xmlhttp.responseText),null===this.response){GLANCE.Lib.log(this.method+" to "+this.url+" failed - can't parse response "+this.xmlhttp.responseText);this.onfailure(!1,a);return}if(void 0!==this.response.err&&void 0!==this.response.msg){GLANCE.Lib.log(this.method+" to "+this.url+" failed with error:"+this.response.err+" "+this.response.msg);this.onfailure(!1,a);return}}this.onsuccess(this.response)}}};
GLANCE.Lib.Request.prototype.parsejson=function(a){var b=null;try{b=JSON.parse(a)}catch(c){return GLANCE.Lib.log("JSON parse failed with error: "+c.toString()+" parsing: "+a),null}return b};GLANCE.Lib.Request.prototype.getResponseHeader=function(a){return this.xmlhttp.getResponseHeader(a)};
GLANCE.Lib.Request.prototype.setAccept=function(a){this.accept=a;"XML"===a?this.acceptheader="text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8":"JSON"===a?this.acceptheader="application/json, text/javascript, */*; q=0.01":"HTML"===a?this.acceptheader="text/html":"TEXT"===a?this.acceptheader="text/*":"IMAGE"===a?this.acceptheader="image/*":"BINARY"===a&&(this.acceptheader="*/*");if("IMAGE"===a||"BINARY"===a)this.xmlhttp.responseType="blob"};
GLANCE.Lib.Request.appendQueryStringParams=function(a,b){return a+"?"+Object.keys(b).map(function(c){return c+"="+b[c]}).join("&")};GLANCE.Lib.Request.prototype.get=function(a,b,c,d,e){this.method="GET";this.post(a,null,b,c,d,e)};GLANCE.Lib.Request.formUrlEncode=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};
GLANCE.Lib.Request.prototype.post=function(a,b,c,d,e,f){this.url=a;this.onsuccess=void 0!==e?e:function(){};this.onfailure=void 0!==f?f:function(){};this.method=this.method||"POST";if(this.ifproxy)this.ifproxy.post(a,b,c,d,e,f);else{e=this.contenttype||("JSON"===this.type?"application/json; charset=utf-8":"application/x-www-form-urlencoded; charset=utf-8");if("string"===typeof b)var g=b;else b instanceof Blob?(e=b.type,g=b):b&&(g="JSON"===this.type?GLANCE.Lib.JSONStringify(b):"data="+GLANCE.Lib.JSONStringify(b));
var k=this;GLANCE.Lib.Browser.safari&&this.safaritimeout&&(this.requesttimeout=GLANCE.Lib.GElement.nativeMethod(window,"setTimeout",function(){GLANCE.Lib.log(this.method+" to "+this.url+" failed - timedout (Safari)");this.onfailure(!1,"timedout")}.bind(this),this.safaritimeout));this.xmlhttp.onreadystatechange=function(){k.onreadystatechange()};try{this.xmlhttp.open(this.method,a,c),void 0!==this.acceptheader&&this.xmlhttp.setRequestHeader("Accept",this.acceptheader),void 0!==this.xmlhttp.setRequestHeader&&
"GET"!==this.method&&this.xmlhttp.setRequestHeader("Content-type",e),this.authorizer&&this.authorizer.gettoken()?this.xmlhttp.setRequestHeader("Authorization","Bearer "+this.authorizer.gettoken()):this.authorizationToken&&this.xmlhttp.setRequestHeader("Authorization","Bearer "+this.authorizationToken),this.xmlhttp.withCredentials=d,this.xmlhttp.send(g)}catch(l){GLANCE.Lib.log(this.method+" to "+a+" failed with: "+l.toString()),this.onfailure(!1,l.toString())}}};
GLANCE.Lib.Request.IFrameProxyRequest=function(a){this.type=a;GLANCE.Lib.Request.IFrameProxyRequest.currentRequest=this};GLANCE.Lib.Request.IFrameProxyRequest.init=function(a){GLANCE.Lib.RequestProxy.init(a);GLANCE.Lib.Window.addEventListener("message",GLANCE.Lib.Request.IFrameProxyRequest.handleMessage,!1)};
GLANCE.Lib.Request.IFrameProxyRequest.prototype.post=function(a,b,c,d,e,f){this.onsuccess=e;this.onfailure=f;GLANCE.Lib.RequestProxy.postMessage({from:"IFrameProxyRequest",type:this.type,url:a,obj:b,async:c,withcred:d})};GLANCE.Lib.Request.IFrameProxyRequest.prototype.abort=function(){GLANCE.Lib.Request.IFrameProxyRequest.postMessage({from:"IFrameProxyRequest",abort:!0})};var _protect_ifproxyresp={to:0,success:0,response:0};
GLANCE.Lib.Request.IFrameProxyRequest.handleMessage=function(a){if(GLANCE.Lib.getDomain(a.origin)===GLANCE.Lib.getDomain(GLANCE.Lib.RequestProxy.server)&&"undefined"!=typeof a.data.to&&"IFrameProxyRequest"==a.data.to)if(a.data.success)GLANCE.Lib.Request.IFrameProxyRequest.currentRequest.onsuccess(a.data.response);else GLANCE.Lib.Request.IFrameProxyRequest.currentRequest.onfailure()};GLANCE.Lib.Cookie=function(a,b){this.name=a;this.domain=b||(new GLANCE.Lib.Page(window)).getDomain()};
GLANCE.Lib.Cookie.prototype.setObj=function(a,b){var c=new Date;c.setUTCHours(c.getUTCHours()+8);document.cookie=this.name+"="+escape(GLANCE.Lib.JSONStringify(a))+"; expires="+c.toGMTString()+"; domain="+this.domain+"; path=/"+(b||a.secure?";secure":"")};GLANCE.Lib.Cookie.prototype.getObj=function(){var a=this.get();return a?JSON.parse(a):null};
GLANCE.Lib.Cookie.prototype.get=function(){return this.exists()?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(this.name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null};GLANCE.Lib.Cookie.prototype.del=function(){var a=new Date;a.setDate(a.getDate()-1);document.cookie=escape(this.name)+"=; expires="+a.toGMTString()+"; domain="+this.domain+"; path=/"};
GLANCE.Lib.Cookie.prototype.exists=function(){return(new RegExp("(?:^|;\\s*)"+escape(this.name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)};GLANCE.Lib.lsCookie=function(a){this.name=a};GLANCE.Lib.lsCookie.prototype.setObj=function(a){var b=new Date;b.setUTCHours(b.getUTCHours()+8);localStorage.setItem(this.name,GLANCE.Lib.JSONStringify(a));localStorage.setItem(this.name+"_exp",b.toGMTString())};
GLANCE.Lib.lsCookie.prototype.getObj=function(){if(!this.exists())return null;var a=localStorage.getItem(this.name);return JSON.parse(a)};GLANCE.Lib.lsCookie.prototype.setExp=function(a){"string"===typeof a&&(a=parseInt(a));var b=new Date;b.setUTCMinutes(b.getUTCMinutes()+a);localStorage.setItem(this.name+"_exp",b.toGMTString())};GLANCE.Lib.lsCookie.prototype.get=function(){return this.exists()?localStorage.getItem(this.name):null};
GLANCE.Lib.lsCookie.prototype.del=function(){localStorage.removeItem(this.name);localStorage.removeItem(this.name+"_exp")};GLANCE.Lib.lsCookie.prototype.exists=function(){var a=localStorage.getItem(this.name+"_exp");if(!a)return!1;a=new Date(a);return a<new Date?(this.del(),!1):!0};GLANCE.Lib.DualCookie=function(a,b){this.cookies=[new GLANCE.Lib.Cookie(a,b),new GLANCE.Lib.lsCookie(a)]};GLANCE.Lib.DualCookie.prototype.setObj=function(a,b){this.cookies[0].setObj(a,b);this.cookies[1].setObj(a,b)};
GLANCE.Lib.DualCookie.prototype.getObj=function(){return this.cookies[0].getObj()||this.cookies[1].getObj()};GLANCE.Lib.DualCookie.prototype.get=function(){return this.cookies[0].get()||this.cookies[1].get()};GLANCE.Lib.DualCookie.prototype.del=function(){this.cookies[0].del();this.cookies[1].del()};GLANCE.Lib.DualCookie.prototype.exists=function(){return this.cookies[0].exists()||this.cookies[1].exists()};
GLANCE.Lib.formatDocEvent=function(a){var b={};["url","name","visitorselected","agentselected"].forEach(c=>{a.hasOwnProperty(c)&&(b[c]=a[c])});return b};GLANCE.Lib.parseSize=function(a,b,c){b={w:b,h:c};a&&((c=a.match(/(\d+)x(\d+)/))&&3===c.length||GLANCE.Lib.log("ERR_INVALIDDIMS:"+a),b.w=c[1],b.h=c[2]);return b};GLANCE.Lib.Event=function(a){this.event=a||window.event;this.client={x:this.event.clientX,y:this.event.clientY}};GLANCE.Lib.toEvent=function(a){return new GLANCE.Lib.Event(a)};
GLANCE.Lib.Event.fireHTMLEvent=function(a,b){if("undefined"!==typeof CustomEvent)try{var c=new CustomEvent(b)}catch(d){}c||(c=document.createEvent("HTMLEvents"),c.initEvent(b,!0,!0));a.dispatchEvent(c)};GLANCE.Lib.Event.fireKeyboardEvent=function(a,b){b=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:String.fromCharCode(b.code),"char":String.fromCharCode(b.code),shiftKey:!1});a.dispatchEvent(b)};
GLANCE.Lib.cssEscape=function(a){function b(d,e,f){d=48+parseInt(d);return"\\"+GLANCE.Lib.pad(d.toString(16),"0",6)}function c(d,e,f){return"\\"+d}if(a)return a=a.trim().replace(/[^\w\d-_]/g,c),/^\d/.test(a)&&(a=a.replace(/^\d/,b)),/^-/.test(a)&&(a=a.replace(/^-/,c)),a};
GLANCE.Lib.Page=function(a){this.doc=a.document;this.wnd=a;this.mouse={x:-1,y:-1};this.browser=GLANCE.Lib.Browser;var b=[["hidden","visibilitychange"],["mozHidden","mozvisibilitychange"],["webkitHidden","webkitvisibilitychange"],["msHidden","msvisibilitychange"],["oHidden","ovisibilitychange"]];for(a=0;a<b.length;a++)if(b[a][0]in document){this.HIDDENATTR=b[a][0];this.VISCHANGEEVT=b[a][1];break}};
GLANCE.Lib.hostFromUrl=function(a){var b=a;a=a.split("?");1<a.length&&(b=a[0]);b=(new RegExp(/(?:.*?:\/\/){0,1}([^\/:]+)/)).exec(b);return null===b||2>b.length||0>b[1].indexOf(".")?null:b[1]};
GLANCE.Lib.getDomain=function(a){var b=new RegExp(/^(?:[a-z]{1,5}:\/\/|)([^:\?\/]*)/),c=a.match(/^\d+\.\d+.\d+.\d+$/);b=b.exec(a);if(c)return a;if(null===b||2!==b.length)return"about:"!==a&&GLANCE.Lib.log("ERR_DOMAINPARSE: "+a),null;c=b[1].split(".");return 1===c.length?(GLANCE.Lib.log("ERR_DOMAINPARSE: "+a),null):2===c.length?c.join("."):3===c.length?c.slice(1).join("."):4>=c[c.length-2].length?c.slice(c.length-3).join("."):c.slice(c.length-2).join(".")};
GLANCE.Lib.isAllowedOrigin=function(a,b){var c=!1;a=GLANCE.Lib.hostFromUrl(a);if(null===a||!b)return!1;b.forEach(function(d,e){"object"===typeof d&&(d=d.domain);if(a.match(new RegExp("\\."+d+"$","i"))||a===d)c={index:e,domain:d}});return c};GLANCE.Lib.Page.prototype.getStylesheet=function(a){for(var b=this.doc.styleSheets,c=0;c<b.length;c++)if(b[c].ownerNode&&b[c].ownerNode.getAttribute(GLANCE.Lib.Const.GID)===a.getAttribute(GLANCE.Lib.Const.GID))return b[c];return null};
GLANCE.Lib.Page.prototype.getURL=function(){return window.location.href.replace(/\?.*/g,"")};GLANCE.Lib.Page.prototype.getProto=function(){for(var a=this.wnd.location.protocol,b=this.wnd;("about:"===a||"javascript:"===a)&&b.parent!==b;)a=b.parent.location.protocol,b=b.parent;return a.replace(/:/g,"")};GLANCE.Lib.Page.prototype.isSrclessIframe=function(){return this.wnd.parent!==this.wnd&&""===this.wnd.location.hostname};
GLANCE.Lib.Page.prototype.getDomain=function(){for(var a=this.wnd.location.hostname,b=this.wnd;""===a&&b.parent!==b;)a=b.parent.location.hostname,b=b.parent;return GLANCE.Lib.getDomain(a)};GLANCE.Lib.Page.prototype.inList=function(a){for(var b=window.location.href.toLowerCase(),c=0;c<a.length;c++)if(0<=b.indexOf(a[c].toLowerCase()))return!0;return!1};
GLANCE.Lib.stringToBlob=function(a,b){for(var c=new ArrayBuffer(a.length),d=new Uint8Array(c),e=0,f=a.length;e<f;e++)d[e]=a.charCodeAt(e);return new Blob([c],{type:b})};GLANCE.Lib.trapFocusInIframe=function(){["first","last"].forEach(function(a){let b=document.querySelector("."+a+"control");b&&(b.addEventListener("keydown",function(c){("Tab"===c.key&&"last"===a&&!c.shiftKey||"first"===a&&c.shiftKey)&&c.preventDefault()}),"first"===a&&b.focus())})};
GLANCE.Lib.getScrollables=function(a){function b(d){if(d=GLANCE.Lib.GElement.nativeGetProperty("children",d))for(var e=0;e<d.length;e++)GLANCE.Lib.toElem(d[e]).isScrollable()&&c.push(d[e]),b(d[e])}var c=[];b(a);return c};GLANCE.Lib.Page.prototype.getElementsByTagName=function(a){return GLANCE.Lib.GElement.nativeMethod(this.doc,"getElementsByTagName",a)};
GLANCE.Lib.Page.prototype.isLinkToOtherDomain=function(a){for(var b,c=this.getDomain();a&&!GLANCE.Lib.toElem(a).isBody();){if(a instanceof DocumentFragment){a=null;break}if("a"===a.tagName.toLowerCase())break;a=a.parentNode}if(!a||"a"!==a.tagName.toLowerCase())return!1;b=a.href;b=b.baseVal||b;var d=b.indexOf("//");if(0>d)return!1;0===d&&(b="http:"+b);return a.hasAttribute("download")||b.startsWith("blob:")?!1:GLANCE.Lib.getDomain(b)!==c};
GLANCE.Lib.Page.prototype.getUrlParam=function(a){a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(this.wnd.location.href);return null==a?"":a[1]};GLANCE.Lib.Page.prototype.addScriptAsync=async function(a){return new Promise((b,c)=>{var d=this.doc.createElement("script");d.onload=b;d.onerror=c;for(const e in a)d.setAttribute(e,a[e]);d.setAttribute("charset","UTF-8");this.doc.head.appendChild(d)})};
GLANCE.Lib.Page.prototype.addScript=function(a,b,c){var d=this.doc.createElement("script");b&&d.addEventListener("load",b);c&&d.addEventListener("error",c);d.setAttribute("type","text/javascript");d.setAttribute("charset","UTF-8");for(b=0;b<a.length;b++)d.setAttribute(a[b][0],a[b][1]);this.doc.head.appendChild(d);return d};GLANCE.Lib.Page.prototype.VSCROLL=1;GLANCE.Lib.Page.prototype.HSCROLL=2;
GLANCE.Lib.Page.prototype.getScrollVisible=function(a){var b=this.getDimensions(),c=this.getDocDimensions(),d=GLANCE.Lib.Page.getComputedStyle(this.doc.body);if(null===d)return!1;var e=a===this.VSCROLL?d.overflowY:d.overflowX;return(a===this.VSCROLL?c.y:c.x)>(a===this.VSCROLL?b.y:b.x)&&("visible"===d.overflow||"visible"===e||"auto"===d.overflow||"auto"===e||"scroll"===e)};GLANCE.Lib.Page.prototype.getElement=function(a){return GLANCE.Lib.GElement.nativeMethod(this.doc,"getElementById",a)};
GLANCE.Lib.Page.prototype.trackMouse=function(){var a=this;this.onMouseMove=function(b){b=new GLANCE.Lib.Event(b);a.mouse.x=b.client.x||-1;a.mouse.y=b.client.y||-1;return!0};this.onMouseOut=function(b){new GLANCE.Lib.Event(b);a.mouse.x=-1;a.mouse.y=-1;return!0};this.addEventListener("mousemove",this.onMouseMove);this.addEventListener("mouseout",this.onMouseOut)};
GLANCE.Lib.Page.prototype.stopTrackMouse=function(){this.doc.removeEventListener("mousemove",this.onMouseMove);this.doc.removeEventListener("mouseout",this.onMouseOut)};GLANCE.Lib.Page.prototype.trackMouseClick=function(){var a=this;this.clearMouseClick();this.onMouseClick=function(b){b=new GLANCE.Lib.Event(b);a.click.x=b.client.x||0;a.click.y=b.client.y||0;a.click.ts=Date.now();return!0};this.addEventListener("click",this.onMouseClick)};
GLANCE.Lib.Page.prototype.stopTrackMouseClick=function(){this.doc.removeEventListener("click",this.onMouseClick)};GLANCE.Lib.Page.prototype.getMouse=function(){return this.getElemRelativeCoords(this.mouse)};GLANCE.Lib.Page.prototype.clearMouse=function(){this.mouse={x:-1,y:-1}};GLANCE.Lib.Page.prototype.getMouseClick=function(){var a=this.click;this.click={x:-1,y:-1};return this.getElemRelativeCoords(a)};GLANCE.Lib.Page.prototype.clearMouseClick=function(){this.click={x:-1,y:-1}};
GLANCE.Lib.Page.prototype.isHidden=function(){return void 0===this.HIDDENATTR?!1:this.doc[this.HIDDENATTR]};GLANCE.Lib.Page.prototype.onVisibilityChange=function(a){this.doc.addEventListener(this.VISCHANGEEVT,a)};
GLANCE.Lib.Page.prototype.getNonFixedElemNear=function(a,b){function c(g){if(!g||"body"===g.tagName.toLowerCase())return!1;let k=GLANCE.Lib.Page.getComputedStyle(g).position;return"fixed"===k||"sticky"===k?!0:c(GLANCE.Lib.GElement.nativeGetProperty("parentElement",g))}var d,e=0,f={};for(GLANCE.Lib.Params.copy(a,f);(d=this.getElemAt(f))&&c(d);)if(scrolllog("skipping fixed elem "+d.tagName+"  class="+d.getAttribute("class")+" data-gid="+d.getAttribute(GLANCE.Lib.Const.GID)+" at "+JSON.stringify(f)),
f[b]+=50,10<e++)return scrolllog("getNonFixedElemNear not finding a non fixed element, returning body"),document.body;scrolllog("getNonFixedElemNear found non-fixed elem "+d.tagName+"  class="+d.getAttribute("class")+" data-gid="+d.getAttribute(GLANCE.Lib.Const.GID)+" at "+JSON.stringify(f));return d||document.body};GLANCE.Lib.Page.prototype.getElemAt=function(a){a=document.elementsFromPoint(a.x,a.y).filter(b=>"glance_overlay"!==b.id)[0];a||(a=document.body);3==a.nodeType&&(a=a.parentNode);return a};
GLANCE.Lib.Page.coordsOutside=function(a){a=a.client||a;return 0>a.x||0>a.y};
GLANCE.Lib.Page.prototype.getElemRelativeCoords=function(a,b,c){if(a&&(0>a.x||0>a.y))return{client:{x:Math.round(a.x),y:Math.round(a.y)}};a=a||this.pageToClientCoords(b);b=b||this.clientToPageCoords(a);c=GLANCE.Lib.toElem(c?this.getNonFixedElemNear(a,c):this.getElemAt(a));if(c.matches("#glance_session_widget *")||c.matches("#glance_screensharepreview"))c=GLANCE.Lib.toElem(document.getElementById("glance_session_widget"));var d=c.getCoords();return{client:{x:Math.round(a.x),y:Math.round(a.y)},relative:{x:Math.round(b.x-
d.x),y:Math.round(b.y-d.y),element:c.getPath()}}};GLANCE.Lib.Page.prototype.getElemRelativeOffset=function(a,b){if(0===b)return{offset:0};var c=this.getScrollCoords(a,b);c=this.getElemRelativeCoords(void 0,c,a).relative;return{offset:b,relative:{element:c.element,offset:c[a]}}};GLANCE.Lib.Page.prototype.relativeOffsetToPage=function(a,b,c){if(!b)return c;var d={element:b.element};d[a]=b.offset;d["x"===a?"y":"x"]=0;return(b=this.relativeCoordsToPage(d))?b[a]:c};
GLANCE.Lib.Page.prototype.relativeCoordsToClient=function(a,b){return(a=this.relativeCoordsToPage(a))?this.pageToClientCoords(a):b};GLANCE.Lib.Page.prototype.relativeCoordsToPage=function(a,b){var c=a?GLANCE.Lib.toElem(this.doc.documentElement).getUniqueElement(a.element,!1):null;if(null===c)return GLANCE.Lib.log("Element not found for relative coords"),b;b=GLANCE.Lib.toElem(c).getCoords();return{x:b.x+a.x,y:b.y+a.y}};
GLANCE.Lib.Page.prototype.toAbsoluteUrls=function(a,b){var c,d=this;return a.replace(RegExp("url\\s*\\(['\"]?(\\s*(?!.*//.*).+?)['\"]?\\)","g"),function(e,f){"/"!==f.charAt(0)&&(c=d.getPath())&&(f=c+f);return"url("+b+d.wnd.location.host+f+")"})};GLANCE.Lib.Page.prototype.head=function(){return void 0!==this.doc.head?this.doc.head:this.getElementsByTagName("head")[0]};GLANCE.Lib.Page.prototype.cloneBody=function(){return GLANCE.Lib.toElem(this.doc.body).deepClone()};
GLANCE.Lib.Page.prototype.cloneHead=function(){return this.doc.head.cloneNode(!0)};GLANCE.Lib.Page.prototype.addLoadListener=function(a){this.wnd.addEventListener&&(document.readyState.match(/complete/)?a():(this.wnd.addEventListener("load",a),this.doc.addEventListener("DOMContentLoaded",a,!1)))};GLANCE.Lib.Page.prototype.getDocContainer=function(){return this.doc.compatMode&&"CSS1Compat"!==this.doc.compatMode?this.doc.body:this.doc.documentElement};
GLANCE.Lib.Page.prototype.getDimensions=function(){if(void 0!==window.orientation)return{x:window.innerWidth,y:window.innerHeight};var a=this.getDocContainer();return{x:a.clientWidth,y:a.clientHeight}};GLANCE.Lib.Page.prototype.getDocDimensions=function(){if(this.doc.width)return{x:this.doc.width,y:this.doc.height};var a=this.getDocContainer();return{x:a.scrollWidth,y:a.scrollHeight}};
GLANCE.Lib.Page.prototype.getScrollInfo=function(){for(var a=this.getDimensions(),b=this.getDocDimensions(),c=["x","y"],d,e,f,g,k={},l=0;l<c.length;l++)d=c[l],e=Math.round(Math.pow(a[d],2)/b[d]),f=a[d]-4,g=0,b[d]>a[d]&&(g=(f-e)/(b[d]-a[d])),g=Math.round(1E4*g)/1E4,k[d]={tabsz:e,ratio:g};return k};
GLANCE.Lib.Page.prototype.getScroll=function(){if(void 0!==window.pageXOffset)return{x:Math.round(this.wnd.pageXOffset),y:Math.round(this.wnd.pageYOffset)};if(void 0!==document.documentElement.scrollTop)return{x:this.doc.documentElement.scrollLeft,y:this.doc.documentElement.scrollTop};if(void 0!==document.body.scrollLeft)return{x:this.doc.body.scrollLeft,y:this.doc.body.scrollTop};throw Error("Can't get page scroll");};
GLANCE.Lib.Page.prototype.getScrollCoords=function(a,b){var c=this.getDimensions(),d=this.getScroll();return{x:"x"===a?b:c.x/2+d.x,y:"y"===a?b:c.y/2+d.y}};GLANCE.Lib.Page.prototype.pageToClientCoords=function(a){var b=this.getScroll();return{x:a.x-b.x,y:a.y-b.y}};GLANCE.Lib.Page.prototype.clientToPageCoords=function(a){var b=this.getScroll();return{x:a.x+b.x,y:a.y+b.y}};
GLANCE.Lib.Page.prototype.scrollTo=function(a,b,c){var d=this.getScroll();d[a]=b;a={left:d.x,top:d.y,behavior:c?"smooth":"auto"};GLANCE.Lib.Browser.ie11||GLANCE.Lib.Browser.edge?window.scrollTo(d.x,d.y):window.scrollTo(a);scrolllog("scrolled the page to:",d,"new scroll position:",this.getScroll())};GLANCE.Lib.Page.prototype.getPath=function(){var a=this.origPath(),b=a.match(/(((.*?)\/)*)([^\/]+)/);return 0>a.indexOf(".")?a:b?b[1]:null};
GLANCE.Lib.Page.prototype.getBasePath=function(){let a=new URL(document.baseURI),b=a.pathname.split("/");0<b.slice(-1).indexOf(".")&&(b=b.slice(0,-1));return a.origin+b.join("/")};GLANCE.Lib.Page.prototype.origPath=function(){return window.GLANCE.Cobrowse.Loader._origpath};GLANCE.Lib.Page.prototype.pathChanged=function(){return window===window.parent&&window.location.pathname!==this.origPath()};GLANCE.Lib.Page.getComputedStyle=function(a,b){return window.getComputedStyle(a,b)};
GLANCE.Lib.Page.prototype.addEventListener=function(a,b,c){GLANCE.Lib.GElement.nativeMethod(this.doc,"addEventListener",a,b,c)};GLANCE.Lib.Page.prototype.removeEventListener=function(a,b,c){GLANCE.Lib.GElement.nativeMethod(this.doc,"removeEventListener",a,b,c)};GLANCE.Lib.errlog=function(a){GlanceLogger.error(a)};GLANCE.Lib.log=function(a){GlanceLogger.log(a)};
GLANCE.Lib.moo={extendElement:function(a){a.playAnimation=function(b,c){window.clearTimeout(a.timeout);a.removeClass(b);window.requestAnimationFrame(function(d){window.requestAnimationFrame(function(e){a.addClass(b);a.timeout=window.setTimeout(()=>{a.removeClass("remoteclick")},c)})})}}};GLANCE.Lib.GElement=function(a){this.element=a};GLANCE.Lib.toElem=function(a){return new GLANCE.Lib.GElement(a)};
GLANCE.Lib.GElement.prototype.show=function(a){void 0===a&&(a=!0);this.element.className.match(new RegExp(a?"glance_show":"glance_hide","g"))||(this.replaceClass(a?"glance_hide":"glance_show",a?"glance_show":"glance_hide"),this.addClass(a?"glance_show":"glance_hide"))};GLANCE.Lib.GElement.prototype.dummyOuterHTML=function(){var a=this.element.id?' id="'+this.element.id+'"':"";return"<meta "+GLANCE.Lib.Const.GID+'="'+this.element.getAttribute(GLANCE.Lib.Const.GID)+'"'+a+"></meta>"};
GLANCE.Lib.GElement.prototype.addClass=function(a){"string"===typeof this.element.className&&this.element.className.match(new RegExp("\\b"+a+"\\b","g"))||(this.element.className+=" "+a)};GLANCE.Lib.GElement.prototype.removeClass=function(a){this.element.className=this.element.className.replace(new RegExp("\\s+"+a,"g"),"")};GLANCE.Lib.GElement.prototype.replaceClass=function(a,b){this.element.className=this.element.className.replace(new RegExp(a,"g"),b)};
GLANCE.Lib.GElement.prototype.addEventListener=function(a,b,c){GLANCE.Lib.GElement.nativeMethod(this.element,"addEventListener",b,c)};GLANCE.Lib.GElement.prototype.removeEventListener=function(a,b,c){GLANCE.Lib.GElement.nativeMethod(this.element,"removeEventListener",b,c)};GLANCE.Lib.GElement.prototype.isTextInput=function(){return this.element.tagName.match(/^textarea$/i)||this.element.type.match(/^(text|datetime|email|password|tel|url|number)$/i)};
GLANCE.Lib.GElement.prototype.isButtonInput=function(){return this.element.tagName.match(/^input$/i)&&this.element.type.match(/^(radio|checkbox|button)$/i)};GLANCE.Lib.GElement.prototype.hasNativeShadowRoot=function(){return this.element.attachShadow==Element.prototype.attachShadow&&GLANCE.Lib.GElement.nativeGetProperty("shadowRoot",this.element)};
GLANCE.Lib.GElement.prototype.hasGIDlessDescendants=function(){for(var a=GLANCE.Lib.GElement.nativeMethod(this.element,"querySelectorAll","*"),b=0;b<a.length;b++)if(!a[b].getAttribute(GLANCE.Lib.Const.GID))return!0;return!1};
GLANCE.Lib.GElement.prototype.simulateMouseEvent=function(a,b){"click"===a&&this.element.tagName.match(/input|textarea/i)&&(this.element.focus(),this.isTextInput()&&"number"!==this.element.type&&(this.element.selectionStart=this.element.selectionEnd));if("click"===a&&void 0!==this.element.click)this.element.click();else{void 0===b&&(b={view:window,bubbles:!0,cancelable:!0});try{var c=new MouseEvent(a,b)}catch(d){c=this.element.ownerDocument.createEvent("MouseEvents"),c.initMouseEvent(a,!0,!0,this.element.ownerDocument.defaultView,
1,0,0,0,0,!1,!1,!1,!1,1,null)}this.element.dispatchEvent(c)}};
GLANCE.Lib.GElement.nativeGetProperty=function(a,b){if(!GLANCE.Lib.GElement.USE_CLEANCONTEXT||1!==b.nodeType)return b[a];var c=GLANCE.Lib.GElement.USE_CLEANCONTEXT?GLANCE.Lib.GElement.CleanContext:window;if(GLANCE.Lib.GElement.USE_CLEANCONTEXT)try{var d=c.document.createElement(b.nodeName)}catch(f){d=c.document.createElement("div")}else d=b;d=c.Object.getPrototypeOf(d);if(!d)return b[a];if("contentWindow"===a)return c.Object.getOwnPropertyDescriptor(d,a).get.call(b);for(var e;!(e=c.Object.getOwnPropertyDescriptor(d,
a))||0>e.get.toString().indexOf("[native code]");)if(d=c.Object.getPrototypeOf(d),!d)return b[a];return e.get.call(b)};
GLANCE.Lib.GElement.nativeMethod=function(a,b,...c){return GLANCE.Lib.GElement.USE_CLEANCONTEXT&&GLANCE.Lib.GElement.CleanContext&&a.nodeType?"#document"===a.nodeName?GLANCE.Lib.GElement.CleanContext.document[b].apply(a,c):"#document-fragment"===a.nodeName?GLANCE.Lib.GElement.CleanContext.DocumentFragment.prototype[b].apply(a,c):GLANCE.Lib.GElement.CleanContext.document.body[b].apply(a,c):GLANCE.Lib.GElement.USE_CLEANCONTEXT&&GLANCE.Lib.GElement.CleanContext&&"[object Window]"===a.toString()?GLANCE.Lib.GElement.CleanContext.window[b].apply(a,
c):a[b].apply(a,c)};
GLANCE.Lib.GElement.getNativeMethod=function(a,b){return GLANCE.Lib.GElement.USE_CLEANCONTEXT&&GLANCE.Lib.GElement.CleanContext&&GLANCE.Lib.GElement.CleanContext.document[a]?"#document"===b.nodeName?GLANCE.Lib.GElement.CleanContext.document[a]:"#document-fragment"===b.nodeName?GLANCE.Lib.GElement.CleanContext.DocumentFragment.prototype[a]:GLANCE.Lib.GElement.CleanContext.document.body[a]:GLANCE.Lib.GElement.USE_CLEANCONTEXT&&GLANCE.Lib.GElement.CleanContext&&"[object Window]"===b.toString()?GLANCE.Lib.GElement.CleanContext.window[a]:
b[a]};GLANCE.Lib.GElement.nativeInstance=function(a,...b){a=GLANCE.Lib.GElement.CleanContext.window[a];return new (Function.bind.apply(a,[a,...b]))};
GLANCE.Lib.GElement.prototype.deepClone=function(){try{if(GLANCE.Lib.GElement.USE_CLEANCONTEXT)if(GLANCE.Lib.GElement.CleanContext.clone)var a=GLANCE.Lib.GElement.CleanContext.clone(this.element);else diffslog("clean context clone not loaded  cloning "+this.element.gid+" iframe:"+window.parent!==window),a=GLANCE.Lib.GElement.nativeMethod(this.element,"cloneNode",!0);else a=this.element.cloneNode(!0);return a}catch(b){GLANCE.Lib.log("deepClone failed for "+this.element.tagName+" error:"+b.message)}return this.element.cloneNode(!0)};
GLANCE.Lib.GElement.prototype.isDescendantOf=function(a){return a.contains?GLANCE.Lib.Browser.ie11&&this.element.nodeType===Node.TEXT_NODE?this.element.parentNode===a||GLANCE.Lib.GElement.nativeMethod(a,"contains",this.element.parentNode):GLANCE.Lib.GElement.nativeMethod(a,"contains",this.element):!1};GLANCE.Lib.GElement.prototype.remove=function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)};
GLANCE.Lib.GElement.prototype.isScrollable=function(){if(!this.element)return!1;var a=window.getComputedStyle(this.element);return null===a?!1:(a.overflowX+a.overflowY).match(/scroll|auto/)};GLANCE.Lib.GElement.prototype.replaces=function(a){this.element.parent.replaceChild(this.element,a)};GLANCE.Lib.GElement.prototype.empty=function(){for(;this.element.hasChildNodes();)this.element.removeChild(this.element.childNodes[0])};
GLANCE.Lib.GElement.prototype.getDimensions=function(){if(this.element.getBoundingClientRect){var a=this.element.getBoundingClientRect();return{width:Math.round(a.right-a.left),height:Math.round(a.bottom-a.top)}}return{width:this.element.offsetWidth,height:this.element.offsetHeight}};GLANCE.Lib.GElement.prototype.setDimensions=function(a,b){this.element.style.width=a+"px";this.element.style.height=b+"px"};GLANCE.Lib.GElement.prototype.isBody=function(){return/^(?:body|html)$/i.test(this.element.tagName)};
GLANCE.Lib.GElement.prototype.isHead=function(){return/^(?:head)$/i.test(this.element.tagName)};GLANCE.Lib.GElement.prototype.isHeadOrHeadChild=function(){return this.isHead()||this.isDescendantOf(document.head)};GLANCE.Lib.GElement.prototype.getScrolls=function(){for(var a=this.element.parentNode,b={x:0,y:0};a&&!GLANCE.Lib.toElem(a).isBody();)b.x+=a.scrollLeft,b.y+=a.scrollTop,a=a.parentNode;return b};
GLANCE.Lib.GElement.prototype.getCoords=function(a){if(this.element.tagName.match(/html/i))return{x:0,y:0};var b=this.element.getBoundingClientRect(),c=document.documentElement,d=(new GLANCE.Lib.Page(window)).getScroll();if(a=!a)a=GLANCE.Lib.Page.getComputedStyle(this.element),a="fixed"===(a?a.getPropertyValue("position"):"");return{x:parseInt(b.left)+(a?0:d.x)-c.clientLeft,y:parseInt(b.top)+(a?0:d.y)-c.clientTop}};
GLANCE.Lib.GElement.prototype.setCoords=function(a,b){this.element.style.left=a+"px";this.element.style.top=b+"px"};GLANCE.Lib.GElement.prototype.positionAtZero=function(){if("static"!==GLANCE.Lib.Page.getComputedStyle(document.body).position){let a=GLANCE.Lib.toElem(document.body).getCoords(!0);this.setCoords(-a.x,-a.y)}else this.setCoords(0,0)};
GLANCE.Lib.GElement.prototype.containsElemCoords=function(a){var b=a.getCoords();a=a.getDimensions();var c=this.getCoords(),d=this.getDimensions();return!(b.x+a.width>c.x+d.width||b.x<c.x||b.y+a.height>c.y+d.height||b.y<c.y)};
GLANCE.Lib.GElement.prototype.pointInScrollbar=function(a){if(!this.isScrollable())return!1;var b=this.element.getBoundingClientRect();return a.y>b.top&&a.y<b.bottom&&a.x>b.left+this.element.clientWidth&&a.x<b.right||a.x>b.left&&a.x<b.right&&a.y>b.top+this.element.clientHeight&&a.y<b.bottom};
GLANCE.Lib.GElement.prototype.moveTo=function(a,b){function c(){10>g++?(e+=k,f+=l,d.setCoords(Math.floor(e),Math.floor(f)),d.movetimer=GLANCE.Lib.GElement.nativeMethod(window,"setTimeout",c,20)):d.setCoords(a,b)}void 0!==this.movetimer&&GLANCE.Lib.GElement.nativeMethod(window,"clearTimeout",this.movetimer);var d=this,e=parseInt(this.element.style.left),f=parseInt(this.element.style.top);isNaN(e)&&(e=-999);isNaN(f)&&(f=-999);var g=0,k=(a-e)/10,l=(b-f)/10;0===k&&0===l||c()};
GLANCE.Lib.GElement.prototype.cancelFade=function(){null!=this.fadeStartTimer&&GLANCE.Lib.GElement.nativeMethod(window,"clearTimeout",this.fadeStartTimer);this.fadeStartTimer=null;this.fadeInterval&&GLANCE.Lib.GElement.nativeMethod(window,"clearInterval",this.fadeInterval);this.fadeInterval=null};GLANCE.Lib.GElement.prototype.setOpacity=function(a){this.opacity=a;this.element.style.opacity=this.opacity/100;this.element.style.filter="alpha(opacity = "+this.opacity+")"};
GLANCE.Lib.GElement.prototype.fade=function(a,b,c){var d=this,e=new Date;null!==this.fadeInterval&&this.cancelFade();this.fadeInterval=GLANCE.Lib.GElement.nativeMethod(window,"setInterval",function(){var f=new Date-e;f>=a?(d.setOpacity(0),d.cancelFade(),c&&c()):d.setOpacity(Math.max(0,b(f/a)))},50)};
GLANCE.Lib.GElement.prototype.getSelectorRelativeToParent=function(){var a,b=1,c=this.tagNameLCase();for(a=this.element.previousElementSibling;null!=a;a=a.previousElementSibling)a.tagName.toLowerCase()===c&&b++;return GLANCE.Lib.cssEscape(c)+":nth-of-type("+b+")"};GLANCE.Lib.GElement.prototype.tagNameLCase=function(){return this.element==document?"document":this.element.tagName.toLowerCase()};
GLANCE.Lib.GElement.prototype.cssid=function(){var a=this.element.getAttribute("id");return a?"#"+GLANCE.Lib.cssEscape(a):void 0};GLANCE.Lib.GElement.prototype.isSelectiveEditable=function(){return!this.element.matches(".glance_masked")&&(this.element.matches(".glance_controllable")||this.element.matches(".glance_controllable *"))};
GLANCE.Lib.GElement.prototype.getPath=function(){for(var a=[],b=this,c;b.element&&b.element.tagName;){if(b.isBody()||b.isHead()){a.unshift(b.tagNameLCase());break}var d=GLANCE.Lib.GElement.nativeGetProperty("parentNode",b.element);if(null===d)return null;c=b.cssid();if(b.element.getAttribute(GLANCE.Lib.Const.GID)){a.unshift("["+GLANCE.Lib.Const.GID+'="'+b.element.getAttribute(GLANCE.Lib.Const.GID)+'"]');break}else if(c&&1===GLANCE.Lib.toElem(d).getElements(c).length){if(a.unshift(c),1===GLANCE.Lib.toElem(document.documentElement).getElements(c).length)break}else a.unshift(b.getSelectorRelativeToParent());
b=GLANCE.Lib.toElem(d)}return a.join(">")};GLANCE.Lib.GElement.matchesShim=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.msMatchesSelector;GLANCE.Lib.GElement.prototype.matches=function(a){return GLANCE.Lib.GElement.matchesShim.call(this.element,a)};GLANCE.Lib.GElement.prototype.matchesAny=function(a){return 0<a.length&&this.matches(a.join(","))};
GLANCE.Lib.GElement.prototype.getElements=function(a){return GLANCE.Lib.GElement.nativeMethod(this.element,"querySelectorAll",a)};GLANCE.Lib.GElement.prototype.getShadowDOMElementPath=function(a){if(!a)return null;a=a.replace(/'/g,'"');return(a=a.match(new RegExp("\\["+GLANCE.Lib.Const.GID+'="(.*-.*)"\\]')))&&2===a.length?a[1]:null};
GLANCE.Lib.GElement.prototype.findElementInShadowDOM=function(a){function b(d,e,f){if(null===d)return sdlog("No shadow root at level "+f+"for selector "+a),null;var g="["+GLANCE.Lib.Const.GID+"='"+e.slice(0,f+1).join("-")+"']";d=GLANCE.Lib.GElement.nativeMethod(d,"querySelector",g);return d?f===e.length-1?d:b(d.shadowRoot,e,f+1):(sdlog("sdid "+g+" not found"),null)}var c=this.getShadowDOMElementPath(a);if(!c)return null;c=c.split("-");return b(this.element.ownerDocument,c,0)};
GLANCE.Lib.GElement.prototype.getUniqueElement=function(a,b){function c(e){if(b)throw Error(e);GLANCE.Lib.log(e);return null}if(this.element===document.documentElement&&"html"===a)return this.element;void 0===b&&(b=!0);var d=GLANCE.Lib.GElement.nativeMethod(this.element,"querySelectorAll",a);return 1===d.length?d[0]:1<d.length?c("Nonunique selector: "+a):(d=this.findElementInShadowDOM(a))?d:c("Element not found: "+a)};
GLANCE.Lib.GElement.prototype.getInputValue=function(a){var b=GLANCE.Lib.GElement.nativeGetProperty("type",this.element)||"";a={tag:GLANCE.Lib.GElement.nativeGetProperty("tagName",this.element),type:b,path:this.getPath(),id:GLANCE.Lib.GElement.nativeGetProperty("id",this.element),name:GLANCE.Lib.GElement.nativeGetProperty("name",this.element),sel:GLANCE.Lib.GElement.nativeGetProperty("selectedIndex",this.element),value:a||GLANCE.Lib.GElement.nativeGetProperty("value",this.element)};"string"===typeof a.value&&
(a.value=a.value.replace(/<\/script>/gi,"<\\/script>"));b.match(/^(radio|checkbox)$/i)&&(a.checked=this.element.checked);return a};GLANCE.Lib.GElement.prototype.setInputValue=function(a){switch(a.type.toLowerCase()){case "checkbox":case "radio":this.element.checked=a.checked;break;case "select-one":this.element.selectedIndex=a.sel;break;case "file":break;default:"string"===typeof a.value&&(this.element.value=a.value.replace("<\\/script>","\x3c/script>"))}};
GLANCE.Lib.MessageHandlers=function(){this.handlers={}};GLANCE.Lib.MessageHandlers.prototype.addHandler=function(a,b){this.handlers["^"+a+"$"]=b};GLANCE.Lib.MessageHandlers.prototype.dispatch=function(a){var b=this,c=a.messageName;delete a.messageName;Object.keys(this.handlers).forEach(function(d){if((new RegExp(d)).test(c))b.handlers[d](c,a)})};GLANCE.Lib.EventListeners=function(){this.listeners=this._listeners={}};
GLANCE.Lib.EventListeners.prototype.merge=function(a){a=a.listeners;for(var b in a)this._listeners[b]=(this._listeners[b]||[]).concat(a[b])};GLANCE.Lib.EventListeners.prototype.add=function(a,b){this._listeners[a]=this._listeners[a]||[];this._listeners[a].push(b)};GLANCE.Lib.EventListeners.prototype.remove=function(a,b){a=this._listeners[a];void 0!==a&&(b=a.indexOf(b),0<=b&&a.splice(b,1))};GLANCE.Lib.EventListeners.prototype.removeAll=function(a){this._listeners[a]=[]};
GLANCE.Lib.EventListeners.prototype.fire=function(a,b){eventslog("fire "+a+" "+(b?JSON.stringify(b):""));var c=this._listeners[a],d=!0;if(void 0===c)return!0;for(a=0;a<c.length;a++)c[a](b)||(d=!1);return d};
GLANCE.Lib.CssRuleString=function(a){function b(g){return g.replace(/[\\]:/g,":").replace(":","\\:")}var c=new RegExp(/\[([^\[\]]*)\]/g);try{var d="",e="",f=a.cssRules||a.rules;for(a=0;a<f.length;a++)e=f[a].cssText,e=e.replace(c,b),d+=e+" ";return d}catch(g){return GLANCE.Lib.log("Exception getting csstext for stylesheet:"+g.toString()),""}};
GLANCE.Lib.DomDiff=function(){this.differences=[];this.htmlfilter=function(){return!0};this.renderedhtmlfilter=function(a){return a};this.attrfilter=function(a,b){return a.getAttribute(b)};this.contentfilter=function(){return!0};this.nogids=[]};GLANCE.Lib.DomDiff.prototype.setNoGids=function(a){this.nogids=a};
GLANCE.Lib.DomDiff.prototype.removeGIDs=function(a){delete a.gid;if(1===a.nodeType&&(a.removeAttribute(GLANCE.Lib.Const.GID),a.removeAttribute(GLANCE.Lib.Const.SDID),a.removeAttribute(GLANCE.Lib.Const.GCID),GLANCE.Lib.GElement.nativeGetProperty("children",a))){for(var b=0;b<GLANCE.Lib.GElement.nativeGetProperty("children",a).length;b++)this.removeGIDs(GLANCE.Lib.GElement.nativeGetProperty("children",a)[b]);if(GLANCE.Lib.toElem(a).hasNativeShadowRoot())for(a=GLANCE.Lib.GElement.nativeGetProperty("children",
a.shadowRoot),b=0;b<a.length;b++)this.removeGIDs(a[b])}};
GLANCE.Lib.DomDiff.prototype._assignGIDs=function(a,b){b=b||"";if(1===a.nodeType){if(this.gidless)for(var c=0;c<this.gidless.length;c++)if(a==this.gidless[c]||GLANCE.Lib.toElem(a).isDescendantOf(this.gidless[c])){this.removeGIDs(a);return}a.gid||(c=b?[b,GLANCE.Lib.nextGID].join("-"):GLANCE.Lib.nextGID,a.gid=c,a.setAttribute(GLANCE.Lib.Const.GID,c),"CANVAS"===a.tagName&&a.setAttribute(GLANCE.Lib.Const.GCID,c),GLANCE.Lib.toElem(a).hasNativeShadowRoot()&&a.setAttribute(GLANCE.Lib.Const.SDID,c),GLANCE.Lib.nextGID++);
c=GLANCE.Lib.GElement.nativeGetProperty("children",a);!c&&GLANCE.Lib.Browser.ie11&&(c=GLANCE.Lib.GElement.nativeGetProperty("childNodes",a));if(c)for(var d=0;d<c.length;d++)this._assignGIDs(c[d],b);if(GLANCE.Lib.toElem(a).hasNativeShadowRoot())for(c=GLANCE.Lib.getChildrenOrShadowChildren(a),d=0;d<c.length;d++)this._assignGIDs(c[d],a.gid)}};
GLANCE.Lib.DomDiff.prototype.assignGIDs=function(a,b){diffdetlog("assignGIDs next GID:",GLANCE.Lib.nextGID,"current GID:",a.getAttribute(GLANCE.Lib.Const.GID),this.getPath(a));this.gidless=0<this.nogids.length?GLANCE.Lib.GElement.nativeMethod(document,"querySelectorAll",this.nogids.join(",")):[];this._assignGIDs(a,b);delete this.gidless};GLANCE.Lib.DomDiff.prototype.log=function(a,b){};
GLANCE.Lib.DomDiff.prototype.getPath=function(a){var b=GLANCE.Lib.toElem(a).getPath();return null===b?null:a._idchanged&&!/^(head|body)$/i.test(a.tagName)?"["+GLANCE.Lib.Const.GID+'="'+a.getAttribute(GLANCE.Lib.Const.GID)+'"]':b};GLANCE.Lib.DomDiff.prototype.diff=function(a,b){this._diff(a,b);a=this.differences;this.differences=[];return a};
GLANCE.Lib.DomDiff.prototype.createDiffForDisabledChange=function(a,b){b=this.getPath(a);this.differences.push({diff:a.disabled?"SETATTR":"REMATTR",path:b,attr:"disabled",value:""});diffslog("ATTR diff: "+GLANCE.Lib.JSONStringify(this.differences[this.differences.length-1]));return this._returnMyDiffs()};
GLANCE.Lib.DomDiff.prototype.createDiffsForStyleChange=function(a,b,c){a.getAttribute("style")===b.getAttribute("style")||a.getAttribute("glance_cobrowse_suppress")||this._addAttrDiffFromMutation(a,"style");a=GLANCE.Lib.GElement.nativeGetProperty("children",a);b=GLANCE.Lib.GElement.nativeGetProperty("children",b);for(var d=0;a&&d<a.length;d++)if(d<b.length&&a[d].getAttribute(GLANCE.Lib.Const.GID)===b[d].getAttribute(GLANCE.Lib.Const.GID))this.createDiffsForStyleChange(a[d],b[d],!0);else for(var e=
0;e<b.length;e++)if(b[e].getAttribute(GLANCE.Lib.Const.GID)===a[d].getAttribute(GLANCE.Lib.Const.GID)){this.createDiffsForStyleChange(a[d],b[e],!0);break}if(void 0===c)return this._returnMyDiffs()};GLANCE.Lib.DomDiff.prototype._diff=function(a,b){this._diffElemAttrs(a,b);if(!this._diffChildList(a,b)&&!this._diffNodeList(a,b)){a=GLANCE.Lib.GElement.nativeGetProperty("children",a);var c=GLANCE.Lib.GElement.nativeGetProperty("children",b);for(b=0;void 0!==a&&b<a.length;b++)this._diff(a[b],c[b])}};
GLANCE.Lib.DomDiff.prototype.mergeDiffs=function(a,b){var c,d;for(c=0;c<a.length;c++){var e=!1;switch(a[c].diff){case "CONTENT":for(d=0;d<b.length;d++)if(b[d].path===a[c].path&&b[d].node===a[c].node){b[d].data=a[c].data;e=!0;break}break;case "ATTR":for(d=0;d<b.length;d++)if(b[d].path===a[c].path){b[d].data=a[c].data;e=!0;break}break;case "SETATTR":case "REMATTR":for(d=0;d<b.length;d++)if(("SETATTR"===b[d].diff||"REMATTR"===b[d].diff)&&b[d].path===a[c].path&&b[d].attr===a[c].attr){b[d]=a[c];e=!0;break}break;
case "REPLACE":for(d=0;d<b.length;d++)if(b[d].path===a[c].path&&"REPLACE"===b[d].diff){b[d].data=a[c].data;e=!0;break}}e||b.push(a[c])}};
GLANCE.Lib.DomDiff.prototype._diffElemAttrs=function(a,b){var c,d=a.attributes,e=b.attributes;a.id!==b.id&&(b._idchanged=!0);for(c=0;c<d.length;c++)d.item(c).nodeName!==GLANCE.Lib.Const.GID&&b.getAttribute(d.item(c).nodeName)!=d.item(c).nodeValue&&this._addAttrDiffFromMutation(b,d.item(c).nodeName);for(c=0;c<e.length;c++)e.item(c).nodeName===GLANCE.Lib.Const.GID||a.getAttribute(e.item(c).nodeName)||this._addAttrDiffFromMutation(b,e.item(c).nodeName)};
GLANCE.Lib.DomDiff.prototype._diffNodeList=function(a,b){var c=GLANCE.Lib.GElement.nativeGetProperty("children",a);var d=GLANCE.Lib.GElement.nativeGetProperty("children",b);if(c&&d&&0===c.length&&0===d.length)return a.textContent!==b.textContent&&this._addContentDiff(b),!0;d=GLANCE.Lib.GElement.nativeGetProperty("childNodes",a);let e=GLANCE.Lib.GElement.nativeGetProperty("childNodes",b);if(d.length!==e.length)return this._addHTMLDiff(b),!0;for(var f=0;f<d.length;f++)if(a=d[f],c=e[f],a.nodeType!==
c.nodeType||a.nodeValue!==c.nodeValue)return this._addHTMLDiff(b),!0};GLANCE.Lib.DomDiff.prototype._diffChildList=function(a,b){let c=GLANCE.Lib.GElement.nativeGetProperty("children",a),d=GLANCE.Lib.GElement.nativeGetProperty("children",b);if(void 0===c||void 0===d)return void 0===c!==(void 0===d);if(c.length!=d.length)return this._addHTMLDiff(b);for(a=0;a<c.length;a++)if(c[a].tagName!==d[a].tagName)return this._addHTMLDiff(b);return!1};
GLANCE.Lib.DomDiff.prototype._addAttrDiff=function(a){var b,c={};for(b=0;b<a.attributes.length;b++)this.attrfilter(a,a.attributes[b].name)&&(c[a.attributes[b].name]=a.attributes[b].value);diffslog("ATTR diff: "+this.getPath(a)+" "+GLANCE.Lib.JSONStringify(c),a);this.differences.push({diff:"ATTR",path:this.getPath(a),data:c})};
GLANCE.Lib.DomDiff.prototype.createMediaDiffs=function(){if(void 0!==window.matchMedia)for(var a=GLANCE.Lib.GElement.nativeMethod(document.head,"getElementsByTagName","link"),b=0;b<a.length;b++)this.differences.push({diff:"SETATTR",path:this.getPath(a[b]),attr:"media",value:""===a[b].media||window.matchMedia(a[b].media).matches?"all":"none"});return this._returnMyDiffs()};GLANCE.Lib.DomDiff.prototype.createHTMLAttrDiff=function(){this._addAttrDiff(document.documentElement);return this._returnMyDiffs()};
GLANCE.Lib.DomDiff.prototype._addAttrDiffFromMutation=function(a,b){var c=this.getPath(a);if(null===c)diffslog("Ignoring attr diff for ",b,"=",a.getAttribute(b)+" of elem ",a," not in DOM");else{var d=this.attrfilter(a,b);!1===d?diffslog("Ignoring attr diff for ",b,"=",a.getAttribute(b)+" of elem ",a," filtered out"):(this.differences.push({diff:d||""===d?"SETATTR":"REMATTR",path:c,attr:b,value:d}),diffslog("ATTR diff: "+c+" "+b+" "+d,a))}};
GLANCE.Lib.DomDiff.prototype.addContentDiff=function(a,b){var c=this.getPath(a);null!==c&&(this.differences.push({diff:"CONTENT",path:c,data:b}),diffslog("CONTENT diff: "+c,a))};GLANCE.Lib.DomDiff.prototype._addContentDiff=function(a){this.contentfilter(a)&&(diffslog("CONTENT diff: "+this.getPath(a)),this.addContentDiff(a,a.textContent))};
GLANCE.Lib.getChildNodesOrShadowChildNodes=function(a){return GLANCE.Lib.toElem(a).hasNativeShadowRoot()?GLANCE.Lib.GElement.nativeGetProperty("childNodes",GLANCE.Lib.GElement.nativeGetProperty("shadowRoot",a)):GLANCE.Lib.GElement.nativeGetProperty("childNodes",a)};
GLANCE.Lib.getChildrenOrShadowChildren=function(a){return GLANCE.Lib.toElem(a).hasNativeShadowRoot()?GLANCE.Lib.GElement.nativeGetProperty("children",GLANCE.Lib.GElement.nativeGetProperty("shadowRoot",a)):GLANCE.Lib.GElement.nativeGetProperty("children",a)};
GLANCE.Lib.DomDiff.prototype._addContentDiffFromMutation=function(a){var b,c=a.parentNode;for(b=0;b<GLANCE.Lib.GElement.nativeGetProperty("childNodes",c).length;b++)if(GLANCE.Lib.GElement.nativeGetProperty("childNodes",c)[b]===a){var d=b;break}void 0===d?GLANCE.Lib.log("Node not found in _addContentDiffFromMutation"):this.contentfilter(c)&&(ShadowRoot&&c instanceof ShadowRoot&&(c=c.host),this.differences.push({diff:"CONTENT",path:this.getPath(c),data:a.textContent,node:d}),diffslog("CONTENT diff: "+
this.getPath(c),a.textContent,d,"out of",GLANCE.Lib.GElement.nativeGetProperty("childNodes",c).length))};GLANCE.Lib.DomDiff.prototype._addHTMLDiff=function(a){diffslog("HTML diff: "+this.getPath(a));this.htmlfilter(a);this.differences.push({diff:"HTML",path:this.getPath(a),data:this.renderedhtmlfilter(a.innerHTML)});return!0};
GLANCE.Lib.DomDiff.prototype._getOuterHTML=function(a){var b=GLANCE.Lib.GElement.nativeGetProperty("outerHTML",a);b||(b=document.createElement("div"),b.appendChild(a),b=b.innerHTML);return this.renderedhtmlfilter(b)};GLANCE.Lib.DomDiff.prototype._getElemHtml=function(a){var b=GLANCE.Lib.toElem(a).deepClone();if(this.htmlfilter(a,b))return this._getOuterHTML(b);diffslog("Ignoring filtered element of type: "+a.tagName);return GLANCE.Lib.toElem(b).dummyOuterHTML()};
GLANCE.Lib.DomDiff.prototype._addChildOrderDiff=function(a){var b=this.getPath(a);if(b&&this.contentfilter(a)){diffslog("CHILDORDER diff: "+b,a);a=GLANCE.Lib.GElement.nativeGetProperty("childNodes",a);for(var c=[],d=0;d<a.length;d++)switch(a[d].nodeType){case 1:c.push({gid:a[d].getAttribute(GLANCE.Lib.Const.GID)});break;case 3:c.push({text:a[d].textContent});break;case 8:c.push({comment:a[d].data})}this.differences.push({diff:"CHILDORDER",path:b,data:c})}};
GLANCE.Lib.DomDiff.prototype._addReplaceNodeDiff=function(a){var b=this.getPath(a);if(b&&(1!==a.nodeType||!a.tagName.match(/textarea/i))){diffslog("REPLACE diff: "+b,"gid:",a.getAttribute(GLANCE.Lib.Const.GID),a);a.getAttribute(GLANCE.Lib.Const.GID)||diffslog("No gid for replace node diff on "+this.getPath(a));for(var c=GLANCE.Lib.GElement.nativeGetProperty("children",a),d=0;c&&d<c.length;d++)this.assignGIDs(c[d]);(a=this._getElemHtml(a))?(this.differences.push({diff:"REPLACE",path:b,data:a}),"html"!==
b||GLANCE.Lib.GElement.USE_CHILDORDER||this._addReplaceNodeDiff(document.head),diffdetlog(this.differences.length+" differences")):diffslog("Ingoring filtered replace diff for ",b)}};
GLANCE.Lib.DomDiff.prototype._addChildListDiff=function(a){var b=a.target,c=a._addedNodes,d=a._removedNodes,e=a.nextSibling;e&&1===e.nodeType&&(GLANCE.Lib.toElem(e).isDescendantOf(document.documentElement)&&GLANCE.Lib.GElement.nativeGetProperty("parentElement",e)===b?e.getAttribute(GLANCE.Lib.Const.GID)||diffslog("No data-gid for nextSibling. removedgid:",e.removedgid):(diffdetlog("nextSibling not in dom or in different parent, not sending:",e),e=null));diffdetlog("CHILDLIST diff for element: "+this.getPath(b),
b);var f=this.getPath(b);if(null!==f){var g={diff:"CHILDLIST",path:f,nsib:e&&c?this.getPath(e):null,added:[],removed:[]};if(c)for(f=0;f<c.length;f++)if(!(0<=a.ignoreAdded.indexOf(f))){var k=GLANCE.Lib.GElement.nativeGetProperty("parentNode",c[f]);if(k!==b)diffdetlog("==> Ignoring add element no longer in same parent. gid=",c[f].gid),k||(diffdetlog("==> Ignored add element no longer in dom, removing gid"),delete c[f].gid,1===c[f].nodeType&&c[f].removeAttribute(GLANCE.Lib.Const.GID));else{if(1===c[f].nodeType){this.assignGIDs(c[f]);
var l=this._getElemHtml(c[f]);if(!l){diffdetlog("==> Not adding filtered element:",c[f]);continue}diffdetlog("==> Added element node gid="+c[f].getAttribute(GLANCE.Lib.Const.GID)+" before "+g.nsib,c[f],"htmllength",l.length,"html:",l.substr(0,100))}else if(3===c[f].nodeType)l=this.contentfilter(b)?c[f].nodeValue:"",diffdetlog("==> added text node ","'"+l+"'");else if(8===c[f].nodeType)l=c[f].nodeValue,diffdetlog("==> added comment node ","'"+l+"'");else{diffdetlog("==> ignoring added node type ",
c[f].nodeType);continue}g.added.push({nodeType:c[f].nodeType,tagName:c[f].tagName,value:l})}}if(d)for(f=0;f<d.length;f++)if(!(0<=a.ignoreRemoved.indexOf(f))){switch(d[f].nodeType){case 1:diffdetlog("==> Removed node gid=",d[f].removedgid);l=d[f].removedgid;if(!l){diffdetlog("==> Ignoring remove Element with no gid");continue}break;case 3:diffdetlog("==> removed text node with value "+d[f].nodeValue);l=d[f].nodeValue;break;default:GLANCE.Lib.log("==> Ignoring remove node type "+d[f].nodeType)}g.removed.push({nodeType:d[f].nodeType,
value:l})}if(0===g.removed.length&&0===g.added.length)return!1;this.differences.push(g);e&&8===e.nodeType&&(diffdetlog("Found comment node as nextSibling, adding childorder diff",b),this._addChildOrderDiff(b));return!0}};
GLANCE.Lib.DomDiff.prototype._mergeMutations=function(a){function b(n){a.push({target:n,type:"replacedNode"})}function c(n){if(n instanceof HTMLHtmlElement)diffslog("No order fixing mutation needed for HTML element");else if(!n.getAttribute(GLANCE.Lib.Const.GID)||!GLANCE.Lib.GElement.USE_CHILDORDER&&GLANCE.Lib.toElem(n).hasGIDlessDescendants())b(n);else a:{for(var m=0;m<q.length;m++)if(q[m].target===n)break a;q.push({target:n,type:"childOrder"})}}function d(n){n=GLANCE.Lib.GElement.nativeGetProperty("childNodes",
n);for(var m=1;m<n.length;m++)if(n[m].nodeType===n[m-1].nodeType&&(3===n[m].nodeType||8===n[m].nodeType))return!0;return!1}function e(n){for(var m=0;m<a.length;m++)if(a[m]!==n&&"attributes"===n.type&&"attributes"===a[m].type&&n.target===a[m].target&&n.attributeName===a[m].attributeName)return n.target;return!1}function f(n){var m,v,x=GLANCE.Lib.toElem(n.target);for(m=0;m<a.length;m++)if(a[m]!==n&&"childList"===a[m].type)for(v=0;a[m]._addedNodes&&v<a[m]._addedNodes.length;v++)if(n.target===a[m]._addedNodes[v]||
x.isDescendantOf(a[m]._addedNodes[v]))return a[m]._addedNodes[v];return!1}function g(n){var m;for(m=0;m<a.length;m++)if(a[m]!==n&&"replacedNode"===a[m].type&&(n.target===a[m].target||GLANCE.Lib.toElem(n.target).isDescendantOf(a[m].target)))return a[m].target;return!1}var k=this,l=new GLANCE.Lib.Timer;l.set();var q=[];diffslog("Merging "+a.length+" mutations");if(500<a.length){GLANCE.Lib.log("Mutation overflow");l=!1;for(var h=0;h<a.length&&!l;h++)if(a[h].target===document.head||GLANCE.Lib.GElement.nativeGetProperty("parentElement",
a[h].target)===document.head)l=!0;a.length=0;l&&this._addReplaceNodeDiff(document.head);this._addReplaceNodeDiff(document.body)}else{a.forEach(function(n){"attributes"===n.type&&"id"===n.attributeName&&n.target.id&&(n.target._idchanged=!0);"childList"===n.type&&(n.ignoreAdded=[],n.ignoreRemoved=[])});for(h=0;h<a.length;h++){var p=f(a[h]),r=GLANCE.Lib.GElement.nativeGetProperty("parentElement",a[h].target);p?(diffdetlog("Ignoring redundant mutation "+a[h].type+" to target ",a[h].target.tagName," descendant of added node ",
p.tagName),a.splice(h,1),h--):"characterData"===a[h].type&&r&&d(r)&&(diffslog("Using child order diff instead of content diff for",this.getPath(a[h].target),"due to consecutive text elements in parent",this.getPath(r)),c(r),a.splice(h,1),h--)}a.forEach(function(n){if("childList"===n.type){var m;a:{for(m=0;m<a.length;m++)if(a[m].target===n.target&&"replacedNode"===a[m].type){m=!0;break a}m=!1}if(!m){if(0<n._addedNodes.length)for(m=0;m<a.length;m++)if("childList"===a[m].type&&a[m].target===n.target&&
0<a[m]._removedNodes.length){diffslog("Creating order-fixing mutation for "+k.getPath(n.target)+" due to adds and removes in child list");c(n.target);return}if(n.nextSibling&&3===n.nextSibling.nodeType)GLANCE.Lib.GElement.USE_CHILDORDER?(diffslog("Creating order fixing mutation for "+k.getPath(n.target)+" due to add before text node"),c(n.target)):(diffslog("Creating replaceNode mutation for "+k.getPath(n.target)+" due to add before text node"),b(n.target));else for(m=0;m<n._removedNodes.length;m++)if(3===
n._removedNodes[m].nodeType){diffslog("Creating replaceNode mutation for "+k.getPath(n.target)+" due to remove text node");b(n.target);break}}}});for(h=0;h<a.length;h++)GLANCE.Lib.toElem(a[h].target).isDescendantOf(document.documentElement)||(diffdetlog("Ignoring mutation type=",a[h].type," to target ",a[h].target," no longer in dom"),a.splice(h,1),h--);for(h=0;h<a.length;h++)if("childList"===a[h].type&&0!==a[h]._addedNodes.length)for(p=0;p<a[h]._addedNodes.length;p++){r=a[h]._addedNodes[p];for(var t=
!1,u=h+1;!t&&u<a.length;u++)if("childList"===a[u].type)for(var w=0;w<a[u]._removedNodes.length;w++)if(r===a[u]._removedNodes[w]){diffdetlog("Ignoring add and remove for same node: (",h,p,") and (",u,w,") node:",r.tagName);a[h].ignoreAdded.push(p);a[u].ignoreRemoved.push(w);t=!0;break}}Array.prototype.push.apply(a,q);for(h=0;h<a.length;h++)if(p=g(a[h]))diffdetlog("Ignoring redundant mutation "+a[h].type+" to target ",a[h].target.tagName,a[h].target.gid," descendant of replaced node ",p.tagName,p.gid),
a.splice(h,1),h--;for(h=0;h<a.length;h++)if(p=e(a[h]))diffdetlog("Ignoring redundant attribute mutation "+a[h].attributeName+" to target "+this.getPath(p)),a.splice(h,1),h--;diffslog("Merged mutations to:"+a.length+" in "+l.elapsed()+" ms")}};
GLANCE.Lib.DomDiff.prototype._addDiffsFromMutationObserver=function(a){var b=this;a.forEach(function(c){if("childList"===c.type)for(var d=0;d<c._removedNodes.length;d++)1===c._removedNodes[d].nodeType&&(c._removedNodes[d].gid&&delete c._removedNodes[d].removedgid,c._removedNodes[d].gid&&(c._removedNodes[d].removedgid=c._removedNodes[d].gid,delete c._removedNodes[d].gid,c._removedNodes[d].removeAttribute(GLANCE.Lib.Const.GID)))});this._mergeMutations(a);a.forEach(function(c){switch(c.type){case "attributes":b._addAttrDiffFromMutation(c.target,
c.attributeName);break;case "characterData":b._addContentDiffFromMutation(c.target);break;case "childList":b._addChildListDiff(c);break;case "replacedNode":b._addReplaceNodeDiff(c.target);break;case "childOrder":b._addChildOrderDiff(c.target);break;default:GLANCE.Lib.log("Unrecognized mutation record type "+c.type)}})};GLANCE.Lib.DomDiff.prototype.setHtmlFilter=function(a){this.htmlfilter=a};GLANCE.Lib.DomDiff.prototype.setRenderedHtmlFilter=function(a){this.renderedhtmlfilter=a};
GLANCE.Lib.DomDiff.prototype.setAttrFilter=function(a){this.attrfilter=a};GLANCE.Lib.DomDiff.prototype.setContentFilter=function(a){this.contentfilter=a};GLANCE.Lib.DomDiff.prototype.diffsFromMutations=function(a){if(0!==a.length)return-1!==a[0].toString().indexOf("MutationRecord")&&this._addDiffsFromMutationObserver(a),diffslog("Got "+this.differences.length+" differences"),this._returnMyDiffs()};GLANCE.Lib.DomDiff.prototype._returnMyDiffs=function(){var a=this.differences;this.differences=[];return a};
GLANCE.Lib.DomDiffApplier=function(){};GLANCE.Lib.DomDiffApplier.prototype._applyAttrDiff=function(a,b){var c=a.data,d=[];for(a=0;a<b.attributes.length;a++)d.push(b.attributes[a].name);for(a=0;a<d.length;a++)void 0===c[d[a]]&&(diffslog("   -"+d[a]),b.removeAttribute(d[a]));for(var e in c)c.hasOwnProperty(e)&&(diffslog("   +"+e+"="+c[e]),b.setAttribute(e,c[e]))};
GLANCE.Lib.DomDiffApplier.prototype._hashHrefsToAbsolute=function(a){a=(a.parentElement||document.body).querySelectorAll("svg [*|href^='#']");for(var b=window.location.href.replace(/#.*/,""),c=0;c<a.length;c++){var d=a[c].attributes.getNamedItem("href")||a[c].attributes.getNamedItem("xlink:href");if(d){var e=d.value;diffslog("Page-relative href to absolute. Element:",a[c],"namespace:",d.namespaceURI,"href:",b+e);a[c].attributes.removeNamedItem(d.name);a[c].setAttributeNS(d.namespaceURI||"http://www.w3.org/1999/xlink",
"href",b+e)}else GLANCE.Lib.log("ERR_HREFNOTFOUND")}};GLANCE.Lib.DomDiffApplier.prototype._removeObjectUrlImages=function(a){if(!GLANCE.Lib.Browser.ie){a=(a.parentElement||document.body).querySelectorAll("svg image[*|href^='blob']");for(var b=0;b<a.length;b++){var c=a[b];c.href&&c.href.baseVal&&(c.href.baseVal="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAQSURBVBhXYziMA9Be4vBhAFKrW2mB3kkXAAAAAElFTkSuQmCC")}}};
GLANCE.Lib.DomDiffApplier.prototype.processAddedElem=function(a){this._hashHrefsToAbsolute(a);null!==document.getElementById("glance-pdf")&&this._removeObjectUrlImages(a)};
GLANCE.Lib.DomDiffApplier.prototype._processAddedHeadElem=function(a){var b=GLANCE.Lib.GElement.nativeGetProperty("childNodes",document.head);for(let c=0;c<b.length;)document.head.removeChild(b[c]);b=document.implementation.createHTMLDocument("");b.head.outerHTML=a;a=document.head.getElementsByTagName("BASE");for(a=(a=a.length?a[0]:null)?a.nextSibling:null;0<b.head.childNodes.length;)document.head.insertBefore(b.head.firstChild,a)};
GLANCE.Lib.DomDiffApplier.prototype._setOuterHTML=function(a,b){b=b.replace(/<script\s/gi,"<template ").replace(/<script>/gi,"<template>").replace(/\/script>/gi,"/template>");b=b.replace(/http-equiv\s*=\s*['"]?refresh['"]?/gi,"");try{a.outerHTML=b}catch(c){GLANCE.Lib.errlog("Exception setting outer HTML:"+c.toString()+" for element:"+a.toString()+" to "+b.substr(0,200))}};
GLANCE.Lib.DomDiffApplier.prototype._applyChildOrderDiff=function(a,b,c){var d=GLANCE.Lib.GElement.nativeGetProperty("childNodes",b),e;if(/^(head|body)$/i.test(b.tagName))for(e=0;e<d.length;)1!==d[e].nodeType||d[e].getAttribute(GLANCE.Lib.Const.GID)||"BASE"===d[e].tagName||"glance_open_sel"===d[e].id?e++:(diffslog("ChildOrder: Removing gidless "+d[e].tagName+" id:"+d[e].id+" index:"+e+" in "+a),b.removeChild(d[e]));for(a=e=0;e<c.length;e++,a++)if(diffslog("ChildOrder: Entry "+e+"="+JSON.stringify(c[e])),
c[e])if(a>=d.length)diffslog("ChildOrder: Append empty text node"),b.appendChild(document.createTextNode(""));else if(1!==d[a].nodeType||d[a].getAttribute(GLANCE.Lib.Const.GID))if(void 0!==c[e].text)3!==d[a].nodeType?(diffslog("ChildOrder: Inserting text node "+JSON.stringify(c[e].text)+" at "+a),b.insertBefore(document.createTextNode(c[e].text),d[a])):d[a].textContent!==c[e].text?(diffslog("ChildOrder: Fixing up text "+JSON.stringify(c[e].text)+" in node "+a),d[a].textContent=c[e].text):diffslog("ChildOrder: Text "+
JSON.stringify(d[a].textContent)+" correct in node "+a);else if(void 0!==c[e].comment)8!==d[a].nodeType&&(diffslog("ChildOrder: Adding comment node at "+a),b.insertBefore(document.createComment(c[e].comment),d[a]));else if(1===d[a].nodeType&&d[a].getAttribute(GLANCE.Lib.Const.GID)===c[e].gid)diffslog("ChildOrder: Found "+c[e].gid+" in correct location at "+a);else{diffslog("ChildOrder: Moving "+c[e].gid+" to correct location at "+a);var f=b.querySelector("[data-gid='"+c[e].gid+"']");f?b.insertBefore(f,
d[a]):(diffslog("ChildOrder: Element missing gid:"+c[e].gid),a--)}else"BASE"!==d[a].tagName&&errorlog("ERR_MISSING_GID",b.tagName,b.id,b.className),e--;for(;a<d.length;)3===d[a].nodeType?b.removeChild(d[a]):a++};
GLANCE.Lib.DomDiffApplier.prototype.applyDiffs=function(a){var b,c=GLANCE.Lib.toElem(document.documentElement),d={};if(!a)return d;diffslog("=== Applying Diffs ===");for(b=0;b<a.length;b++){var e=c.getUniqueElement(a[b].path,!1);if(null===e)GLANCE.Lib.log("Element not found applying diff: "+a[b].diff+" to "+a[b].path);else switch(diffslog("Applying diff "+a[b].diff+" to "+e.tagName+" "+a[b].path),a[b].diff){case "ATTR":this._applyAttrDiff(a[b],e);break;case "SETATTR":diffslog("SETATTR attr on: "+
a[b].path+" attr:"+a[b].attr+" value:"+a[b].value);GLANCE.Lib.Browser.firefox&&"disabled"===a[b].attr&&e.tagName.match(/link/i)&&(e.disabled=!0);"style"===a[b].attr&&window.PrefixFree&&(a[b].value+=";"+PrefixFree.prefixCSS(a[b].value.replace(/-webkit-/,"")));"class"===a[b].attr?e.setAttribute("class",a[b].value):e.setAttribute(a[b].attr,a[b].value);"CANVAS"===e.tagName&&(d.canvas=!0);break;case "REMATTR":diffslog("REMATTR attr on: "+a[b].path+" attr:"+a[b].attr);GLANCE.Lib.Browser.firefox&&"disabled"===
a[b].attr&&e.tagName.match(/link/i)&&(e.disabled=!1);"class"===a[b].attr?e.setAttribute("class",""):e.removeAttribute(a[b].attr);break;case "CONTENT":0===a[b].node&&0===GLANCE.Lib.GElement.nativeGetProperty("childNodes",e).length&&(a[b].node=void 0);if(void 0!==a[b].node&&a[b].node>=GLANCE.Lib.GElement.nativeGetProperty("childNodes",e).length){GLANCE.Lib.log("Child node out of range applying CONTENT diff to "+a[b].path);break}void 0!==a[b].node?GLANCE.Lib.GElement.nativeGetProperty("childNodes",e)[a[b].node].textContent=
a[b].data:e.textContent=a[b].data;break;case "REPLACE":diffslog("REPLACE "+a[b].path+" with "+a[b].data.substr(0,100));if(e instanceof HTMLHtmlElement){var f=(new DOMParser).parseFromString(a[b].data,"text/html");e.querySelector("body").innerHTML=f.querySelector("body").innerHTML}else this._setOuterHTML(e,a[b].data);this.processAddedElem(e);/^(head|body|canvas)$/i.test(e.tagName)&&(d[e.tagName.toLowerCase()]=!0);0<e.getElementsByTagName("canvas").length&&(d.canvas=!0);/^head$/i.test(e.tagName)&&(f=
document.getElementsByTagName("body"),1<f.length&&0==GLANCE.Lib.GElement.nativeGetProperty("children",f[0]).length&&document.documentElement.removeChild(f[0]));/^body$/i.test(e.tagName)&&(f=document.getElementsByTagName("head"),1<f.length&&0==GLANCE.Lib.GElement.nativeGetProperty("children",f[1]).length&&document.documentElement.removeChild(f[1]));diffdetlog("==> replaced element with gid:",e.getAttribute(GLANCE.Lib.Const.GID));break;case "CHILDLIST":var g=a[b].nsib?GLANCE.Lib.toElem(e).getUniqueElement(a[b].nsib,
!1):null;for(f=0;f<a[b].added.length;f++)switch(diffslog("Adding node type: "+a[b].added[f].nodeType+" to "+GLANCE.Lib.toElem(e).getPath()),a[b].added[f].nodeType){case 1:if("HEAD"===a[b].added[f].tagName){diffdetlog("Added HEAD element");d.head=!0;this._processAddedHeadElem(a[b].added[f].value);break}var k=document.createElement("x");e.insertBefore(k,g);this._setOuterHTML(k,a[b].added[f].value);this.processAddedElem(k);diffdetlog("Added node gid:",k.getAttribute(GLANCE.Lib.Const.GID));break;case 3:k=
document.createTextNode(a[b].added[f].value);e.insertBefore(k,g);break;case 8:k=document.createComment(a[b].added[f].value);e.insertBefore(k,g);break;default:GLANCE.Lib.errlog("Unexpected node type "+a[b].added[f].nodeType+" added in applyDiffs")}for(f=0;f<a[b].removed.length;f++)switch(diffslog("Removing node type: "+a[b].removed[f].nodeType+" value "+a[b].removed[f].value),a[b].removed[f].nodeType){case 1:g=GLANCE.Lib.toElem(e).getElements("["+GLANCE.Lib.Const.GID+'="'+a[b].removed[f].value+'"]');
if(0===g.length||GLANCE.Lib.GElement.nativeGetProperty("parentElement",g[0])!==e&&g[0].parentNode!==e){diffslog("Ignoring removed Element gid "+a[b].removed[f].value+" not in parent");break}e.removeChild(g[0]);break;case 3:for(g=0;g<e.childNodes.length;g++)if(3===e.childNodes[g].nodeType&&e.childNodes[g].nodeValue===a[b].removed[f].value){e.removeChild(e.childNodes[g]);break}}break;case "CHILDORDER":/^(head|body)$/i.test(e.tagName)&&(d[e.tagName.toLowerCase()]=!0);this._applyChildOrderDiff(a[b].path,
e,a[b].data);break;case "HTML":e.innerHTML=a[b].data,this.processAddedElem(e)}}return d};var _GLANCE=_GLANCE||{};_GLANCE.Config={};_GLANCE.Config.Params={};_GLANCE.Config.Params.copy=function(a,b,c){if(void 0!==a)return c=c||Object.keys(a),c.forEach(function(d){void 0!==a[d]&&(b[d]=a[d])}),b};_GLANCE.Config.Params.getDataAttrs=function(a){var b={};if(!a)return b;var c=0;for(a=a.attributes;c<a.length;c++){var d=a[c].nodeName.match(/data-(.*)/);d&&2===d.length&&(b[d[1]]=a[c].nodeValue)}return b};
_GLANCE.Config.getCobrowseConfigData=function(){var a=window.GLANCE_COBROWSE?window.GLANCE_COBROWSE:{},b=document.getElementById("cobrowsescript"),c=document.getElementById("glance-cobrowse");b=_GLANCE.Config.Params.getDataAttrs(b);c=_GLANCE.Config.Params.getDataAttrs(c);_GLANCE.Config.Params.copy(b,a);_GLANCE.Config.Params.copy(c,a);return a};var CONST={VISITORID:"visitorid",UNIQUEID:"uniqueid",GUESTTOKEN:"guesttoken",GROUPID:"groupid",SITE:"site",PRESENCESERVER:"presenceserver",WEBSERVER:"ws",DIRECT:"directserver",HTTPSPORT:"httpsport",URL:"url",BROWSER:"browser",BROWSERVER:"browserver",PLATFORM:"platform",DATA:"data",CONNECT:"connect",FUNC:"func",ARGS:"args",CREDENTIALS:"credentials",DURATION:"duration",ONSUCCESS:"onsuccess",ONFAIL:"onfail",ONDONE:"ondone",ONALWAYS:"onalways",ONAUTHFAIL:"onauthfail",SERVICE:"service",TYPE:"type",MTYPE:"mtype",
PRESENCE:"presence",REMOTEINVOKE:"remote",TIMEOUT:"timeout"};GLANCE.Authorization={};goog.exportSymbol("GLANCE.Authorization",GLANCE.Authorization);GLANCE.Authorization.setToken=function(a){GLANCE.Authorization._token=a};goog.exportProperty(GLANCE.Authorization,"setToken",GLANCE.Authorization.setToken);GLANCE.Authorization.gettoken=function(){var a=_GLANCE.Config.getCobrowseConfigData();return a.authtoken?a.authtoken:GLANCE.Authorization._token||GLANCE.Authorization._ls&&GLANCE.Authorization._ls.getObj()};
GLANCE.Authorization.clearToken=function(){delete GLANCE.Authorization._token;GLANCE.Authorization._ls&&(GLANCE.Authorization._ls.del(),delete GLANCE.Authorization._ls)};goog.exportProperty(GLANCE.Authorization,"clearToken",GLANCE.Authorization.clearToken);GLANCE.Authorization.authorized=function(){return GLANCE.Authorization.gettoken()?!0:!1};goog.exportProperty(GLANCE.Authorization,"authorized",GLANCE.Authorization.authorized);
GLANCE.Authorization.authorize=async function(a){GLANCE.Authorization._ls=GLANCE.Authorization._ls||new GLANCE.Lib.lsCookie("glanceauth");if(!GLANCE.Authorization.authorized()){var b=`https://${a[CONST.WEBSERVER]||"www.glance.net"}/services/AuthorizationService.svc/rest/${a[CONST.CREDENTIALS]?"Authorize":"AuthorizeFromWebSession"}?groupid=${a[CONST.GROUPID]}&service=${a[CONST.SERVICE]}&duration=${a[CONST.DURATION]}&site=${a[CONST.SITE]||"production"}`;var c=a[CONST.CREDENTIALS]?{method:"post",mode:"cors",
body:a[CONST.CREDENTIALS]}:{method:"post",mode:"same-origin",credentials:"include"};try{var d=await GLANCE.Lib.JSONFetch(b,c)}catch(e){a[CONST.ONFAIL](e);return}GLANCE.Authorization._ls.setObj(d);GLANCE.Authorization._ls.setExp(a[CONST.DURATION])}if(a[CONST.ONSUCCESS])a[CONST.ONSUCCESS]()};goog.exportProperty(GLANCE.Authorization,"authorize",GLANCE.Authorization.authorize);var GLANCE_COBROWSE=window.GLANCE_COBROWSE;function PresenceBase(){}
PresenceBase.prototype._init=function(a){this._usesockjs="undefined"===typeof WebSocket;this._params={};this._params[CONST.WEBSERVER]="www.glance.net";this._params[CONST.SITE]="production";this._page=new GLANCE.Lib.Page(window);GLANCE.Lib.Params.copy(_GLANCE.Config.getCobrowseConfigData(),this._params);GLANCE.Lib.Params.copy(a,this._params);delete this._params[CONST.PRESENCESERVER];this._messagequeue=[];this._connstate=PresenceBase.CONNSTATE.NOTCONNECTED;this.ls=new GLANCE.Lib.lsCookie("glance_presence");
var b=this.ls.getObj();b&&(0===[CONST.VISITORID,CONST.WEBSERVER,CONST.GROUPID].filter(c=>b[c]!==this._params[c]).length?this._directserver=b[CONST.DIRECT]:preslog("Ignoring glance_presence entry for different visitor",b[CONST.GROUPID],b[CONST.VISITORID]));preslog("direct server from local storage:",this._directserver)};PresenceBase.CONNSTATE={NOTCONNECTED:1,CONNECTING:2,CONNECTED:3};PresenceBase.prototype._cacheDirectServer=function(){};
PresenceBase.prototype._makeurl=function(a,b,c,d){if(a&&!this._directserver)GCommon.Log.log("ERR_NODIRECTSERVER");else{var e=(d||"https")+"://"+(a?this._directserver:this._params[CONST.PRESENCESERVER])+"/"+b,f=this;c&&(e+="?",[CONST.GROUPID,CONST.VISITORID].forEach(function(g){e+=g+"="+f._params[g]+"&"}),e+=`&ver=${GCommon.Defs.Version}`);return e}};PresenceBase.prototype._findvisitor=function(a){this._ajaxrequest(!1,"findvisitor","GET",a)};
PresenceBase.prototype._openwebsocket=function(){GCommon.Log.log("connecting to "+this._directserver);var a=this,b=!1;this._usesockjs&&!window.SockJS?this._page.addScript([["src","//www.glancecdn.net/cobrowse/js/sockjs1.0.2.min.js"]],function(){b||(preslog("sockjs script added"),b=!0,window.SockJS?a._openwebsocket():GCommon.Log.log("ERR_NOSOCKJS"))}):(this._sock&&this._sock.close(),this._sock=this._createwebsocket(),this._sock.server=this._directserver,this._sock.onopen=function(){preslog("sock onopen, sending connect");
a._sock.sendobj({type:CONST.CONNECT,authorization:a._authorizer&&a._authorizer.gettoken(),groupid:a._params[CONST.GROUPID],visitorid:a._params[CONST.VISITORID],guesttoken:a._params[CONST.GUESTTOKEN],version:GCommon.Defs.Version});preslog("sending message queue");a._messagequeue.forEach(function(c){a._sock.sendobj(c)});a._messagequeue=[];a._connstate=PresenceBase.CONNSTATE.CONNECTED},this._sock.onreceiveobj=function(c){GCommon.Log.log("received:"+GLANCE.Lib.JSONStringify(c));if(a._sock){var d=c[CONST.MTYPE]||
c[CONST.TYPE],e=c.data;switch(d){case "connected":if(a._params.nokeepalive)break;preslog("Keepalive interval: "+c.keepalive);a._keepalivetimer||(a._keepalivetimer=window.setInterval(function(){a._sock.sendobj({type:"k"})},1E3*c.keepalive));break;case "invoke":"visitor"===a._type&&GLANCE.Lib.invokeFunction(e);break;case "redirect":case "serverclose":e||(e=c);default:if(a["on"+d])a["on"+d](e)}}else preslog("Ignoring message received after socket close")},this._sock.onclose=function(c){a._sock===this&&
(GCommon.Log.log(`presence connection closed ${this.getcode(c)} ${this.getreason(c)}`),a._socketclosed(),a._delayedconnect())},this._sock.onerror=function(c){a._sock===this&&(preslog("socket error"),a._usesockjs=!0,a._sock.onclose(c))})};PresenceBase.prototype._authorizer=void 0;
PresenceBase.prototype._ajaxrequest=function(a,b,c,d){function e(l){var q=l&&(l[CONST.DIRECT]||l.direct);!a&&q&&(g._directserver=q,l[CONST.HTTPSPORT]&&(g._directserver+=":"+l[CONST.HTTPSPORT]),g._cacheDirectServer());g._sock&&g._directserver!=g._sock.server&&(preslog("switching connection from "+g._sock.server+" to "+g._directserver),g._openwebsocket());if(d&&d[CONST.ONSUCCESS])d[CONST.ONSUCCESS](l)}function f(l,q,h){GCommon.Log.log(`Presence request: ${b} failed reason: ${q} http status: ${h||0}`);
503===h&&(GCommon.Log.error("Presence service unavailable"),g._serviceunavailable=!0,q="serviceunavailable");if(d[CONST.ONFAIL])d[CONST.ONFAIL](q);else g._fireerror({error:"connfail",detail:q})}if(!this._serviceunavailable){var g=this,k=new GLANCE.Lib.Request("JSON");k.setAuthorizer(this._authorizer);k.method=c;GCommon.Log.log(b,JSON.stringify(d));(function(l){if(g._params[CONST.PRESENCESERVER])return l();var q=new GLANCE.Lib.lsCookie("glance_visitor_settings_"+g._params[CONST.GROUPID]+"_"+g._params[CONST.SITE]),
h=q.getObj();if(h)return g._params[CONST.PRESENCESERVER]=h[CONST.PRESENCESERVER],g._params[CONST.PRESENCESERVER]||GCommon.Log.log("PRES_DISABLED (from cache)"),l();h=new GLANCE.Lib.Request("JSON");var p="https://"+g._params[CONST.WEBSERVER]+"/services/authorizationservice/GetVisitorSettings3?groupid="+g._params[CONST.GROUPID]+"&site="+g._params[CONST.SITE]+"&service=presence";h.method="GET";h.post(p,null,!0,!1,function(r){g._params[CONST.PRESENCESERVER]=r.presenceUrl;preslog("presence service: "+
g._params[CONST.PRESENCESERVER]);g._params[CONST.PRESENCESERVER]||GCommon.Log.log("PRES_DISABLED");var t={};t[CONST.PRESENCESERVER]=g._params[CONST.PRESENCESERVER];t.presencesettings=r;q.setObj(t);q.setExp(1440);return l()},function(r,t){GCommon.Log.log("PRES_UNAVAILABLE "+t);l()})})(function(){g._params[CONST.PRESENCESERVER]&&k.post(g._makeurl(a,b,!0),d[CONST.DATA]?d[CONST.DATA]:{},!0,!1,e,f)})}};
PresenceBase.prototype._closewebsocket=function(){preslog("closewebsocket");this._sock&&this._sock.close();this._socketclosed()};PresenceBase.prototype._socketclosed=function(){this._keepalivetimer&&(window.clearInterval(this._keepalivetimer),delete this._keepalivetimer);this._connstate=PresenceBase.CONNSTATE.NOTCONNECTED;delete this._sock;delete this._directserver};
PresenceBase.prototype._sendmsg=function(a){GCommon.Log.log("sending",a[CONST.TYPE],this._connstate);this._connstate===PresenceBase.CONNSTATE.CONNECTED?(preslog("sending message: "+JSON.stringify(a)),this._sock.sendobj(a)):(preslog("queuing message: "+JSON.stringify(a)),this._messagequeue.push(a),this.connect())};
PresenceBase.prototype.setVisitorId=function(a){let b=this._connstate===PresenceBase.CONNSTATE.CONNECTED;b&&this.disconnect();this._params[CONST.VISITORID]=a;(b||"api"!==this._params.presence)&&this.connect()};goog.exportProperty(PresenceBase.prototype,"setVisitorId",PresenceBase.prototype.setVisitorId);
PresenceBase.prototype.connect=function(){if(!this._serviceunavailable)if(this._params[CONST.VISITORID])if(this._connstate!==PresenceBase.CONNSTATE.NOTCONNECTED)preslog("connect() called when already connecting or connected");else{this._connstate=PresenceBase.CONNSTATE.CONNECTING;preslog("connect");var a=this;this.onscaledown=function(){a.disconnect();a.connect()};this.onredirect=function(b){preslog("Connected to wrong instance:",JSON.stringify(b),"current direct server:",this._directserver);this.ls&&
b.direct!==this._directserver&&(this.ls.del(),this.ls=new GLANCE.Lib.lsCookie("glance_presence"),this.disconnect(),this._delayedconnect())};this.onserverclose=function(b){a.disconnect();if(a.onclose)a.onclose()};this._directserver?this._openwebsocket():this._findvisitor({onsuccess:function(){GCommon.Log.log("found visitor, connect");a._openwebsocket()},onfail:function(b){a._connstate=PresenceBase.CONNSTATE.NOTCONNECTED;a._fireerror({error:"connfail",detail:b})}})}else GCommon.Log.log("CONN_NOVISITORID")};
goog.exportProperty(PresenceBase.prototype,"connect",PresenceBase.prototype.connect);PresenceBase.prototype.disconnect=function(){this._closewebsocket()};goog.exportProperty(PresenceBase.prototype,"disconnect",PresenceBase.prototype.disconnect);
PresenceBase.prototype._delayedconnect=function(){preslog(`delayed reconnect.  count: ${this._reconnectcount||0} connstate: ${this._connstate}`);this._connecttimer||(this._reconnectcount=this._reconnectcount||0,this._reconnectcount++,this._connecttimer=window.setTimeout(()=>{delete this._connecttimer;this.connect()},3>=this._reconnectcount?5E3:6E4))};PresenceBase.prototype.isconnected=function(){return this._connstate===PresenceBase.CONNSTATE.CONNECTED};
PresenceBase.prototype._fireerror=function(a){GCommon.Log.log("Error: ",JSON.stringify(a));this._onerror&&this._onerror(a);if(this.onerror)this.onerror(a)};PresenceBase.prototype.fire=function(a,b){this._sendmsg({type:a,data:b})};goog.exportProperty(PresenceBase.prototype,"fire",PresenceBase.prototype.fire);GLANCE.Presence=GLANCE.Presence||{};GLANCE.Presence.Agent=function(a){a.uniqueid&&(a.visitorid="UNQ-"+a.uniqueid);this._init(a);this._type="agent"};goog.exportSymbol("GLANCE.Presence.Agent",GLANCE.Presence.Agent);GLANCE.Presence.Agent.prototype=new PresenceBase;GLANCE.Presence.Agent.prototype._authorizer=GLANCE.Authorization;GLANCE.Presence.Agent.prototype._createwebsocket=function(){return GLANCE.Lib.GWebSocket(this._makeurl(!0,this._type,!1,"wss"))};
GLANCE.Presence.Agent.prototype._send=function(a,b,c,d){d=d||function(f){GLANCE.Lib.log("Unhandled error:"+JSON.stringify(f))};var e=this;this._findvisitor({onsuccess:function(f){f.visitorfound?e._ajaxrequest(!0,"signalvisitor","POST",{data:{mtype:a,data:b},onsuccess:c,onfail:d}):(GLANCE.Lib.log("ERR_VISITORNOTPRESENT"),d("visitornotpresent"))},onfail:d})};GLANCE.Presence.Agent.prototype.signalVisitor=function(a){this._send("signal",a[CONST.DATA],a[CONST.ONSUCCESS],a[CONST.ONFAIL])};
goog.exportProperty(GLANCE.Presence.Agent.prototype,"signalVisitor",GLANCE.Presence.Agent.prototype.signalVisitor);GLANCE.Presence.Agent.prototype.invokeVisitor=function(a){var b={};GLANCE.Lib.Params.copy(a,b,[CONST.FUNC,CONST.ARGS]);this._send("invoke",b,a[CONST.ONSUCCESS],a[CONST.ONFAIL])};goog.exportProperty(GLANCE.Presence.Agent.prototype,"invokeVisitor",GLANCE.Presence.Agent.prototype.invokeVisitor);
GLANCE.Presence.Agent.prototype.lookupVisitor=function(a){const b=a[CONST.ONSUCCESS];a[CONST.ONSUCCESS]=function(c){Object.keys(c).forEach(function(d){if("string"===typeof c[d]&&0===c[d].indexOf("{'"))try{preslog("Converting python object to json:",c[d]),c[d]=JSON.parse(c[d].replace(/'/g,'"'))}catch(e){GLANCE.Lib.log("Could not convert "+c[d]+" to json")}});b(c)};this._ajaxrequest(!1,"lookupvisitor","GET",a)};goog.exportProperty(GLANCE.Presence.Agent.prototype,"lookupVisitor",GLANCE.Presence.Agent.prototype.lookupVisitor);
GLANCE.Presence.Agent.prototype.query=function(a){this._ajaxrequest(!1,"query","GET",a)};goog.exportProperty(GLANCE.Presence.Agent.prototype,"query",GLANCE.Presence.Agent.prototype.query);
