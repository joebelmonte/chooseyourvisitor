(function() {var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,f,g){if(b==Array.prototype||b==Object.prototype)return b;b[f]=g.value;return b};
$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<b.length;++f){var g=b[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,f){var g=$jscomp.propertyToPolyfillSymbol[f];if(null==g)return b[f];g=b[g];return void 0!==g?g:b[f]};$jscomp.polyfill=function(b,f,g,p){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,f,g,p):$jscomp.polyfillUnisolated(b,f,g,p))};
$jscomp.polyfillUnisolated=function(b,f,g,p){g=$jscomp.global;b=b.split(".");for(p=0;p<b.length-1;p++){var v=b[p];if(!(v in g))return;g=g[v]}b=b[b.length-1];p=g[b];f=f(p);f!=p&&null!=f&&$jscomp.defineProperty(g,b,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(b,f,g,p){var v=b.split(".");b=1===v.length;p=v[0];p=!b&&p in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<v.length-1;h++){var B=v[h];if(!(B in p))return;p=p[B]}v=v[v.length-1];g=$jscomp.IS_SYMBOL_NATIVE&&"es6"===g?p[v]:null;f=f(g);null!=f&&(b?$jscomp.defineProperty($jscomp.polyfills,v,{configurable:!0,writable:!0,value:f}):f!==g&&(void 0===$jscomp.propertyToPolyfillSymbol[v]&&(g=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[v]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(v):$jscomp.POLYFILL_PREFIX+g+"$"+v),$jscomp.defineProperty(p,$jscomp.propertyToPolyfillSymbol[v],{configurable:!0,writable:!0,value:f})))};
$jscomp.polyfill("String.prototype.replaceAll",function(b){return b?b:function(f,g){if(f instanceof RegExp&&!f.global)throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument.");return f instanceof RegExp?this.replace(f,g):this.replace(new RegExp(String(f).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08"),"g"),g)}},"es_2021","es3");
class CustomSelect extends HTMLElement{connectedCallback(){this.innerHTML='<ul class="glance_select-list glance_select-ul"></ul><div class="glance_select-downarrow"></div><button type="button" role="button" class="glance_select-button glance_guest_controls" aria-haspopup="true" aria-expanded="false" aria-label="Select Camera to use"></button>';this.list=this.querySelector(".glance_select-list");this.downarrow=this.querySelector(".glance_select-downarrow");this.button=this.querySelector("button");
this.hideDropdown();this.button.addEventListener("click",()=>{this.toggleVisibility()});this.addEventListener("focus",()=>{this.button.focus()});document.addEventListener("click",b=>{this.visible&&!this.contains(b.target)&&this.hideDropdown()});this.list.addEventListener("focusout",b=>{this.contains(b.relatedTarget)||this.hideDropdown()})}constructor(){super()}size(){return this.list.children.length}addItem(b,f){let g=document.createElement("li");g.innerHTML=b;g.setAttribute("value",f);g.setAttribute("tabIndex",
"-1");g.addEventListener("click",()=>{this.selectItem(g);this.hideDropdown();this.dispatchEvent(new Event("selchange"))});g.addEventListener("keydown",p=>{switch(p.code){case "ArrowDown":g.nextElementSibling&&g.nextElementSibling.focus();break;case "ArrowUp":g.previousElementSibling&&g.previousElementSibling.focus();break;case "Enter":g.dispatchEvent(new Event("click"));break;case "Escape":this.hideDropdown();this.button.focus();break;default:return}p.preventDefault();p.stopPropagation()});this.list.appendChild(g)}selectItem(b){this.selectedElem&&
this.selectedElem.classList.remove("glance_select-selected");this.selectedElem="number"===typeof b?this.list.children[b]:b;this.selectedElem.classList.add("glance_select-selected");this.selectedElem.focus()}selectValue(b){this.list.querySelectorAll("li").forEach(f=>{f.getAttribute("value")===b&&(this.selectedElem&&this.selectedElem.classList.remove("glance_select-selected"),this.selectedElem=f,this.selectedElem.classList.add("glance_select-selected"),this.selectedElem.focus())})}hasValue(b){let f=
!1;this.list.querySelectorAll("li").forEach(g=>{g.getAttribute("value")===b&&(f=!0)});return f}getSelectedValue(){return this.selectedElem?this.selectedElem.getAttribute("value"):""}toggleVisibility(){this.visible?this.hideDropdown():this.showDropdown()}showDropdown(){this.visible=!0;for(let b of[this.list,this.downarrow])b.style.visibility="visible";this.querySelector(".glance_select-selected").focus();this.classList.remove("glance_tooltip")}hideDropdown(){this.visible=!1;for(let b of[this.list,
this.downarrow])b.style.visibility="hidden";this.hasAttribute("data-title")&&this.classList.add("glance_tooltip")}}customElements.get("glance-custom-select")||window.customElements.define("glance-custom-select",CustomSelect);/*
 Copyright 2022 Glance Networks, Inc.
*/
var GLANCE_LOGGER=!0,GlanceLogger={sanitize:function(b){return b.replace(/[\r\n]/g," ").replace("<","&lt;")},_log:function(b,...f){!window.console||!window.console[b]||window.GLANCE_COBROWSE&&window.GLANCE_COBROWSE.disableLogging||(f=f.map(g=>{if("object"===typeof g)try{g=JSON.stringify(g)}catch(p){console.error(p),g="unable to convert object to string"}return"string"===typeof g?GlanceLogger.sanitize(g):g}),window.console[b](...f))},log:function(...b){GlanceLogger._log("log",...b)},error:function(...b){GlanceLogger._log("error",
...b)}},LOG_DIFFS=!1,LOG_DIFFDET=!1,LOG_DRAW=!1,LOG_PRES=!0,LOG_CBSTATE=!1,LOG_IFRAME=!1,LOG_SCROLL=!1,LOG_EVENTS=!1,LOG_LOADER=!1,LOG_UI=!1,LOG_FOCUS=!1,LOG_XDOM=!0,LOG_C3P=!1,LOG_PDF=!1,LOG_STYLES=!1,LOG_GEST=!1,LOG_MSG=!1,LOG_RES=!0,LOG_RC=!1,LOG_SD=!1,LOG_VID=!0,LOG_MASK=!1,LOG_DOC=!1,LOG_XLS=!1,LOG_SS=!1,debuglog=GLANCE_LOGGER?function(...b){GlanceLogger.log("DEBUG:",...b)}:function(){},diffslog=GLANCE_LOGGER&&LOG_DIFFS?function(...b){GlanceLogger.log("DIFFS:",...b)}:function(){},diffdetlog=
GLANCE_LOGGER&&LOG_DIFFDET?function(...b){GlanceLogger.log("DIFFDET:",...b)}:function(){},drawlog=GLANCE_LOGGER&&LOG_DRAW?function(...b){GlanceLogger.log("DRAW:",...b)}:function(){},preslog=LOG_PRES?function(...b){GlanceLogger.log("PRES:",...b)}:function(){},cbstatelog=GLANCE_LOGGER&&LOG_CBSTATE?function(...b){GlanceLogger.log("CBSTATE:",...b)}:function(){},iframelog=GLANCE_LOGGER&&LOG_IFRAME?function(...b){GlanceLogger.log("IFRAME:",...b)}:function(){},scrolllog=GLANCE_LOGGER&&LOG_SCROLL?function(...b){GlanceLogger.log("SCROLL:",
...b)}:function(){},eventslog=GLANCE_LOGGER&&LOG_EVENTS?function(...b){GlanceLogger.log("EVENTS:",...b)}:function(){},loaderlog=GLANCE_LOGGER&&LOG_LOADER?function(...b){GlanceLogger.log("LOADER:",...b)}:function(){},uilog=GLANCE_LOGGER&&LOG_UI?function(...b){GlanceLogger.log("UI:",...b)}:function(){},focuslog=GLANCE_LOGGER&&LOG_FOCUS?function(...b){GlanceLogger.log("FOCUS:",...b)}:function(){},xdomlog=LOG_XDOM?function(...b){GlanceLogger.log("XDOM:",...b)}:function(){},c3plog=GLANCE_LOGGER&&LOG_C3P?
function(...b){GlanceLogger.log("C3P:",...b)}:function(){},pdflog=GLANCE_LOGGER&&LOG_PDF?function(...b){GlanceLogger.log("PDF:",...b)}:function(){},stylelog=GLANCE_LOGGER&&LOG_STYLES?function(...b){GlanceLogger.log("STYLES:",...b)}:function(){},gestlog=GLANCE_LOGGER&&LOG_GEST?function(...b){GlanceLogger.log("GEST:",...b)}:function(){},msglog=GLANCE_LOGGER&&LOG_MSG?function(...b){GlanceLogger.log("MSG:",...b)}:function(){},reslog=GLANCE_LOGGER&&LOG_RES?function(...b){GlanceLogger.log("RES:",...b)}:
function(){},rclog=GLANCE_LOGGER&&LOG_RC?function(...b){GlanceLogger.log("RC:",...b)}:function(){},sdlog=GLANCE_LOGGER&&LOG_SD?function(...b){GlanceLogger.log("SD:",...b)}:function(){},vidlog=LOG_VID?function(...b){GlanceLogger.log("VID:",...b)}:function(){},masklog=GLANCE_LOGGER&&LOG_MASK?function(...b){GlanceLogger.log("MASK:",...b)}:function(){},doclog=GLANCE_LOGGER&&LOG_DOC?function(...b){GlanceLogger.log("DOC:",...b)}:function(){},sslog=GLANCE_LOGGER&&LOG_SS?function(...b){GlanceLogger.log("SS:",
...b)}:function(){},assert=GLANCE_LOGGER?function(b){if(!b)if(window.console&&window.console.error)GlanceLogger.error("ASSERT");else throw Error("ASSERT");}:function(){};function consolelog(...b){GlanceLogger.log("GLANCE:",...b)}function errorlog(...b){GlanceLogger.error("GLANCE:",...b)};var SSN_COOKIE_NAME="glance_ssn_info";GLANCE.MINIMIZED=!0;var GLANCEVERSION3=GLANCE.VERSION.split(".").slice(0,3).join("."),GLANCESCRIPTVERSION=GLANCEVERSION3+""+(GLANCE.MINIMIZED?"M":"");
function CBScriptTag(){this.scripttag=document.getElementById("cobrowsescript")||document.getElementById("glance-cobrowse");this.metatag=document.getElementById("glance-cobrowse");if(null!==this.scripttag){var b=_GLANCE.Config.getCobrowseConfigData();_GLANCE.Config.Params.copy(b,this);var f=RegExp("//(.*)/").exec("string"===typeof this.scripttag.src?this.scripttag.src:b.scriptserver+"/");this.scriptServer=f&&2===f.length?f[1]:"www.glancecdn.net/cobrowse";this.scriptServer=this.scriptServer.replace("/js",
"");this.videoScriptServer=this.scriptServer.replace("cobrowse","video");b.cbexperiment&&(this.scriptServer=this.scriptServer.replace("cobrowse","cbexperiment"),this.videoScriptServer=this.videoScriptServer.replace("video","videoexperiment"));f=(b.oninit||"").split(":");this.groupid=b.groupid||this.scripttag.getAttribute("groupid");this.webServerHost=b.ws||this.scripttag.getAttribute("ws")||"www.glance.net";this.webServer=this.webServerHost+"/cobrowse";this.dev=!this.webServerHost.match("\\.glance\\.net$");
this.cookiedomain=b.cookiedomain;this.ui=b.ui;this.cookietype=b.cookietype;this.hostkey=b.hostkey;this.uri=b.uri;this.oninit={command:f[0],param:f[1]};this.site=b.site||this.scripttag.getAttribute("site")||"production";this.inputEvents=JSON.parse(b.inputevents||"{}");this.presence=b.presence;if(!this.groupid)throw Error("data-groupid missing");b=b.additionalgroupids||"";this.groupids=[this.groupid].concat(b?b.split(","):[]);this.groupids=this.groupids.map(function(g){if(!parseInt(g))throw Error("data-groupid invalid: "+
g);return parseInt(g)});if(!/staging|production/i.test(this.site))throw Error("data-site invalid");}}CBScriptTag.prototype.nativeInstance=function(b,...f){if(!this.cleanContextWindow){let g=document.createElement("iframe");g.style.display="none";g.setAttribute("data-no-cobrowse-content",1);document.body.appendChild(g);this.cleanContextWindow=g.contentWindow}b=this.cleanContextWindow[b];return new (Function.bind.apply(b,[b,...f]))};CBScriptTag.prototype.ready=function(){return null!==this.scripttag};
CBScriptTag.prototype.makeUrl=function(b){return URL.toString().includes("[native code]")?(new URL(`https://${this.scriptServer}/${b}`)).href:this.nativeInstance("URL",`https://${this.scriptServer}/${b}`).href};CBScriptTag.prototype.makeWebServiceUrl=function(b){return URL.toString().includes("[native code]")?(new URL(`https://${this.webServerHost}/${b}`)).href:this.nativeInstance("URL",`https://${this.webServerHost}/${b}`).href};
CBScriptTag.prototype.includesGroupId=function(b){b=parseInt(b);return this.groupid===b||0<=this.groupids.indexOf(b)};CBScriptTag.prototype.setCustomizationVersion=function(b){this.custver||(this.custver=b)};
CBScriptTag.prototype.coalesceSessionStartParams=function(b,f){function g(v,h,B){B.forEach(y=>{v[y]=h[y]||v[y]})}var p={};g(p,b,["video","content"]);g(p,this,["name","email","phone","video","content"]);p.sessionKey=p.sessionKey||this.visitorid||"GLANCE_KEYTYPE_RANDOM";"off"!==p.video&&!1===b.nwayvideoallowed&&(console.error("ERR_NO_NWAYVIDEO_SETTINGS"),p.video="off");Object.assign(p,f||{});return p};
CBScriptTag.prototype.addGlanceVideo=async function(){let b=f=>new Promise(g=>{if(document.querySelector(`script[src*=${f}]`))g();else{let p=document.createElement("script");p.addEventListener("load",g);p.setAttribute("type","text/javascript");p.setAttribute("src",`//${this.videoScriptServer}/source/js/${f}_${GLANCESCRIPTVERSION}.js`);document.head.appendChild(p)}});await b("browserCap");return b("GlanceVideoSource")};
CBScriptTag.prototype.addStylesheets=function(b){function f(v,h,B){if(!document.getElementById(v)){uilog("adding stylesheet",v);var y=document.createElement("link"),E=document.getElementsByTagName("head")[0];y.id=v;y.type="text/css";y.rel="stylesheet";y.media="all";y.href=h;B=B||E.firstElementChild;E.insertBefore(y,B)}}function g(v){return new Promise((h,B)=>{let y=document.getElementById(v);"1"===y.getAttribute("data-loaded")?(uilog(`stylesheet ${v} already loaded`),h()):(y.addEventListener("load",
()=>{y.setAttribute("data-loaded","1");uilog(`stylesheet ${v} loaded`);h()},{once:!0}),y.addEventListener("error",h,{once:!0}))})}this.currentGroupId||f("glance_ss",this.makeUrl("styles/Cobrowse_"+GLANCEVERSION3+".css"));if(this.currentGroupId!==b){this.currentGroupId=b;var p=document.getElementById("glance_customss");p&&p.parentElement.removeChild(p);f("glance_customss",this.makeUrl("customstyles/CustomSkin_"+b+"_"+this.site.substr(0,1).toUpperCase()+".css?gv=4&v="+this.custver),document.getElementById("glance_ss").nextElementSibling)}return Promise.all([g("glance_ss"),
g("glance_customss")]).then(()=>{uilog("all stylesheets loaded")})};function CookieUtils(){}CookieUtils.makeCookie=function(b){var f=SSN_COOKIE_NAME;switch(b.cookietype){case "ls":var g=GLANCE.Lib.lsCookie;break;case "dual":g=GLANCE.Lib.DualCookie;break;default:g=GLANCE.Lib.Cookie}return new g(f,b.cookiedomain)};CookieUtils.dropCookie=function(b,f){CookieUtils.makeCookie(b).setObj(f,"secure"===b.cookietype)};
var fixButtons=function(b){if(0>=Math.floor(b.scrollLeft)){var f="left";document.getElementById("glance_scroll-left").disabled=!0;document.getElementById("glance_scroll-right").disabled=!1}else 7>b.scrollWidth-b.scrollLeft-b.offsetWidth?(f="right",document.getElementById("glance_scroll-right").disabled=!0):(f="both",document.getElementById("glance_scroll-right").disabled=!1),document.getElementById("glance_scroll-left").disabled=!1;b.setAttribute("data-smallvideoscroll",f)};
class CobrowseVideoUtils{static getViewerId(b,f){return"original"!==(f||"original")?`glance_video_${b}`:"glance_agentvideo"}static validFile(b){return["application/pdf","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(b.type)||b.name.match(".csv")}static validSize(b){return 5>b.size/1048576}static scrollVideoStrip(b){var f=document.querySelector("#glance_video_containers");if(f)return f.scrollLeft=b?f.scrollLeft+191:f.scrollLeft-191,fixButtons(f),
f.scrollLeft}static setVideoScrollOffset(b){var f=document.querySelector("#glance_video_containers");if(f)return f.scrollLeft=b,fixButtons(f),f.scrollLeft}};var _GLANCE=_GLANCE||{};_GLANCE.Config={};_GLANCE.Config.Params={};_GLANCE.Config.Params.copy=function(b,f,g){if(void 0!==b)return g=g||Object.keys(b),g.forEach(function(p){void 0!==b[p]&&(f[p]=b[p])}),f};_GLANCE.Config.Params.getDataAttrs=function(b){var f={};if(!b)return f;var g=0;for(b=b.attributes;g<b.length;g++){var p=b[g].nodeName.match(/data-(.*)/);p&&2===p.length&&(f[p[1]]=b[g].nodeValue)}return f};
_GLANCE.Config.getCobrowseConfigData=function(){var b=window.GLANCE_COBROWSE?window.GLANCE_COBROWSE:{},f=document.getElementById("cobrowsescript"),g=document.getElementById("glance-cobrowse");f=_GLANCE.Config.Params.getDataAttrs(f);g=_GLANCE.Config.Params.getDataAttrs(g);_GLANCE.Config.Params.copy(f,b);_GLANCE.Config.Params.copy(g,b);return b};(function(){function b(a,c,e){let d=document.documentElement.getAttribute("lang"),l=d?[d,...c]:c;for(var m=0;m<l.length;m++)if(a.includes(l[m]))return l[m];for(m=0;m<l.length;m++)if(c=a.filter(u=>u.substr(0,2).toLowerCase()===l[m].substr(0,2).toLowerCase()),0<c.length)return c[0];return e}function f(){uilog("getVisitorUISettings");return I(A.makeWebServiceUrl(`api/CobrowseSettings/VisitorUISettings?groupid=${A.groupid}&site=${A.site}&ver=${GLANCE.VERSION}`)).then(a=>{if(!a.ok)throw Error(`ERR_SETTINGS: ${a.status} ${a.statusText}`);
uilog("got Visitor UI Settings");return a.json()})}function g(a){uilog("getButtonHTML");return I(A.makeUrl(`html/visitor-${a.widgetstyle}-${GLANCEVERSION3}.html`)).then(c=>{if(!c.ok)throw Error(`ERR_HTML: ${c.status} ${c.statusText}`);uilog("got Button HTML");return c.text()})}async function p(a){uilog("getButtonText accept languages:",a.acceptlanguages);var c=b(a.languages,a.acceptlanguages,a.defaultlanguage);let e=A.makeUrl(`text/${a.settingsparentgroupid}/VisitorText_${a.settingsparentgroupid}_${c}_${A.site.toUpperCase().charAt(0)}.json?v=${a.custver}`);
a=a.customizedlanguages.includes(c)?I(e).then(d=>d.ok?d.json():{}):Promise.resolve({});c=A.makeUrl(`text/VisitorText_${c}_${GLANCEVERSION3}.json`);c=I(c).then(d=>d.ok?d.json():{});c=await Promise.all([a,c]);return Object.assign({},c[1],c[0])}function v(a,c){GLANCE.Presence&&GLANCE.Presence.Visitor&&GLANCE.Presence.Visitor.instance&&GLANCE.Presence.Visitor.instance.fire(a,c)}function h(a){function c(l){this.elem=l;this.show=function(m){void 0===m&&(m=!0);var u=m?"glance_show":"glance_hide";m=new RegExp(m?
"glance_hide":"glance_show","g");l.className.match(new RegExp(u,"g"))||(l.className.match(m)?l.className=l.className.replace(m,u):this.addClass(u))};this.hide=function(){this.show(!1)};this.getElement=function(m){return(m=l.querySelectorAll(m)[0])?new c(m):null};this.setClass=function(m){l.className=m};this.addClass=function(m){m.split(" ").forEach(u=>{l.classList.add(u)})};this.removeClass=function(m){m&&m.split(" ").forEach(u=>{l.classList.remove(u)})};this.toggleClass=function(m){l.classList.toggle(m)};
this.addEvent=function(m,u,C,q){l.addEventListener(m,function(H){u(H);!1!==C&&(H.preventDefault(),H.stopPropagation())},q)};this.getAttr=function(m){return l.getAttribute(m)};this.setAttr=function(m,u){l.setAttribute(m,u)};this.removeAttrs=function(m){let u=l.attributes,C=[];for(var q=0;q<u.length;q++)u[q].name.startsWith(m)&&C.push(u[q].name);for(q=0;q<C.length;q++)l.removeAttribute(C[q])};this.text=function(m){"string"===typeof m&&(l.innerText=m);return l.innerText};this.makeDialog=function(m,u,
C,q,H=!0){function P(){u();H&&Q.previousFocus&&Q.previousFocus.focus()}var Q=this;this.trapFocus(!0);C&&q&&h(C).addEvent("click",q,!1);this.setAttr("role","alertdialog");this.setAttr("aria-modal","true");this.focuselem=window.safari||U?l.querySelectorAll("button")[0]:l;l.tabIndex=-1;this.handleKey(27,"",P);h(m).addEvent("click",P,!0)};this.showDialog=function(m,u){"undefined"===typeof m&&(m=!0);this.previousFocus=document.activeElement;m&&this.show();this.focuselem.focus();u||this.trapFocusInDialog()};
this.focus=function(){l.focus()};this.trapFocus=function(m){this.handleKey(9,m?"shift":"",function(){})};this.trapFocusInDialog=function(){var m=Array.from(l.querySelectorAll("a, input, button, select")).filter(u=>null!==u.offsetParent);1<=m.length&&((new c(m[0])).trapFocus(!0),(new c(m[m.length-1])).trapFocus(!1))};this.handleKey=function(m,u,C){this.addEvent("keydown",function(q){if(9!==m||q.target===q.currentTarget){var H=q.shiftKey||q.ctrlKey||q.altKey;q.keyCode===m&&(u&&q[u+"Key"]||!u&&!H)&&
(C(),q.preventDefault(),q.stopPropagation())}},!1)}}var e,d;return(d="string"===typeof a?a.match(/^#/)?document.getElementById(a.substr(1)):(e=document.querySelectorAll(a))?e[0]:null:a)?new c(d):null}function B(){this.confirm=h("#glance_confirm");this.scrim=h("#glance_scrim");var a=this;h("#glance_confirm_primary_button").addEvent("click",function(){a.hide();a.onPrimaryButtonClick()});this.confirm.makeDialog("#glance_confirm_secondary_button",function(){a.hide();a.onSecondaryButtonClick()})}function y(){if(this.confirm=
h("#glance_visitorvideoconfirm"))this.scrim=h("#glance_scrim"),this.videopreview=this.confirm.getElement("glance-video-preview").elem,this.confirm.getElement("#glance_vvc_accept").addEvent("click",()=>{this.onAccept(this.videopreview.getCameraSettings(),this.videopreview.shutdownPreview(!0));this.hide()}),this.confirm.makeDialog("#glance_vvc_decline",()=>{this.onDecline(this.videopreview.getCameraSettings());this.hide()}),this.shown=!1}function E(){this.name="glance_screenshare";this.view=h("#glance_ssview");
this.scrim=h("#glance_scrim")}function R(){this.scrim=h("#glance_scrim");this.terms=h("#glance_terms");this.terms.getElement("glance-video-preview")&&(this.videopreview=this.terms.getElement("glance-video-preview").elem);this.terms.makeDialog("#glance_decline",()=>{this.show(!1);v("terms",{status:"declined"})});this.terms.getElement("#glance_accept").addEvent("click",a=>{a.preventDefault();v("terms",{status:"accepted"});this.startparams.video&&this.showvideopreview&&(Object.assign(this.startparams,
this.videopreview.getCameraSettings()),this.startparams.videopaused?k.visitorVideoPaused(!0):this.startparams.glanceVideo=this.videopreview.shutdownPreview(!0));GLANCE.Cobrowse.Visitor.startSession(this.startparams);this.show(!1)});this.terms.getElement("#glance_terms_link").addEvent("click",()=>{var a=this.terms.getElement("#glance_terms .data");a=getComputedStyle(a.elem,":before").getPropertyValue("content");a="none"===a?null:a.replace(/['"]/g,"");window.open(A.termsurl||a||"https://"+A.webServer+
"/terms/?groupid="+A.currentGroupId,"_blank","width=800,height=800,top=10,left=10,scrollbars=1")})}function V(a){return new Promise((c,e)=>{e=new FileReader;e.onload=d=>{c(d.target.result)};e.readAsBinaryString(a)})}function S(a,c){V(a).then(e=>{var d=null;a.name.match(".csv|.xls|.xlsx")?(d="viewXLS",5<a.size/1048576&&(h("#glance_file_too_large").addClass("glance_hide"),document.getElementById("glance_file_confirm").disabled=!0)):a.name.match(".pdf")&&(d="viewPDF");d?(c||GLANCE.Cobrowse.Visitor.sendDocument(a),
c?c.contentWindow.GLANCE.Cobrowse.Visitor[d]({data:e,preview:!0}):GLANCE.Cobrowse.Visitor[d]({data:e,name:a.name,visitorselected:!0})):doclog("can't process ",a.name)})}function F(){this.msgboxcontainer=document.createElement("div");this.msgboxcontainer.innerHTML=F.html;document.body.appendChild(this.msgboxcontainer);this.docshareterms=new W(this);this.msgbox=h("#glance_msg_box");this.scrim=h("#glance_scrim");this.filepicker=h("#glance_filepicker");this.filedownloading=h("#glance_filedownloading");
this.navassistmessage=h("#glance_nav_assist");this.filepicker.getElement("#glance_launch_filepicker").addEvent("click",()=>{this.filepicker.getElement("#glance_cbfile").elem.click()});this.confirmation=new B;this.msgbox.makeDialog("#glance_msg_ok",()=>{this.msgbox.onOK&&(this.msgbox.onOK(),delete this.msgbox.onOK);this.hideMessage()});this.filepicker.makeDialog("#glance_file_cancel",()=>{this.docshareterms.onPreviewCancel();doclog("cancel callback");this.hideMessage()},"#glance_file_confirm",()=>
{this.docshareterms.onConfirm();S(this.filepicker.selectedFile);this.hideMessage()});this.filedownloading.makeDialog("#glance_closedownloadingmodal",()=>{this.hideMessage()});this.navassistmessage.makeDialog("#glance_nav_decline",()=>{this.hideMessage()},"#glance_nav_accept",a=>{this.navassistmessage.onNavAssistAccepted()})}function n(a){if(a.includes("<script"))throw Error("ERR_UNSAFE_BUTTON_HTML");if(document.body){var c=document.createElement("div");c.innerHTML=a;document.body.append(...Array.from(c.children));
this.button=h("#glance_cobrowse_btn");this.setState(T);this.startlabel=h("#glance_start_label");this.border=h("#glance_border");this.announcementpill=h("#glance_agentviewing");this.accessiblitystatus=h("#glance_accessibility_status");this.videopreview=this.button.getElement("#glance_ssnkey_box glance-video-preview");this.videosessionpreview=h("#glance_videopreviewcontainer");this.ssnkeybox=this.button.getElement("#glance_ssnkey_box");a="original"===w.confirmation.widgetstyle;"alertdialog"===this.ssnkeybox.elem.getAttribute("role")&&
this.ssnkeybox.makeDialog("#glance_cancel_btn",()=>{this.confirmStopSession()},void 0,void 0,a);this.addEventListeners();this.visitorVideoBlurred=!1;n.created()}else console.error("ERR_NO_BODY")}function D(a,c){a&&a.addEvent("click",e=>{e.preventDefault();0===e.button&&c()})}function X(a){function c(d){if(d===L.name)return L;if(d===J.visitorVideoViewer.name)return J.visitorVideoViewer;if(G.videoViewers[d])return G.videoViewers[d];debuglog("Unrecognized screenshareView:",d)}uilog("createSessionButton Visitor.loaded:",
GLANCE.Cobrowse.Visitor.loaded,"session readystate:",GLANCE.Cobrowse.Visitor.readyState);if(!h("#glance_cobrowse_btn")){k=new n(a);var e=new y;GLANCE.Cobrowse.Visitor.inSession()&&k.showInSession();document.addEventListener("keydown",function(d){27===d.keyCode&&document.activeElement.matches("#glance_stop_btn, #glance_resize_video, #glance_stop_video, #glance_blurbgd_video, #glance_drag_handle")&&(d.target.hasAttribute("data-accessibility-hidden")?d.target.removeAttribute("data-accessibility-hidden"):
d.target.setAttribute("data-accessibility-hidden",""),d.preventDefault(),d.stopPropagation());if(37<=d.keyCode&&40>=d.keyCode&&d.shiftKey&&document.activeElement.matches("#glance_drag_handle")){let l=r.get(r.WIDGETPOS);switch(d.key){case "ArrowLeft":l.left=!0;break;case "ArrowRight":l.left=!1;break;case "ArrowUp":l.bottom=!1;break;case "ArrowDown":l.bottom=!0}r.set(r.WIDGETPOS,l);k.restoreWidgetPos(!0);k.announceAccessibilityStatus("widget moved to "+(l.bottom?"bottom ":"top ")+(l.left?"left":"right"))}"Tab"===
d.key&&d.shiftKey&&d.target.matches('[data-videosize="large"] .firstcontrol')&&d.preventDefault();"Tab"===d.key&&!d.shiftKey&&d.target.matches('[data-videosize="large"] .lastcontrol')&&d.preventDefault()},!1);GLANCE.Cobrowse.Visitor.addEventListener("agents",function(d){k.showAgentJoined(d);r.get(r.BOXSTATE)<n.BOXSTATE_JOINED&&(k.setBoxState(n.BOXSTATE_JOINED),k.restoreWidgetPos(),"original"===x.widgetstyle&&k.setExpanded(!1),GLANCE.Cobrowse.Visitor.isPageMasked()||GLANCE.Cobrowse.Visitor.isSessionPaused()||
k.showAnnouncementPill(!0,t["agent-viewing-pill"]),this.videopreview&&this.videopreview.elem.stop());G.syncViewerList(d.agentlist);k.restoreWidgetPos(!0)});GLANCE.Cobrowse.Visitor.addEventListener("reverseconfirm",function(d){w.confirmation.show("glance_confirm_show",t["allow-view-screen-text"],function(){d.accept()},function(){d.decline()})});GLANCE.Cobrowse.Visitor.addEventListener("reverseended",function(){h("#glance_confirm_msg").elem.className.includes&&h("#glance_confirm_msg").elem.className.includes("glance_confirm_show")&&
w.confirmation.hide()});L=new E;GLANCE.Cobrowse.Visitor.addEventListener("sessionstarting",function(){assert(GLANCE.Cobrowse.Visitor.readyState===GLANCE.Cobrowse.Visitor.READYSTATE.sessionstarting);k.showStarting();k.announceAccessibilityStatus(t["button-session-starting-text"]);return!0});GLANCE.Cobrowse.Visitor.addEventListener("sessionstart",function(){assert(GLANCE.Cobrowse.Visitor.readyState===GLANCE.Cobrowse.Visitor.READYSTATE.sessionstart);k.showJoinPrompt()});GLANCE.Cobrowse.Visitor.addEventListener("sessioncontinue",
function(){assert(GLANCE.Cobrowse.Visitor.readyState===GLANCE.Cobrowse.Visitor.READYSTATE.sessioncontinue)});GLANCE.Cobrowse.Visitor.addEventListener("statereceived",function(){assert(GLANCE.Cobrowse.Visitor.readyState===GLANCE.Cobrowse.Visitor.READYSTATE.statereceived);uilog("getSessionState agents",GLANCE.Cobrowse.Visitor.getSessionState("agents"));uilog("getSessionState rc",GLANCE.Cobrowse.Visitor.getSessionState("rc"));uilog("getSessionState glance_screenshare",GLANCE.Cobrowse.Visitor.getSessionState("screenshare",
"glance_screenshare"));k.showInSession();CobrowseVideoUtils.setVideoScrollOffset(r.get("videoscrolloffset")||0)});GLANCE.Cobrowse.Visitor.addEventListener("sessionend",function(d){assert(GLANCE.Cobrowse.Visitor.readyState===GLANCE.Cobrowse.Visitor.READYSTATE.sessionend);"error"!==d.reason&&w.hideMessage();k.showSessionStopped();e.hide();L.hide();k.announceAccessibilityStatus(t["session-ended-text"]);k.showAnnouncementPill(!1)});GLANCE.Cobrowse.Visitor.addEventListener("error",function(d){var l=d.msg;
switch(d.code){case "conndrop":l="Could not connect to server "+d.params.server;break;case "service":l=l||"Unable to connect to Glance"}w.showMessage("",l)});GLANCE.Cobrowse.Visitor.addEventListener("screenshare",function(d){uilog("Received screenshare event:",d);if(d.screenshareView!==J.visitorVideoViewer.name||"original"===x.widgetstyle){var l=c(d.screenshareView);l&&l.show(d)}});GLANCE.Cobrowse.Visitor.addEventListener("screensharepaused",function(d){uilog("Received screenshare paused event:",
d);c(d.screenshareView).pause(d)});GLANCE.Cobrowse.Visitor.addEventListener("screenshareresumed",function(d){uilog("Received screenshare resumed event:",d);c(d.screenshareView).resume(d)});GLANCE.Cobrowse.Visitor.addEventListener("viewerinfo",function(d){uilog("Received screenshare viewerinfo event:",d);let l=c(d.screenshareView);l&&l.viewerinfo(d)});GLANCE.Cobrowse.Visitor.addEventListener("viewerclosing",function(d){uilog("Received screenshare closing event:",d);c(d.screenshareView)&&"PlayerTooSlow"===
d.closereason&&k.handlePlayerTooSlow()});J=new Y;GLANCE.Cobrowse.Visitor.addEventListener("visitorvideorequested",function(d){e.show(d.accept,d.decline)});GLANCE.Cobrowse.Visitor.addEventListener("visitorvideoerror",function(){vidlog("Visitor video error");k.setVideoParticipantState(0,z.ERROR)});GLANCE.Cobrowse.Visitor.addEventListener("videobgfilterfailed",d=>{vidlog("Video background filtering failed");let l="";switch(d.failuremode){case "abortvideo":l=t["video-blur-failed-abortvideo"];k.setVideoParticipantState(0,
z.BLOCKED);break;case "abortbgfilter":l=t["video-blur-failed-abortbgfilter"],k.videosessionpreview.setAttr("data-videoblurcapable-0",!1)}w.showMessage("",l)});GLANCE.Cobrowse.Visitor.addEventListener("visitorvideo",function(d){vidlog("Visitor video",d);"large"===d.video&&k.setExpanded(!0);J.show(d);"small"===d.video&&CobrowseVideoUtils.setVideoScrollOffset(r.get("videoscrolloffset")||0);switch(d.camerastatus){case "available":k.getVideoParticipantState(0)||k.setVideoParticipantState(0,z.ON,d.videobgfilter,
"none"!==d.videobgtype);break;case "nocamera":case "blocked":case "aborted":k.setVideoParticipantState(0,z.BLOCKED);break;case "notsupported":k.setVideoParticipantState(0,z.NOTSUPPORTED);break;case "error":k.setVideoParticipantState(0,z.ERROR)}k.restoreWidgetPos()});GLANCE.Cobrowse.Visitor.addEventListener("visitorvideopaused",function(d){vidlog("Visitor video paused");k.visitorVideoPaused(!0)});GLANCE.Cobrowse.Visitor.addEventListener("visitorvideoresumed",function(d){vidlog("Visitor video resumed");
k.visitorVideoPaused(!1)});GLANCE.Cobrowse.Visitor.addEventListener("blur",function(){uilog("Hiding button on blur");k.clearButtonState();k.setState(4);k.show(!1);k.border.hide()});GLANCE.Cobrowse.Visitor.addEventListener("focus",function(){k.showInSession();k.border.show()});GLANCE.Cobrowse.Visitor.addEventListener("rcrequested",function(d){function l(m){return function(){m?d.accept():d.decline()}}w.confirmation.show("glance_confirm_rc",d.selective?t["ce-prompt-text"]:t["rc-prompt-text"],l(!0),l(!1))});
GLANCE.Cobrowse.Visitor.addEventListener("visitorscreensharerequested",function(d){w.confirmation.show("glance_confirm_screenshare",t["visitor-screenshare-request-msg"],d.accept,d.decline,t["visitor-screenshare-request-title"],t["button-accept"],t["button-decline"])});GLANCE.Cobrowse.Visitor.addEventListener("visitorscreensharesurfacenotallowed",function(d){w.confirmation.show("glance_confirm_screenshare",t["visitor-screenshare-surface-not-allowed-msg"],d.accept,d.decline)});GLANCE.Cobrowse.Visitor.addEventListener("docsharerequested",
function(d){w.scrim.show();r.get(r.DOCSHARETERMSACCEPTED)?w.showFilePicker():w.docshareterms.showDialog(d)});GLANCE.Cobrowse.Visitor.addEventListener("navassistrequested",function(d){w.scrim.show();w.navassistmessage.onNavAssistAccepted=()=>{d.accept().then(l=>{k.button.elem.matches("[data-videosize=large]")&&GLANCE.Cobrowse.Visitor.toggleVideoSize();w.hideMessage();window.location=l})};w.navassistmessage.getElement("#glance_nav_assist_link_name").elem.innerText=d.name;w.navassistmessage.showDialog(d)});
GLANCE.Cobrowse.Visitor.addEventListener("filedownloading",function(d){w.scrim.show();w.filedownloading.showDialog()});GLANCE.Cobrowse.Visitor.addEventListener("filedownloaded",function(d){w.hideMessage()});GLANCE.Cobrowse.Visitor.addEventListener("confirm",function(d){w.confirmation.show(`glance_confirm_${d.confirm}`,t[`confirm-${d.confirm}`],d.accept)});GLANCE.Cobrowse.Visitor.addEventListener("rc",function(d){(d.enabled?k.border.addClass:k.border.removeClass).call(k.border,"glance_rcenabled");
r.get(r.RCENABLED)!==d.enabled&&(k.showAnnouncementPill(!0,d.enabled?t["agent-controlling-pill"]:t["agent-viewing-pill"]),k.announceAccessibilityStatus(d.enabled?t["rc-started-text"]:t["rc-ended-text"]));r.set(r.RCENABLED,d.enabled)});GLANCE.Cobrowse.Visitor.addEventListener("connection",function(d){k.showDisconnected("reconnecting"===d.status)});GLANCE.Cobrowse.Visitor.addEventListener("urlstartwarning",function(d){w.confirmation.show("glance_confirm_xd",t["cross-domain-continue-text"],d.accept,
d.decline)});GLANCE.Cobrowse.Visitor.addEventListener("widgetmoving",d=>{k.draggingWidget(d)});GLANCE.Cobrowse.Visitor.addEventListener("widgetmoved",d=>{var l=r.get(r.WIDGETPOS);d&&(d.hasOwnProperty("left")&&(l.left=d.left),d.hasOwnProperty("bottom")&&(l.bottom=d.bottom),r.set(r.WIDGETPOS,l));k.announceAccessibilityStatus("widget moved to "+(l.bottom?"bottom ":"top ")+(l.left?"left":"right"));k.restoreWidgetPos(!0)});k.makeDraggable();(a=GLANCE.Cobrowse.Loader&&GLANCE.Cobrowse.Loader._onload.VisitorUI)&&
a();GLANCE.Cobrowse.Loader.setUIReady()}}function Z(a){GLANCE.Cobrowse.VisitorUI.VERSION=GLANCE.VERSION;GLANCE.Cobrowse.VisitorUI.loaded=!0;GLANCE.Cobrowse.VisitorUI.setStyle=function(c){A.addStylesheets(c)};GLANCE.Cobrowse.VisitorUI.showButton=function(c){void 0===c&&(c=!0);n.createdpromise.then(()=>k.show(c))};GLANCE.Cobrowse.VisitorUI.toggleButton=function(){n.createdpromise.then(()=>k.toggle())};GLANCE.Cobrowse.VisitorUI.showTerms=function(c){(c=c||{},c.groupid)&&A.addStylesheets(c.groupid);c=
A.coalesceSessionStartParams(a,c);v("terms",{status:"displayed"});K=K||new R;K.show(!0,c)};GLANCE.Cobrowse.VisitorUI.promptCrossDomain=function(c){return!GLANCE.Cobrowse.Visitor.inSession()||GLANCE.Cobrowse.Visitor.isCrossDomainDone()?Promise.resolve():new Promise(function(e,d){w.confirmation.show("glance_confirm_xd",t["cross-domain-continue-text"],()=>{GLANCE.Cobrowse.Visitor.crossDomain(c).then(function(l){e(l)})},()=>{},"",t["button-accept"],t["button-decline"])})}}function aa(){return new Promise(a=>
{if(GLANCE.Cobrowse.Visitor.loaded)a();else{var c=document.getElementById("glance_visitor");c?(c.addEventListener("load",a),uilog("Waiting for visitor script to load")):a()}})}var U=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),L,J,x={},k,w,t,K,A=new CBScriptTag;let I;if(fetch.toString().includes("native code"))I=window.fetch;else{var M=document.createElement("iframe");M.style.display="none";M.setAttribute("data-no-cobrowse-content",1);document.body.appendChild(M);I=M.contentWindow.fetch}let ba=
{get:function(){let a={bgFilterEnabled:x.videobgblurallowed,bgType:"blur"};Object.assign(a,JSON.parse(x.videomaxquality));a.framerate=24;delete a.modelID;return new GLANCE.Video.GlanceVideoSource(a)}};var r={EXPANDED:"expanded",BOXSTATE:"boxstate",RCENABLED:"rcenabled",WIDGETPOS:"widgetpos",AGENTJOINED:"agentjoined",DOCSHARETERMSACCEPTED:"docsharetermsaccepted",set:function(a,c){GLANCE.Cobrowse.Visitor.inSession()&&GLANCE.Cobrowse.Visitor.setCookieValue(a,c)},get:function(a){return GLANCE.Cobrowse.Visitor.inSession()?
GLANCE.Cobrowse.Visitor.getCookieValue(a):null}};B.prototype.hide=function(){this.confirm.hide();this.scrim.hide();this.scrim.removeClass("glance-confirm");this.confirm.previousFocus&&this.confirm.previousFocus.focus()};B.prototype.show=function(a,c,e,d,l="",m=t["button-yes"],u=t["button-no"]){this.onPrimaryButtonClick=e;this.onSecondaryButtonClick=d?d:function(){};e=h("#glance_confirm_msg");d=h("#glance_confirm_msg_header");e.setClass(a);"original"!==this.widgetstyle&&(e.text(c),d.text(l));h("#glance_confirm_primary_button").text(m);
h("#glance_confirm_secondary_button").text(u);this.confirm.showDialog();this.scrim.show();this.scrim.addClass("glance-confirm")};class N extends HTMLElement{constructor(){super()}connectedCallback(){if(!this.querySelector(".glance_vvc_preview")){this.appendChild(h("#glance_videopreviewwidget").elem.content.cloneNode(!0));var a=h(this);this.videosources=a.getElement(".glance_selectvideosource");this.preview=a.getElement("video");this.previewcontainer=a.getElement(".glance_vvc_preview");this.cameramessage=
a.getElement(".glance_vvc_cameramessage");this.overlaymessage=a.getElement(".glance_vvc_overlaymessage");this.onoffbutton=a.getElement(".glance_camera-on-off");this.blurbutton=a.getElement(".glance_camera-blur");this.vidgradation=a.getElement(".glance_vid-gradation");this.previewsetup=!1;navigator.vendor.startsWith("Apple")&&this.safariVideoWorkaround();this.videosources.addEvent("selchange",c=>{localStorage.setItem("GlanceSelectedCamera",this.videosources.elem.getSelectedValue());this.dispatchEvent(new Event("settingschange"));
this.showCameraMessage("");this.stop();this.start()});this.onoffbutton.addEvent("click",c=>{this.cameraon=!this.cameraon;this.dispatchEvent(new Event("settingschange"));this.previewcontainer.toggleClass("glance_pausedvideo");this.cameraon?this.start():(this.stop(),this.showCameraMessage(""))});this.blurbutton.addEvent("click",()=>{this.videobgblur=!this.videobgblur;this.setBgBlur(this.videobgblur)})}}safariVideoWorkaround(){let a=document.createElement("video");for(var c=this.preview.elem.attributes,
e=0;e<c.length;e++)a.setAttribute(c[e].nodeName,c[e].nodeValue);c=this.preview.elem.previousSibling;e=this.preview.elem.parentElement;this.preview.elem.remove();e.insertBefore(a,c);this.preview=h(a)}getCameraSettings(){return{videosource:this.videosources.elem.getSelectedValue().split("|")[0],camerastatus:this.camerastatus,videopaused:!this.cameraon,videobgfilter:!!this.videobgblur,videobgtype:this.videobgtype}}async start(){await this.populateCameraSelect();let a=localStorage.getItem("GlanceSelectedCamera"),
c=null;a?(c={label:a.split("|")[0],deviceId:a.split("|")[1]},this.videosources.elem.selectValue(a)):this.videosources.elem.size()&&(c={label:this.videosources.elem.getSelectedValue().split("|")[0],deviceId:this.videosources.elem.getSelectedValue().split("|")[1]});vidlog("Starting preview for source:",c);await this.glanceVideo.initialize(c,this.preview.elem,!1);if(!this.glanceVideo)return!1;this.videosources.elem.size()||this.handleCameraError({name:"NotAllowedError"});return!!this.glanceVideo}stop(a){this.glanceVideo&&
(this.glanceVideo.stopPreview(this.preview.elem,a&&this.cameraon),this.displaypreview(!1),this.onoffbutton.setAttr("aria-pressed",!1),this.previewrunning=!1,this.showCameraMessage(""),this.overlaymessage.hide())}setBgBlur(a){this.blurbutton.setAttr("aria-pressed",a);this.dispatchEvent(new Event("settingschange"));this.glanceVideo.setBgFilterActive(a);N.videoBlurFailed&&(a?this.showVideoOverlayMessage(t["camera-message-blurperformance"]):this.overlaymessage.hide())}hidePreviewControls(){this.onoffbutton.hide();
this.blurbutton.hide();this.videosources.hide();this.overlaymessage.hide()}displaypreview(a){this.preview.show(a);this.vidgradation.show(a)}shutdownPreview(a){if(this.previewsetup)return this.stop(a),this.previewsetup=!1,this.hidePreviewControls(),this.glanceVideo}async getDefaultCamera(){try{let e=(await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})).getVideoTracks()[0];var a=e.getCapabilities().deviceId;var c=e.label;e.stop()}catch(e){return{exception:e}}return{deviceId:a,deviceLabel:c}}isMobileDevice(){try{let a=
navigator.userAgent.toLowerCase(),c=navigator.platform.toLowerCase();return null!==(a.match(/ip(?:ad|od|hone)/)||c.match(/mac/)&&"undefined"!==typeof navigator.standalone?"ios":(a.match(/(?:webos|android)/)||c.match(/mac|win|linux/)||["other"])[0]).match(/^(ios|android)$/)}catch(a){return console.error("Exception in isMobileDevice",a),!1}}setupPreview(){if(this.previewsetup)return Promise.resolve();this.previewsetup=!0;this.previewrunning=!1;this.glanceVideo=ba.get();this.glanceVideo.addEventListener("bgFilterPerformanceFail",
()=>{this.showVideoOverlayMessage(t["camera-message-blurperformance"]);N.videoBlurFailed=!0});this.glanceVideo.addEventListener("previewStarted",a=>{vidlog("previewStarted");this.glanceVideo&&(this.videobgtype=this.glanceVideo.getBackgroundSettings().capable&&x.videobgblurallowed?"blur":"none",this.videobgblur=this.glanceVideo.getBackgroundSettings().capable&&x.videobgblurallowed,this.displaypreview(!0),this.setBgBlur(this.videobgblur),this.camerastatus="available",this.cameramessage.text(""),this.previewrunning=
!0,this.dispatchEvent(new Event("settingschange")),this.onoffbutton.setAttr("aria-pressed",!0),this.displaypreview(!0))});this.hidePreviewControls();this.cameraon=!0;this.camerastatus="nocamera";this.previewcontainer.removeClass("glance_pausedvideo");this.onoffbutton.setAttr("aria-pressed",this.cameraon);this.displaypreview(!1);return new Promise(async(a,c)=>{if("https:"!==window.location.protocol)console.error("ERR_VIDEO_INSECURE"),c();else{this.glanceVideo.addEventListener("error",e=>{vidlog("Glance video error event:",
e);this.handleCameraError(e.name?e:{name:e});c()});this.preview.addEvent("play",()=>{this.previewsetup&&(window.setTimeout(()=>{"nocamera"!==this.camerastatus&&this.showCameraMessage(t["camera-message-previewing"],!0)},2E3),"nocamera"!==this.camerastatus&&(this.camerastatus="available",this.onoffbutton.show("visible"===this.getAttribute("data-onoffbutton")),this.glanceVideo.getBackgroundSettings().capable&&x.videobgblurallowed&&x.videobgblurtoggle&&this.blurbutton.show("visible"===this.getAttribute("data-blurbutton")),
this.showVideoSources(),a()))},!0,{once:!0});try{await this.start()?x.videobgblurallowed&&!this.glanceVideo.getBackgroundSettings().capable&&"abortvideo"===x.bgdetectfailmode&&(this.cameraon=!1,this.camerastatus="nocamera",this.showCameraMessage(t["camera-message-noblurnovideo"],!1),a()):a()}catch(e){vidlog("Exception",e,"setting up camera preview"),this.handleCameraError(e.name?e:{name:e}),c()}}})}showVideoSources(){1<this.videosources.elem.size()&&!this.isMobileDevice()&&this.videosources.show()}handleCameraError(a){let c=
t[`camera-error-${a.name.toLowerCase()}`]||a.name;this.showCameraMessage(c);switch(a.name){case "NotFoundError":this.camerastatus="nocamera";break;case "NotAllowedError":this.camerastatus="blocked";break;case "NotSupported":this.camerastatus="notsupported";break;case "NotReadableError":this.camerastatus="error",this.showVideoSources();default:this.camerastatus="error"}this.dispatchEvent(new Event("settingschange"))}async populateCameraSelect(){if(!(0<this.videosources.elem.size()))return new Promise(a=>
{this.glanceVideo.getSources(c=>{this.isMobileDevice()&&(c=c.filter(e=>e.name.startsWith("front")));for(let e of c)this.videosources.elem.addItem(e.name,`${e.label}|${e.deviceId}`);c.length&&((c=localStorage.getItem("GlanceSelectedCamera"))&&this.videosources.elem.hasValue(c)?this.videosources.elem.selectValue(c):(this.videosources.elem.selectItem(0),localStorage.setItem("GlanceSelectedCamera",this.videosources.elem.getSelectedValue())));a()})})}showCameraMessage(a,c){c||this.displaypreview(!1);this.cameramessage.setAttr("data-showforrole",
c?"agent":"all");this.cameramessage.text(a)}showVideoOverlayMessage(a){this.overlaymessage.show();this.overlaymessage.text(a)}}customElements.get("glance-video-preview")||window.customElements.define("glance-video-preview",N);y.prototype.hide=function(){this.confirm&&this.shown&&(this.videopreview.shutdownPreview(),B.prototype.hide.call(this),this.shown=!1)};y.prototype.show=function(a,c){this.shown||(this.shown=!0,this.onAccept=a,this.onDecline=c,this.confirm?(this.confirm.showDialog(),this.scrim.show(),
this.confirm.getElement("#glance_vvc_accept").elem.disabled=!0,this.videopreview.setupPreview().then(()=>{this.confirm.getElement("#glance_vvc_accept").elem.disabled=!1}).catch(()=>{})):console.error("ERR_NO_NWAYVIDEO"))};E.prototype.show=function(a){(a="ended"!==a.state&&"still-ended"!==a.state&&!a.paused)?(this.view.show(a),k.button.addClass("viewingscreenshare"),k.showAnnouncementPill(!0,t["agent-sharing-pill"])):this.hide();"original"===x.widgetstyle&&this.scrim.show(a)};E.prototype.hide=function(){this.view.show(!1);
k.button.removeClass("viewingscreenshare");"original"===x.widgetstyle&&this.scrim.show(!1)};E.prototype.viewerinfo=function(){};E.prototype.pause=function(){this.show({state:"continued",paused:!0});k.button.removeClass("viewingscreenshare")};E.prototype.resume=function(){this.show({state:"continued",paused:!1});k.button.addClass("viewingscreenshare")};class G{constructor(a,c,e){this.role=c||"visitor";this.number=a;this.name=CobrowseVideoUtils.getViewerId(a,x.widgetstyle);this.displayName=e||"";this.addToDOM();
this.iframe=h("#"+this.name)}addToDOM(){if(!h("#"+this.name)){var a=h("#glance_video_containers");if(a){var c=h("#glance_videoviewertemplate").elem.content.cloneNode(!0);c.getElementById("glance_video_container_n").id=`glance_video_container_${this.number}`;c.getElementById("glance_video_n").id=`glance_video_${this.number}`;this.container=c.children[0];this.container.setAttribute("data-role",this.role);this.container.querySelector(".glance_pausevideobutton").setAttribute("data-participantnum",this.number);
this.container.querySelector(".glance_ejectguestbutton").setAttribute("data-participantnum",this.number);this.container.querySelector(".glance-participant-name").innerText=this.displayName;a.elem.appendChild(this.container);"left"!==a.getAttr("data-smallvideoscroll")&&a.setAttr("data-smallvideoscroll","both")}}}removeFromDOM(){this.container&&this.container.remove()}show(a){this.params=a.params;if(!a.paused)switch(a.state){case "error":case "still-error":this.videoError();break;case "ended":this.videoOff();
break;case "still-ended":this.setVideoState(z.PAUSED);break;default:this.videoOn("new"===a.state)}}setVideoState(a){this.videostate=a;k.setVideoParticipantState(this.number,a)}videoOn(a){this.setVideoState(z.ON);k.nwayVideoMode()||(k.setBoxState(n.BOXSTATE_VIDEO),k.announceAccessibilityStatus(t["video-started-text"]),a&&k.setExpanded(!0));k.restoreWidgetPos()}videoOff(){this.setVideoState(z.PAUSED);k.announceAccessibilityStatus(t["video-ended-text"]);k.nwayVideoMode()||0!==G.numViewersOn()||(k.setBoxState(n.BOXSTATE_JOINED),
k.setExpanded(!1));k.restoreWidgetPos()}videoError(){this.setVideoState(z.ERROR)}viewerinfo(a){uilog("Viewer info:"+JSON.stringify(a))}pause(){this.videoOff()}resume(){this.videoOn(!0)}static syncViewerList(a){let c=[];a.forEach(e=>{e=CobrowseVideoUtils.getViewerId(e.num,x.widgetstyle);c.push(e)});for(const e in this.videoViewers)c.includes(e)||(this.videoViewers[e].removeFromDOM(),delete this.videoViewers[e]);a.forEach(e=>{let d=CobrowseVideoUtils.getViewerId(e.num,x.widgetstyle);this.videoViewers[d]||
(this.videoViewers[d]=new G(e.num,e.role,e.name))})}static removeViewers(){for(var a in this.videoViewers)this.videoViewers[a].removeFromDOM();this.videoViewers={}}static numViewersOn(){return Object.values(this.videoViewers).filter(a=>a.videostate===z.ON).length}}G.videoViewers={};class Y{constructor(){this.visitorVideoViewer=new G("0")}show(a){k.setNWayVideoState(a)}hide(){k.setBoxState(n.BOXSTATE_VIDEO)}}R.prototype.show=function(a,c){GLANCE.Cobrowse.Visitor.inSession()||(this.scrim.show(a),a?
(this.startparams=c||{},(this.showvideopreview=this.startparams.video&&"off"!==this.startparams.video&&"GLANCE_KEYTYPE_RANDOM"!==this.startparams.sessionKey)?(this.videopreview||console.error("ERR_NO_NWAYVIDEO"),h(this.videopreview).show(),this.terms.getElement("#glance_accept").elem.disabled=!0,this.videopreview.setupPreview().then(()=>{this.terms.getElement("#glance_accept").elem.disabled=!1;this.terms.trapFocusInDialog()}).catch(()=>{this.terms.getElement("#glance_accept").elem.disabled=!1;this.terms.trapFocusInDialog()})):
this.videopreview&&h(this.videopreview).hide(),this.terms.showDialog(!0,this.showvideopreview)):(this.videopreview&&this.videopreview.shutdownPreview(),this.terms.hide()))};class W{constructor(a){this.messageBoxes=a;this.docshareterms=h("#glance_filepicker_terms");this.docshareterms.makeDialog("#glance_file_terms_accept",()=>{r.set(r.DOCSHARETERMSACCEPTED,!0);this.messageBoxes.hideMessage();this.messageBoxes.showFilePicker();this.onPreviewConfirm()},"#glance_file_terms_decline",()=>{this.onPreviewCancel();
this.messageBoxes.hideMessage()})}hide(){this.docshareterms.hide()}showDialog(a){this.onConfirm=a.onconfirm;this.onCancel=a.oncancel;this.onPreviewConfirm=a.onpreviewconfirm;this.onPreviewCancel=a.onpreviewcancel;this.docshareterms.showDialog()}}F.prototype.configure=function(a){this.widgetstyle=a.widgetstyle;this.confirmation.widgetstyle=this.widgetstyle;this.msgboxcontainer.className=`glance_${this.widgetstyle}`;if("original"===this.widgetstyle)this.msgboxcontainer.className="glance_ui_36",h("#glance_msg_ok").text("");
else{a={"#glance_msg_ok":"button-message-ok","#glance_confirm_primary_button":"button-yes","#glance_confirm_secondary_button":"button-no","#docshare-loading-header":"docshare-loading-header","#docshare-disclaimer":"docshare-disclaimer","#glance_docshare_terms_link":"terms-link","#glance_file_terms_accept":"button-accept","#glance_file_terms_decline":"button-decline","#glance_nav_accept":"button-accept","#glance_nav_decline":"button-decline","#docshare-header":"docshare-disclaimer-header","#glance_dragdrop_msg":"docshare-drag-instructions",
"#docshare-or":"docshare-or","#glance_launch_filepicker":"docshare-filepicker","#glance_invalid_file":"docshare-invalid-file","#glance_file_too_large":"docshare-file-too-large","#glance_file_confirm":"docshare-accept","#nav_assist_title":"nav-assist","#glance_file_cancel":"docshare-cancel","#glance_downloading_msg":"docshare-loading"};for(const c in a)h(c).text(t[a[c]]);h("#glance_docshare_terms_link").elem.href=t["docshare-termsurl"]}};F.html="\n            <div id='glance_scrim' tabindex='-1' class='glance_dim glance_hide'></div>\n            <div id='glance_msg_box' aria-labelledby='glance_msg_box' class='glance_hide glance_ui glance_popupmsg'><p id='glance_msg'></p><button id='glance_msg_ok'>OK</button></div>\n            <div id='glance_confirm' role='alertdialog' aria-labelledby='glance_confirm_msg' class='glance_hide glance_ui glance_popupmsg glance_norc'>\n                <strong id='glance_confirm_msg_header'>\n                </strong>\n                <p id='glance_confirm_msg'>\n                </p>\n                <button id='glance_confirm_primary_button'></button>\n                <button id='glance_confirm_secondary_button' class='secondary_btn'></button>\n            </div>\n\n            <div id='glance_filedownloading' role='alertdialog' aria-labelledby='docshare-loading-header' class='glance_hide glance_ui glance_popupmsg glance_norc'>\n                <button id='glance_closedownloadingmodal' class=\"\"></button>   \n                <h5 id='docshare-loading-header'></h5>\n                <p id='glance_downloading_msg'></p>\n                <div class=\"glance_spinner\">\n\t\t\t\t\t<div class=\"glance_bounce1\"></div>\n\t\t\t\t\t<div class=\"glance_bounce2\"></div>\n\t\t\t\t\t<div class=\"glance_bounce3\"></div>\n\t\t\t\t</div>\n            </div>\n\n            <div id='glance_filepicker_terms' aria-labelledby='docshare-disclaimer' class='glance_hide glance_msg glance_ui glance_popupmsg' role=\"alertdialog\" aria-modal=\"true\">\n\t\t\t    <div>\n\t\t\t\t    <p id='docshare-disclaimer'></p>\n\t\t\t\t    <a target=\"_blank\" id='glance_docshare_terms_link' href=\"\"></a>\n\t\t\t    </div>\n\t\t\t    <button id='glance_file_terms_accept' class=\"primary_btn\"></button>\n\t\t\t    <button id='glance_file_terms_decline' class='secondary_btn'></button>\n\t\t    </div>\n            \n            <div id=\"glance_nav_assist\" aria-labelledby='nav_assist_title' class='glance_hide glance_msg glance_ui glance_popupmsg' role=\"alertdialog\" aria-modal=\"true\"> \n                <h4 id=\"nav_assist_title\"> </h4>\n                <p id=\"glance_nav_assist_link_name\">  </p>\n                \n\t\t\t    <button id='glance_nav_accept' class=\"primary_btn\"></button>\n\t\t\t    <button id='glance_nav_decline' class='secondary_btn'></button>\n            </div>\n\n\t\t    <div id='glance_filepicker' aria-labelledby='glance_msg_box' class='glance_hide glance_msg glance_ui glance_popupmsg' role=\"alertdialog\" aria-modal=\"true\">\n\t\t\t    <div id=\"glance_filepicker_header\">\n\t\t\t\t    <h2 id='docshare-header'></h2>\n\t\t\t\t    <button id=\"glance_close_filepicker\" aria-labelledby=\"glance_file_cancel\"></button>\n\t\t\t    </div>\n\n\t\t\t    <div id=\"glance_select_file\">\n\t\t\t\t    <div id=\"glance_filepicker_wrapper\" class=\"glance_drop_zone\">\n\t\t\t\t\t    <p id=\"glance_dragdrop_msg\"></p>\n\t\t\t\t\t    <input style=\"display:none;\" type='file' name='glance_cbfile' id='glance_cbfile' accept=\".pdf, .csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\" aria-describedby=\"glance_invalid_file\">\n\t\t\t\t    </div>\n\t\t\t\t    <p id='docshare-or'></p>\n\t\t\t\t    <button id=\"glance_launch_filepicker\" aria-describedby=\"glance_invalid_file\"></button>\n\t\t\t\t    <p id=\"glance_invalid_file\" class=\"glance_hide\"></p>\n\t\t\t    </div>\n\n\t\t\t    <div id=\"glance_file_selected\" class=\"glance_hide\">\n\t\t\t\t    <p id=\"glance_selectedfile_name\" class=\"glance_masked\"> </p>\n\t\t\t\t    <iframe id=\"glance_documentpreviewframe\"></iframe>\n\t\t\t\t    <p id=\"glance_file_too_large\" class=\"glance_hide\"></p>\n\t\t\t\t    <button id='glance_file_confirm' class=\"primary_btn\"></button>\n\t\t\t\t    <button id='glance_file_cancel' class='secondary_btn'></button>\n\t\t\t    </div>\n\t\t    </div>\n        ";
F.prototype.showMessage=function(a,c,e){this.msgbox.onOK=e;this.scrim.show();a&&(this.msgClass=a,this.msgbox.addClass(a));"original"===this.widgetstyle&&a||this.msgbox.getElement("#glance_msg").text(c);this.msgbox.showDialog()};F.prototype.handleFileSelected=function(a){CobrowseVideoUtils.validFile(a)?(!CobrowseVideoUtils.validSize(a)&&GLANCE.Cobrowse.Visitor.canSendDocument()&&this.filepicker.getElement("#glance_file_too_large").removeClass("glance_hide"),this.filepicker.selectedFile=a,this.filepicker.getElement("#glance_selectedfile_name").text(this.filepicker.selectedFile.name),
this.filepicker.addClass("previewing"),S(a,document.getElementById("glance_documentpreviewframe"))):(this.filepicker.getElement("#glance_invalid_file").removeClass("glance_hide"),this.filepicker.getElement("#glance_launch_filepicker").elem.setAttribute("aria-invalid","true"))};F.prototype.showFilePicker=function(){this.scrim.show();document.querySelector("#glance_cbfile").onchange=a=>{this.handleFileSelected(a.target.files[0])};document.querySelector(".glance_drop_zone").ondragover=a=>{a.preventDefault()};
document.querySelector(".glance_drop_zone").ondrop=a=>{doclog("File(s) dropped");a.preventDefault();a.dataTransfer.items&&this.handleFileSelected(a.dataTransfer.files[0])};this.filepicker.getElement("#glance_close_filepicker").addEvent("click",a=>{this.docshareterms.onPreviewCancel();this.hideMessage()});this.filepicker.showDialog()};F.prototype.hideMessage=function(){this.msgbox.hide();this.msgClass&&(this.msgbox.removeClass(this.msgClass),delete this.msgClass);this.msgbox.getElement("#glance_msg").text("");
this.scrim.hide();this.confirmation.hide();this.filepicker.hide();this.filepicker.getElement("#glance_cbfile").elem.value=null;this.filepicker.getElement("#glance_selectedfile_name").elem.innerHTML="";this.filepicker.selectedFile=null;this.filepicker.getElement("#glance_select_file").removeClass("glance_hide");this.filepicker.removeClass("previewing");this.filepicker.getElement("#glance_file_selected").addClass("glance_hide");document.getElementById("glance_file_confirm").disabled=!1;var a=this.filepicker.getElement("#glance_documentpreviewframe"),
c=a.elem.contentWindow.document.getElementById("glance_pdfviewer");a=a.elem.contentWindow.document.getElementById("glance_xlsviewer");c&&(c.outerHTML="");a&&(a.outerHTML="");this.filepicker.getElement("#glance_invalid_file").addClass("glance_hide");this.filepicker.getElement("#glance_launch_filepicker").elem.removeAttribute("aria-invalid");this.filepicker.getElement("#glance_file_too_large").addClass("glance_hide");this.docshareterms.hide();this.filedownloading.hide();this.navassistmessage.hide()};
var T=2,O=";in_session;not_in_session;session_starting;in_session_blurred;in_session discon".split(";");n.prototype.focus=function(){this.button.focus()};n.prototype.announceAccessibilityStatus=function(a){if(this.accessiblitystatus){var c=this.accessiblitystatus.getElement("p");uilog("Announcing:",a);c.textContent=a}};n.prototype.handlePlayerTooSlow=function(){this.cantPlayVideoDisplayed||(this.showAnnouncementPill(!0,t["cant-play-video"]),this.cantPlayVideoDisplayed=!0)};n.prototype.showAnnouncementPill=
function(a,c){this.announcementpill&&(this.announcementpill.elem.textContent=c||"",a&&(this.announcementpill.removeClass("glance-announcement-pill"),window.setTimeout(()=>{this.announcementpill.addClass("glance-announcement-pill")}),window.setTimeout(()=>{this.announcementpill.show(!1)},5E3),this.announceAccessibilityStatus(c)),this.announcementpill.show(a))};n.prototype.setNWayVideoState=function(a){this.button.setAttr("data-videosize",a.video);h("#glance_resize_video").setAttr("aria-expanded","small"!==
a.video);x.videobgblurallowed&&x.videobgblurtoggle||h("#glance_blurbgd_video").hide();this.setBoxState(n.BOXSTATE_NWAYVIDEO)};n.prototype.showDisconnected=function(a){a?this.setState(5):5===this.state&&this.setState(1)};n.prototype.refreshFocusTrap=function(){var a=document.getElementById("glance_cancel_btn"),c=a.cloneNode(!0);a.parentNode.replaceChild(c,a);D(h("#glance_cancel_btn"),()=>{this.confirmStopSession()});a=Array.from(this.ssnkeybox.elem.querySelectorAll("a, input, button, select")).filter(e=>
null!==e.offsetParent);1<=a.length&&(h(a[0]).trapFocus(!0),h(a[a.length-1]).trapFocus(!1))};n.prototype.supportsDrag=function(){return"original"!==x.widgetstyle&&document.getElementById("glance_titlebar")};n.prototype.makeDraggable=function(){if(this.supportsDrag()){a(document.getElementById("glance_session_widget"));function a(c){function e(q){q=q||window.event;q.preventDefault();l=u-q.clientX;m=C-q.clientY;u=q.clientX;C=q.clientY;k.draggingWidget({bottom:m,left:0-l})}function d(){k.restoreWidgetPos(!0);
document.removeEventListener("mouseup",d);document.removeEventListener("mousemove",e)}c=document.getElementById("glance_titlebar");var l=0,m=0,u=0,C=0;c.addEventListener("mousedown",function(q){q.target.matches("button")||(q=q||window.event,q.preventDefault(),u=q.clientX,C=q.clientY,document.addEventListener("mouseup",d),document.addEventListener("mousemove",e))});c.addEventListener("touchmove",function(q){q.preventDefault();q=q.targetTouches[0];q={x:q.clientX,y:q.clientY};this.lasttouchcoords&&k.draggingWidget({bottom:this.lasttouchcoords.y-
q.y,left:q.x-this.lasttouchcoords.x});this.lasttouchcoords=q});c.addEventListener("touchend",function(q){this.lasttouchcoords=null;k.restoreWidgetPos(!0)})}}};n.prototype.addEventListeners=function(){D(h("#glance_cancel_btn"),()=>{this.confirmStopSession()});D(h("#glance_show_btn"),()=>{GLANCE.Cobrowse.Visitor.startSession()});D(h("#glance_stop_btn"),()=>{this.confirmStopSession()});D(h("#glance_blurbgd_video"),()=>{this.setVideoBgBlurState(!this.visitorVideoBlurred);GLANCE.Cobrowse.Visitor.setVideoBgFilterActive(this.visitorVideoBlurred)});
D(h("#glance_resize_video"),()=>{GLANCE.Cobrowse.Visitor.toggleVideoSize()});D(h("#glance_stop_video"),()=>{this.toggleVideo()});D(h("#glance_expand"),()=>{this.setExpanded(!r.get(r.EXPANDED));r.get(r.EXPANDED)?this.restoreWidgetPos():this.restoreWidgetPos(!0)});D(h("#glance_scroll-left"),()=>{this._doVideoScroll(!1)});D(h("#glance_scroll-right"),()=>{this._doVideoScroll(!0)});window.addEventListener("resize",a=>{uilog("moving widget on resize");this.restoreWidgetPos()});this.videopreview&&this.videopreview.elem.addEventListener("settingschange",
a=>{GLANCE.Cobrowse.Visitor.loaded&&GLANCE.Cobrowse.Visitor.setCameraSettings(a.target.getCameraSettings())})};n.prototype.setState=function(a){this.state=a;for(var c=O.length-1;0<=c;c--)this.button.removeClass(O[c]);this.button.addClass(O[a])};n.prototype.showAgentJoined=function(a){var c=parseInt(this.button.getAttr("data-viewercount"));c&&c<a.count&&(c=a.agentlist[a.count-1],"guest"===c.role&&k.showAnnouncementPill(!0,t["viewer-joined-pill"].replaceAll("${name}",c.name)));this.button.setAttr("data-viewercount",
a.agentlist.length);this.border.addClass("joined");this.videopreview&&GLANCE.Cobrowse.Visitor.setGlanceVideoSource(this.videopreview.elem.shutdownPreview(!0))};n.prototype.setVideoBgBlurState=function(a){this.visitorVideoBlurred=a;this.videosessionpreview.setAttr("data-videobgblur-0",this.visitorVideoBlurred);h("#glance_blurbgd_video").setAttr("aria-pressed",`${this.visitorVideoBlurred}`);h("#glance_blurbgd_video").setAttr("aria-label",this.visitorVideoBlurred?"Unblur Background":"Blur Background")};
n.prototype.toggleVideo=function(){this.button.getElement("#glance_stop_video").elem.disabled=!0;this.getVideoParticipantState(0)===z.ON?this.setVideoParticipantState(0,z.PAUSED):this.setVideoParticipantState(0,z.ON);GLANCE.Cobrowse.Visitor.toggleVideo()};n.prototype.visitorVideoPaused=function(a){this.button.getElement("#glance_stop_video").elem.disabled=!1;this.setVideoParticipantState(0,a?z.PAUSED:z.ON)};n.prototype.showStarting=function(){uilog("SessionButton.showStarting");w.hideMessage();K&&
K.show(!1);this.setState(3);this.setBoxState(n.BOXSTATE_STARTING);this.setExpanded(!0)};n.prototype.showInSession=function(){this.videopreview&&this.videopreview.hide();r.get(r.RCENABLED)&&this.border.addClass("glance_rcenabled");"original"!==w.confirmation.widgetstyle&&h("#glance_key_prompt").text(t["ssn-key-prompt"]);h("#glance_ssn_key").text(GLANCE.Cobrowse.Visitor.getKey());uilog("showInSession setting box state to:",r.get(r.BOXSTATE),"expanded:",r.get(r.EXPANDED));this.setBoxState(r.get(r.BOXSTATE));
this.setExpanded(r.get(r.EXPANDED));if(r.get(r.BOXSTATE)<n.BOXSTATE_JOINED){"alertdialog"===this.ssnkeybox.elem.getAttribute("role")&&this.ssnkeybox.showDialog(!1);var a=GLANCE.Cobrowse.Visitor.getStartParams();(a=a&&a.video)&&"off"!==a&&GLANCE.Cobrowse.Visitor.isRandomKey()&&(this.videopreview||console.error("ERR_NO_NWAYVIDEO"),this.boxstate<n.BOXSTATE_KEYED&&this.setBoxState(n.BOXSTATE_KEYEDWAITCAMERA),this.videopreview.show(),this.videopreview.elem.setupPreview().then(()=>{GLANCE.Cobrowse.Visitor.setCameraSettings(this.videopreview.elem.getCameraSettings())}).catch(()=>
{}).finally(()=>{!GLANCE.Cobrowse.Visitor.inSession()||r.get(r.BOXSTATE)>=n.BOXSTATE_JOINED||(this.refreshFocusTrap(),this.setBoxState(n.BOXSTATE_KEYED))}))}this.setState(1);k.restoreWidgetPos()};let z={ON:"on",PAUSED:"paused",BLOCKED:"blocked",NOTSUPPORTED:"notsupported",ERROR:"error"};n.BoxStates="starting integrated keyedwaitcamera keyed joined video nwayvideo".split(" ");n.BOXSTATE_STARTING=0;n.BOXSTATE_INTEGRATED=1;n.BOXSTATE_KEYEDWAITCAMERA=2;n.BOXSTATE_KEYED=3;n.BOXSTATE_JOINED=4;n.BOXSTATE_VIDEO=
5;n.BOXSTATE_NWAYVIDEO=6;n.prototype.setBoxState=function(a){["#glance_ssnkey_box","#glance_cobrowse_btn"].forEach(c=>{let e=h(c);e&&(n.BoxStates.forEach(function(d){e.removeClass(d)}),0<=a&&e.addClass(n.BoxStates[a]),a===n.BOXSTATE_VIDEO&&this.button.setAttr("data-videosize","small"))});this.boxstate=a;r.set(r.BOXSTATE,a)};n.prototype.nwayVideoMode=function(){return this.boxstate==n.BOXSTATE_NWAYVIDEO};n.prototype.showJoinPrompt=function(){var a=GLANCE.Cobrowse.Visitor.getStartParams();a=a&&a.video&&
"off"!==a.video;this.videopreview&&this.videopreview.hide();h("#glance_ssn_key").text(GLANCE.Cobrowse.Visitor.getKey());this.setBoxState(GLANCE.Cobrowse.Visitor.isRandomKey()?a?n.BOXSTATE_KEYEDWAITCAMERA:n.BOXSTATE_KEYED:n.BOXSTATE_INTEGRATED);this.setExpanded(!0);this.setState(1)};n.prototype.showSessionStopped=function(){this.setExpanded(!1);this.setState(T);this.setBoxState(-1);this.clearButtonState()};n.prototype.confirmStopSession=function(){"original"===w.confirmation.widgetstyle?GLANCE.Cobrowse.Visitor.stopSession():
w.confirmation.show("",t["end-session-prompt"],()=>{GLANCE.Cobrowse.Visitor.stopSession();this.ssnkeybox.previousFocus&&this.ssnkeybox.previousFocus.focus()})};n.prototype.clearButtonState=function(){this.videopreview&&this.videopreview.elem.shutdownPreview();this.border.removeClass("joined");this.button.elem.removeAttribute("data-videosize");this.button.elem.removeAttribute("data-viewercount");this.button.removeClass("viewingscreenshare");this.videosessionpreview&&this.videosessionpreview.removeAttrs("data-videostate");
G.removeViewers()};n.prototype.setVideoParticipantState=function(a,c,e,d){if(0===a){let l=this.button.getElement("#glance_stop_video");l.setAttr("aria-pressed",c===z.ON);l.elem.disabled=!1;this.videosessionpreview.setAttr("data-videostate-0",c);void 0!==e&&this.setVideoBgBlurState(e);void 0!==d&&this.videosessionpreview.setAttr("data-videoblurcapable-0",d)}(e=this.button.getElement(`#glance_video_container_${a}`))?e.setAttr("data-videostate",c):vidlog("Not setting video participant state, viewer not found:",
a)};n.prototype.getVideoParticipantState=function(a){return this.videosessionpreview&&this.videosessionpreview.getAttr(`data-videostate-${a}`)};n.prototype._doVideoScroll=function(a){a=CobrowseVideoUtils.scrollVideoStrip(a);r.set("videoscrolloffset",a)};n.prototype.setExpanded=function(a){(a?this.button.addClass:this.button.removeClass).call(this.button,"expanded");h("#glance_expand").setAttr("aria-expanded",a);r.set(r.EXPANDED,a);k.restoreWidgetPos()};n.prototype.show=function(a){this.startlabel&&
(this.startlabel.elem.style.display=a?"block":"")};n.prototype.toggle=function(){this.startlabel&&this.show(""===this.startlabel.elem.style.display)};n.createdpromise=new Promise(a=>{n.created=a});n.prototype.restoreWidgetPos=function(a){if(1===this.state&&GLANCE.Cobrowse.Visitor.READYSTATE.statereceived&&"original"!==x.widgetstyle){var c=document.getElementById("glance_session_widget");if(c){var e=r.get(r.WIDGETPOS);e||(e={bottom:!0,left:!0},r.set(r.WIDGETPOS,e));uilog("restoring widget position:",
e);var d=c.getBoundingClientRect(),l=window.innerHeight||document.documentElement.clientHeight,m=window.innerWidth||document.documentElement.clientWidth;c.style.transition=a?"all .5s":"unset";c.style.bottom=e.bottom?"20px":c.style.bottom=l-d.height-33-20+"px";c.style.left=e.left?"20px":m-d.width-20+"px";c.setAttribute("data-widget-location-bottom",e.bottom);c.setAttribute("data-widget-location-left",e.left)}}};n.prototype.draggingWidget=function(a){if(this.supportsDrag()&&1===this.state&&GLANCE.Cobrowse.Visitor.READYSTATE.statereceived&&
"original"!==x.widgetstyle&&!k.button.elem.matches("[data-videosize=large]")){var c=document.getElementById("glance_session_widget");document.getElementById("glance_titlebar").getBoundingClientRect();var e=window.getComputedStyle(c);c.style.bottom=parseInt(e.bottom)+a.bottom+"px";c.style.left=parseInt(e.left)+a.left+"px";c.style.transition="unset";a=c.getBoundingClientRect();a={bottom:(a.top+a.bottom)/2>(window.innerHeight||document.documentElement.clientHeight)/2,left:(a.left+a.right)/2<(window.innerWidth||
document.documentElement.clientWidth)/2};uilog("saving widget position:",a);r.set(r.WIDGETPOS,a)}};GLANCE.Cobrowse.VisitorUI=GLANCE.Cobrowse.VisitorUI||{};GLANCE.Cobrowse.VisitorUI.ready=function(){return n.createdpromise};(function(){return new function(){var a=document;this.onLoad=function(c){a.readyState.match(/uninitialized|loading/)?a.addEventListener("DOMContentLoaded",c):c()}}})().onLoad(()=>{uilog("onLoad");f().then(a=>{Z(a);x=a;A.setCustomizationVersion(a.custver);let c=A.addStylesheets(a.settingsparentgroupid),
e=A.addGlanceVideo(a.videobgblurallowed);return Promise.all([c,g(a),p(a),aa(),e])}).then(a=>{uilog("Generating button");t=a[2];t["docshare-termsurl"]=x.docsharetermsurl;t.companyname=x.companyname;w=new F;w.configure(x);var c=a[1];a=a[2];for(const e in a)c=c.split(`\$\{${e}\}`).join(a[e]);return c}).then(a=>{X(a)})})})();}).call(window);
//# sourceMappingURL=map.js.map
